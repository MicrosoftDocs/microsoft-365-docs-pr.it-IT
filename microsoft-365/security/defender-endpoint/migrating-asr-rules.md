---
title: Migrazione da un gruppo HIPS di terze parti alle regole asr
description: Descrive come affrontare una migrazione da una soluzione HIPS (Host Intrusion Prevention System) di terze parti alle regole di ripristino dell'accesso alternativo.
keywords: Regole di riduzione della superficie di attacco, asr, regole asr, hips, sistema di prevenzione delle intrusioni host, regole di protezione, anti-exploit, antiexploit, exploit, prevenzione delle infezioni, Microsoft Defender for Endpoint, Microsoft Defender ATP
search.product: eADQiWindows 10XVcnh
ms.topic: article
ms.prod: m365-security
ms.mktglfcycl: manage
ms.sitesec: library
ms.pagetype: security
ms.localizationpriority: medium
audience: ITPro
author: lovina-saldanha
ms.author: v-lsaldanha
manager: dansimp
ms.custom: asr
ms.technology: mde
ms.openlocfilehash: ced969fdd3e8b63136f8bd3f043272e76d99bc5e
ms.sourcegitcommit: 7b8104015a76e02bc215e1cf08069979c70650ae
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/31/2021
ms.locfileid: "51476520"
---
# <a name="migrating-from-a-third-party-hips-to-asr-rules"></a>Migrazione da un gruppo HIPS di terze parti alle regole asr

Questo articolo ti aiuta a mappare le regole comuni a Microsoft Defender per Endpoint. Nella tabella seguente vengono illustrate le domande e gli scenari comuni durante la migrazione da un prodotto HIPS di terze parti alle regole di ripristino di emergenza.

|Ambito e azione|Processi|Operazione|Esempi di file/cartelle, chiavi/valori del Registro di sistema, processi, servizi|Regole di riduzione della superficie di attacco|Altre funzionalità consigliate|
|:--|:--|:--|:--|:--|:--|
|Tutti i processi: blocca la creazione di file e chiavi del Registro di sistema specifici||Creazione file|*.zepto, *.odin, *.locky, *.jaff, *.lukitus, *.wnry, *.krab|Le regole asr bloccano le tecniche di attacco e non gli Indicatori di compromissione (IOC). Bloccare un'estensione di file specifica non è sempre utile, perché non impedisce la compromissione di un dispositivo. Ostacola solo parzialmente un attacco finché gli utenti malintenzionati non creano un nuovo tipo di estensione per il payload.|È consigliabile avere Microsoft Defender AV abilitato, insieme a Cloud Protection e Behavior Analysis. È consigliabile utilizzare altre misure di prevenzione, ad esempio la regola asr "Usare la protezione avanzata contro ransomware". In questo modo si garantisce un maggiore livello di protezione dagli attacchi ransomware. Inoltre, molte di queste chiavi del Registro di sistema vengono monitorate da Microsoft Defender per Endpoint, ad esempio le tecniche ASEP, che attiveranno avvisi specifici. Le chiavi del Registro di sistema utilizzate richiedono almeno privilegi di amministratore locale o di programma di installazione attendibile per poter essere modificate. È consigliabile utilizzare un ambiente bloccato, con almeno account amministrativi o diritti. È possibile abilitare altre configurazioni di sistema, tra cui "Disabilitare SeDebug per i ruoli non necessari" che fanno parte dei consigli di sicurezza più ampi.|
|Tutti i processi: blocca la creazione di file e chiavi del Registro di sistema specifici||Modifiche al Registro di sistema|*\Software \* ,HKCU\Environment\UserInitMprLogonScript,HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Accessibility\ATs \* \StartExe, HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options \* \Debugger,HKEY_CURRENT_USER\Software\Microsoft\HtmlHelp Author\location,HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SilentProcessExit \* \MonitorProcess|Le regole asr bloccano le tecniche di attacco e non gli Indicatori di compromissione (IOC). Bloccare un'estensione di file specifica non è sempre utile, perché non impedisce la compromissione di un dispositivo. Ostacola solo parzialmente un attacco finché gli utenti malintenzionati non creano un nuovo tipo di estensione per il payload.|È consigliabile avere Microsoft Defender AV abilitato, insieme a Cloud Protection e Behavior Analysis. È consigliabile utilizzare una prevenzione aggiuntiva, ad esempio la regola asr "Usare la protezione avanzata contro ransomware". In questo modo si garantisce un maggiore livello di protezione dagli attacchi ransomware. Inoltre, molte di queste chiavi del Registro di sistema vengono monitorate da Microsoft Defender per Endpoint, ad esempio le tecniche ASEP, che attiveranno avvisi specifici. Inoltre, le chiavi del Registro di sistema utilizzate richiedono almeno privilegi di amministratore locale o di programma di installazione attendibile per poter essere modificate. È consigliabile utilizzare un ambiente bloccato, con almeno account amministrativi o diritti. È possibile abilitare altre configurazioni di sistema, tra cui "Disabilitare SeDebug per i ruoli non necessari" che fanno parte dei consigli di sicurezza più ampi.|
|Programmi non attendibili da USB: impedire l'esecuzione di programmi non attendibili da unità rimovibili|*|Esecuzione del processo|*|Le regole asr dispongono di una regola predefinita per impedire l'avvio di programmi non attendibili e non firmati da unità rimovibili: "Blocca processi non attendibili e non firmati eseguiti da USB", GUID "b2b3f03d-6a65-4f7b-a9c7-1c7ef74a9ba4".|Esplorare ulteriori controlli per i dispositivi USB e altri supporti rimovibili usando Microsoft Defender for Endpoint: Come controllare i dispositivi USB e altri supporti rimovibili [con Microsoft Defender for Endpoint.](https://docs.microsoft.com/windows/security/threat-protection/device-control/control-usb-devices-using-intune) |
|Mshta: impedire a Mshta di avviare determinati processi figlio|mshta.exe|Esecuzione del processo|powershell.exe, cmd.exe, regsvr32.exe|Le regole asr non contengono alcuna regola specifica per impedire ai processi figlio di "mshta.exe". Questo controllo rientra nell'ambito di Protezione da exploit o Windows Defender'applicazione.|Abilita Windows Defender controllo dell'applicazione per impedire mshta.exe'esecuzione del tutto. Se l'organizzazione richiede "mshta.exe" per le app line-of-business, configura una regola di protezione dagli exploit di Windows Defender specifica per impedire mshta.exe avviare processi figlio.|
|Outlook: impedire a Outlook di avviare processi figlio|outlook.exe|Esecuzione del processo|powershell.exe|Le regole asr hanno una regola predefinita per impedire alle app di comunicazione di Office (Outlook, Skype e Teams) di avviare processi figlio: "Blocca l'applicazione di comunicazione di Office dalla creazione di processi figlio", GUID "26190899-1602-49e8-8b27-eb1d0a1ce869".|È consigliabile abilitare la modalità linguaggio vincolato di PowerShell per ridurre al minimo la superficie di attacco da PowerShell.|
|Office: impedire alle app di Office di avviare processi figlio e di creare contenuto eseguibile|winword.exe, powerpnt.exe, excel.exe|Esecuzione del processo|powershell.exe, cmd.exe, wscript.exe, mshta.exe, EQNEDT32.EXE, regsrv32.exe|Le regole asr hanno una regola predefinita per impedire alle app di Office di avviare processi figlio: "Blocca la creazione di processi figlio da parte di tutte le applicazioni di Office", GUID "D4F940AB-401B-4EFC-AADC-AD5F3C50688A".|N/D|
|Office: impedire alle app di Office di avviare processi figlio e di creare contenuto eseguibile|winword.exe, powerpnt.exe, excel.exe|Creazione file|C:\Users \* \AppData \* *\* .exe, C:\ProgramData \** \* .exe, C:\ProgramData \* *\* .com, C:\Users \* \* AppData\Local\Temp* \* .com, C:\Users \* *\Downloads \** \* .exe, C:\Users \* \AppData \* *\* .scf, C:\ProgramData \** \* .scf, C:\Users\Public \* .exe, C:\Users \* \Desktop \* * \* .exe|N/D|
|Wscript: impedire a Wscript di leggere determinati tipi di file|wscript.exe|Lettura file|C:\Users \* \AppData \* *\* .js*, C:\Users \* \Downloads \* *\* .js*|A causa di problemi di affidabilità e prestazioni, le regole asr non sono in grado di impedire a un processo specifico di leggere un determinato tipo di file di script. Abbiamo una regola per impedire vettori di attacco che potrebbero provenire da questi scenari. Il nome della regola è "Blocca l'avvio del contenuto eseguibile scaricato da JavaScript o VBScript" (GUID "D3E037E1-3EB8-44C8-A917-57927947596 "Blocca l'esecuzione di script potenzialmente offuscati" (GUID " 5BEB7EFE-FD9A-4556-801D-275E5FFC04CC")|Anche se esistono regole ASR specifiche che attenuano determinati vettori di attacco all'interno di questi scenari, è importante ricordare che AV è in grado per impostazione predefinita di esaminare gli script (PowerShell, Windows Script Host, JavaScript, VBScript e altro ancora) in tempo reale, tramite l'interfaccia AMSI (Antimalware Scan Interface). Altre info sono disponibili qui: [Antimalware Scan Interface (AMSI)](https://docs.microsoft.com/windows/win32/amsi/antimalware-scan-interface-portal). |
|Adobe Acrobat: bloccare l'avvio dei processi figlio|AcroRd32.exe, Acrobat.exe|Esecuzione del processo|cmd.exe, powershell.exe, wscript.exe|Le regole asr consentono di bloccare l'avvio dei processi figlio da parte di Adobe Reader. Il nome della regola è "Block Adobe Reader from creating child processes", GUID "7674ba52-37eb-4a4f-a9a1-f0f9a1619a2c".|N/D|
|CertUtil: bloccare il download o la creazione di contenuto eseguibile|certutil.exe|Creazione file|*.exe|Le regole asr non supportano questi scenari perché fanno parte della protezione di Microsoft Defender Antivirus.|Microsoft Defender AV impedisce a CertUtil di creare o scaricare contenuto eseguibile.|
|Tutti i processi: impedire ai processi di arrestare i componenti critici del sistema|*|Terminazione processo|MsSense.exe, MsMpEng.exe, NisSrv.exe, svchost.exe*, services.exe, csrss.exe, smss.exe, wininit.exe e altro ancora.|Le regole asr non supportano questi scenari perché sono protette con le protezioni di sicurezza predefinite di Windows 10.|ELAM (Early Launch AntiMalware), PPL (Protection Process Light), PPL AntiMalware Light e System Guard.|
|Processi specifici: blocca il tentativo di processo di avvio specifico|"Assegnare un nome al processo"|Esecuzione del processo|tor.exe, bittorrent.exe, cmd.exe, powershell.exe e altro ancora.|Nel complesso, le regole asr non sono progettate per funzionare come application manager.|Per impedire agli utenti di avviare processi o programmi specifici, è consigliabile utilizzare Windows Defender Application Control. Microsoft Defender for Endpoint File and Cert indicators, può essere usato in uno scenario di risposta a eventi imprevisti (non deve essere visto come un meccanismo di controllo dell'applicazione).|
|Tutti i processi: blocca le modifiche non autorizzate alle configurazioni av MDATP|*|Modifiche al Registro di sistema|HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\DisableAntiSpyware, HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Policy Manager\AllowRealTimeMonitoring e così via.|Le regole asr non coprono questi tipi di scenari perché fanno parte della protezione integrata di Microsoft Defender for Endpoint.|Tamper Protection (consenso esplicito, gestito da Intune) impedisce modifiche non autorizzate alle chiavi del Registro di sistema DisableAntiVirus, DisableAntiSpyware, DisableRealtimeMonitoring, DisableOnAccessProtection, DisableBehaviorMonitoring e DisableIOAVProtection (e altro ancora). |



Vedere anche

- [FAQ per la riduzione della superficie d'attacco](attack-surface-reduction-faq.md)
- [Abilitare regole per la riduzione della superficie di attacco](enable-attack-surface-reduction.md)
- [Rilevare regole per la riduzione della superficie di attacco](evaluate-attack-surface-reduction.md)
