---
title: Utilizzare le regole del flusso di posta per bloccare i messaggi con allegati eseguibili
f1.keywords:
- NOCSH
ms.author: chrisda
author: chrisda
manager: dansimp
ms.date: ''
audience: ITPro
ms.topic: how-to
ms.service: O365-seccomp
localization_priority: Normal
ms.assetid: c4fb4a86-b772-49d0-8773-e8ee897e175d
ms.custom:
- seo-marvel-apr2020
description: Gli amministratori possono imparare a creare regole del flusso di posta (regole di trasporto) per bloccare i messaggi che contengono allegati eseguibili.
ms.openlocfilehash: b78fd282e6b5a7f20d1dab830da296e4be4ac812
ms.sourcegitcommit: e12fa502bc216f6083ef5666f693a04bb727d4df
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "46827654"
---
# <a name="use-mail-flow-rules-to-block-messages-with-executable-attachments-in-eop"></a>Usare le regole del flusso di posta per bloccare messaggi con allegati eseguibili in Exchange Online Protection

In Microsoft 365 organizzazioni con cassette postali in Exchange Online o in organizzazioni di Exchange Online Protection (EOP) senza cassette postali di Exchange Online, EOP utilizza criteri anti-malware per bloccare i messaggi nocivi, inclusi i messaggi con allegati eseguibili. Per ulteriori informazioni, vedere [protezione anti-malware in EOP](anti-malware-protection.md).

Per migliorare ulteriormente la protezione, è possibile utilizzare le regole del flusso di posta (note anche come regole di trasporto) per identificare e bloccare i messaggi che contengono allegati eseguibili, come descritto in questo argomento.

Ad esempio, dopo un'epidemia di malware, una società potrebbe applicare questa regola con un limite di tempo in modo che gli utenti coinvolti possano tornare a inviare gli allegati dopo un periodo di tempo specificato.

## <a name="what-do-you-need-to-know-before-you-begin"></a>Che cosa è necessario sapere prima di iniziare?

- Prima di poter eseguire queste procedure, è necessario disporre delle autorizzazioni seguenti:

  - In Exchange Online, vedere la voce "flusso di posta" in [autorizzazioni funzionalità in Exchange Online](https://docs.microsoft.com/Exchange/permissions-exo/feature-permissions).
  
  - In EOP autonomo, è necessario il ruolo regole di trasporto, assegnato ai ruoli OrganizationManagement, ComplianceManagement e RecordsManagement per impostazione predefinita. Per ulteriori informazioni, vedere [autorizzazioni in EOP autonomo](feature-permissions-in-eop.md) e [utilizzo dell'interfaccia di amministrazione di Exchange per modificare l'elenco dei membri nei gruppi di ruoli](manage-admin-role-group-permissions-in-eop.md#use-the-eac-modify-the-list-of-members-in-role-groups).

- Per aprire EAC in Exchange Online, vedere interfaccia [di amministrazione di Exchange in Exchange Online](https://docs.microsoft.com/Exchange/exchange-admin-center). Per aprire EAC in EOP autonomo, vedere interfaccia [di amministrazione di Exchange in EOP autonomo](exchange-admin-center-in-exchange-online-protection-eop.md).

- Per informazioni su come connettersi a PowerShell per Exchange Online, vedere [Connettersi a PowerShell per Exchange Online](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-powershell). Per connettersi a PowerShell di EOP autonomo, vedere [Connettersi a PowerShell per Exchange Online Protection](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-protection-powershell).

- Per ulteriori informazioni sulle regole del flusso di posta in Exchange Online e EOP autonomo, vedere i seguenti argomenti:

  - [Regole del flusso di posta (regole di trasporto) in Exchange Online](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/mail-flow-rules)

  - [Condizioni ed eccezioni della regola del flusso di posta (predicati) in Exchange Online](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/conditions-and-exceptions)

  - [Azioni delle regole del flusso di posta in Exchange Online](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/mail-flow-rule-actions)

## <a name="use-the-eac-to-create-a-rule-that-blocks-messages-with-executable-attachments"></a>Utilizzo dell'interfaccia di amministrazione di Exchange per creare una regola che blocchi i messaggi con allegati eseguibili

1. Nell'interfaccia di amministrazione di Exchange, andare a **Flusso di posta** \> **Regole**.

2. Fare clic su **Aggiungi** ![ icona ](../../media/ITPro-EAC-AddIcon.png) e quindi selezionare **Crea una nuova regola**.

3. Nella pagina **Nuova regola** che si apre, configurare le seguenti impostazioni:

   - **Nome**: immettere un nome univoco descrittivo per la regola.

   - Fare clic su **altre opzioni**.

   - **Applica questa regola se**: selezionare **un allegato** \> **con contenuto eseguibile**.

   - **Eseguire le operazioni seguenti**: selezionare **blocca il messaggio** e quindi scegliere l'azione desiderata:

     - **rifiuta il messaggio e Includi una spiegazione**: nella finestra di dialogo **specifica il motivo di rifiuto** che viene visualizzata, immettere il testo che si desidera visualizzare nel rapporto di mancato recapito (noto anche come NDR o messaggio di rimbalzo). Il codice di stato avanzato predefinito utilizzato è 5.7.1.

     - **rifiutare il messaggio con il codice di stato avanzato seguente**: nella finestra di dialogo **Immetti codice di stato** avanzato visualizzato, immettere il codice di stato avanzato che si desidera venga visualizzato nel rapporto di mancato recapito. I valori validi sono 5.7.1 o un valore compreso tra 5.7.900 e 5.7.999. Il testo di rifiuto predefinito è: Delivery not authorized, message refused.

     - **rifiutare il messaggio senza inviare alcuna notifica**

4. Al termine, scegliere **Salva**. A questo punto, la regola di blocco degli allegati è attiva.

## <a name="use-powershell-to-create-a-rule-that-blocks-messages-with-executable-attachments"></a>Utilizzo di PowerShell per creare una regola che consente di bloccare i messaggi con allegati eseguibili

Utilizzare la sintassi seguente per creare una regola per bloccare i messaggi che contengono allegati eseguibili:

```powershell
New-TransportRule -Name "<UniqueName>" -AttachmentHasExecutableContent $true [-RejectMessageEnhancedStatusCode <5.7.1 | 5.7.900 to 5.7.999>] [-RejectMessageReasonText "<Text>"] [-DeleteMessage $true]
```

**Note**:

- Se si utilizza il parametro _RejectMessageEnhancedStatusCode_ senza il parametro _RejectMessageReasonText_ , il testo predefinito è: Delivery not authorized, message refused.

- Se si utilizza il parametro _RejectMessageReasonText_ senza il parametro _RejectMessageEnhancedStatusCode_ , il codice predefinito è 5.7.1.

In questo esempio viene creata una nuova regola denominata Block Executable Attachments che consente di eliminare automaticamente i messaggi che contengono allegati eseguibili.

```powershell
New-TransportRule -Name "Block Executable Attachments" -AttachmentHasExecutableContent $true -DeleteMessage $true
```

Per informazioni dettagliate su sintassi e parametri, vedere [New-TransportRule](https://docs.microsoft.com/powershell/module/exchange/new-transportrule).

## <a name="how-do-you-know-this-worked"></a>Come verificare se l'operazione ha avuto esito positivo

Per verificare la corretta creazione di una regola del flusso di posta per bloccare i messaggi che contengono allegati eseguibili, eseguire una delle operazioni seguenti:

- Nell'interfaccia di amministrazione di Exchange, andare a regole del **flusso di posta** \> **Rules** \> selezionare la regola \> fare clic su **Modifica** ![ icona modifica ](../../media/ITPro-EAC-EditIcon.png) e verificare le impostazioni.

- In PowerShell, eseguire il comando riportato di seguito per verificare le impostazioni:

  ```powershell
  Get-TransportRule -Identity "<Rule Name>" | Format-List Name,AttachmentHasExecutableContent,RejectMessage*,DeleteMessage
  ```
