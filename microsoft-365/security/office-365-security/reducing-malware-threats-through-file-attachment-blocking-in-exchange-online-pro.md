---
title: Utilizzare le regole del flusso di posta per bloccare i messaggi con allegati eseguibili
f1.keywords:
- NOCSH
ms.author: chrisda
author: chrisda
manager: dansimp
ms.date: ''
audience: ITPro
ms.topic: how-to
ms.service: O365-seccomp
localization_priority: Normal
ms.assetid: c4fb4a86-b772-49d0-8773-e8ee897e175d
ms.custom:
- seo-marvel-apr2020
description: Gli amministratori possono imparare a creare regole del flusso di posta (regole di trasporto) per bloccare i messaggi che contengono allegati eseguibili.
ms.openlocfilehash: 4552cb76238ad995bab04a9ac50873bc22115ce4
ms.sourcegitcommit: ee39faf3507d0edc9497117b3b2854955c959c6c
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 12/10/2020
ms.locfileid: "49615913"
---
# <a name="use-mail-flow-rules-to-block-messages-with-executable-attachments-in-eop"></a><span data-ttu-id="d49e6-103">Usare le regole del flusso di posta per bloccare messaggi con allegati eseguibili in Exchange Online Protection</span><span class="sxs-lookup"><span data-stu-id="d49e6-103">Use mail flow rules to block messages with executable attachments in EOP</span></span>

[!INCLUDE [Microsoft 365 Defender rebranding](../includes/microsoft-defender-for-office.md)]


<span data-ttu-id="d49e6-104">In Microsoft 365 organizzazioni con cassette postali in Exchange Online o in organizzazioni di Exchange Online Protection (EOP) senza cassette postali di Exchange Online, EOP utilizza criteri anti-malware per bloccare i messaggi nocivi, inclusi i messaggi con allegati eseguibili.</span><span class="sxs-lookup"><span data-stu-id="d49e6-104">In Microsoft 365 organizations with mailboxes in Exchange Online or standalone Exchange Online Protection (EOP) organizations without Exchange Online mailboxes, EOP uses anti-malware policies to block harmful messages, including messages with executable attachments.</span></span> <span data-ttu-id="d49e6-105">Per ulteriori informazioni, vedere [protezione anti-malware in EOP](anti-malware-protection.md).</span><span class="sxs-lookup"><span data-stu-id="d49e6-105">For more information, see [Anti-malware protection in EOP](anti-malware-protection.md).</span></span>

<span data-ttu-id="d49e6-106">Per migliorare ulteriormente la protezione, è possibile utilizzare le regole del flusso di posta (note anche come regole di trasporto) per identificare e bloccare i messaggi che contengono allegati eseguibili, come descritto in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="d49e6-106">To further enhance protection, you can use mail flow rules (also known as transport rules) to identify and block messages that contain executable attachments as described in this topic.</span></span>

<span data-ttu-id="d49e6-107">Ad esempio, dopo un'epidemia di malware, una società potrebbe applicare questa regola con un limite di tempo in modo che gli utenti coinvolti possano tornare a inviare gli allegati dopo un periodo di tempo specificato.</span><span class="sxs-lookup"><span data-stu-id="d49e6-107">For example, following a malware outbreak, a company could apply this rule with a time limit so that affected users can get back to sending attachments after a specified length of time.</span></span>

## <a name="what-do-you-need-to-know-before-you-begin"></a><span data-ttu-id="d49e6-108">Che cosa è necessario sapere prima di iniziare</span><span class="sxs-lookup"><span data-stu-id="d49e6-108">What do you need to know before you begin?</span></span>

- <span data-ttu-id="d49e6-109">Prima di poter eseguire queste procedure, è necessario disporre delle autorizzazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="d49e6-109">You need to be assigned permissions before you can do these procedures:</span></span>

  - <span data-ttu-id="d49e6-110">In Exchange Online, vedere la voce "flusso di posta" in [autorizzazioni funzionalità in Exchange Online](https://docs.microsoft.com/Exchange/permissions-exo/feature-permissions).</span><span class="sxs-lookup"><span data-stu-id="d49e6-110">In Exchange Online, see the "Mail flow" entry in [Feature Permissions in Exchange Online](https://docs.microsoft.com/Exchange/permissions-exo/feature-permissions).</span></span>

  - <span data-ttu-id="d49e6-111">In EOP autonomo, è necessario il ruolo regole di trasporto, assegnato ai ruoli OrganizationManagement, ComplianceManagement e RecordsManagement per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="d49e6-111">In standalone EOP, you need the Transport Rules role, which is assigned to the OrganizationManagement, ComplianceManagement, and RecordsManagement roles by default.</span></span> <span data-ttu-id="d49e6-112">Per ulteriori informazioni, vedere [autorizzazioni in EOP autonomo](feature-permissions-in-eop.md) e [utilizzo dell'interfaccia di amministrazione di Exchange per modificare l'elenco dei membri nei gruppi di ruoli](manage-admin-role-group-permissions-in-eop.md#use-the-eac-modify-the-list-of-members-in-role-groups).</span><span class="sxs-lookup"><span data-stu-id="d49e6-112">For more information, see [Permissions in standalone EOP](feature-permissions-in-eop.md) and [Use the EAC modify the list of members in role groups](manage-admin-role-group-permissions-in-eop.md#use-the-eac-modify-the-list-of-members-in-role-groups).</span></span>

- <span data-ttu-id="d49e6-113">Per aprire EAC in Exchange Online, vedere interfaccia [di amministrazione di Exchange in Exchange Online](https://docs.microsoft.com/Exchange/exchange-admin-center).</span><span class="sxs-lookup"><span data-stu-id="d49e6-113">To open the EAC in Exchange Online, see [Exchange admin center in Exchange Online](https://docs.microsoft.com/Exchange/exchange-admin-center).</span></span> <span data-ttu-id="d49e6-114">Per aprire EAC in EOP autonomo, vedere interfaccia [di amministrazione di Exchange in EOP autonomo](exchange-admin-center-in-exchange-online-protection-eop.md).</span><span class="sxs-lookup"><span data-stu-id="d49e6-114">To open the EAC in standalone EOP, see [Exchange admin center in standalone EOP](exchange-admin-center-in-exchange-online-protection-eop.md).</span></span>

- <span data-ttu-id="d49e6-115">Per informazioni su come connettersi a PowerShell per Exchange Online, vedere [Connettersi a PowerShell per Exchange Online](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-powershell).</span><span class="sxs-lookup"><span data-stu-id="d49e6-115">To connect to Exchange Online PowerShell, see [Connect to Exchange Online PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-powershell).</span></span> <span data-ttu-id="d49e6-116">Per connettersi a PowerShell di EOP autonomo, vedere [Connettersi a PowerShell per Exchange Online Protection](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-protection-powershell).</span><span class="sxs-lookup"><span data-stu-id="d49e6-116">To connect to standalone EOP PowerShell, see [Connect to Exchange Online Protection PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-protection-powershell).</span></span>

- <span data-ttu-id="d49e6-117">Per ulteriori informazioni sulle regole del flusso di posta in Exchange Online e EOP autonomo, vedere i seguenti argomenti:</span><span class="sxs-lookup"><span data-stu-id="d49e6-117">For more information about mail flow rules in Exchange Online and standalone EOP, see the following topics:</span></span>

  - [<span data-ttu-id="d49e6-118">Regole del flusso di posta (regole di trasporto) in Exchange Online</span><span class="sxs-lookup"><span data-stu-id="d49e6-118">Mail flow rules (transport rules) in Exchange Online</span></span>](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/mail-flow-rules)

  - [<span data-ttu-id="d49e6-119">Condizioni ed eccezioni della regola del flusso di posta (predicati) in Exchange Online</span><span class="sxs-lookup"><span data-stu-id="d49e6-119">Mail flow rule conditions and exceptions (predicates) in Exchange Online</span></span>](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/conditions-and-exceptions)

  - [<span data-ttu-id="d49e6-120">Azioni delle regole del flusso di posta in Exchange Online</span><span class="sxs-lookup"><span data-stu-id="d49e6-120">Mail flow rule actions in Exchange Online</span></span>](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/mail-flow-rule-actions)

## <a name="use-the-eac-to-create-a-rule-that-blocks-messages-with-executable-attachments"></a><span data-ttu-id="d49e6-121">Utilizzo dell'interfaccia di amministrazione di Exchange per creare una regola che blocchi i messaggi con allegati eseguibili</span><span class="sxs-lookup"><span data-stu-id="d49e6-121">Use the EAC to create a rule that blocks messages with executable attachments</span></span>

1. <span data-ttu-id="d49e6-122">Nell'interfaccia di amministrazione di Exchange, andare a **Flusso di posta** \> **Regole**.</span><span class="sxs-lookup"><span data-stu-id="d49e6-122">In the EAC, go to **Mail flow** \> **Rules**.</span></span>

2. <span data-ttu-id="d49e6-123">Fare clic su **Aggiungi** ![ icona ](../../media/ITPro-EAC-AddIcon.png) e quindi selezionare **Crea una nuova regola**.</span><span class="sxs-lookup"><span data-stu-id="d49e6-123">Click **Add** ![Add icon](../../media/ITPro-EAC-AddIcon.png) and then select **Create a new rule**.</span></span>

3. <span data-ttu-id="d49e6-124">Nella pagina **Nuova regola** che si apre, configurare le seguenti impostazioni:</span><span class="sxs-lookup"><span data-stu-id="d49e6-124">In the **New rule** page that opens, configure the following settings:</span></span>

   - <span data-ttu-id="d49e6-125">**Nome**: immettere un nome univoco descrittivo per la regola.</span><span class="sxs-lookup"><span data-stu-id="d49e6-125">**Name**: Enter a unique, descriptive name for the rule.</span></span>

   - <span data-ttu-id="d49e6-126">Fare clic su **altre opzioni**.</span><span class="sxs-lookup"><span data-stu-id="d49e6-126">Click **More Options**.</span></span>

   - <span data-ttu-id="d49e6-127">**Applica questa regola se**: selezionare **un allegato** \> **con contenuto eseguibile**.</span><span class="sxs-lookup"><span data-stu-id="d49e6-127">**Apply this rule if**: Select **Any attachment** \> **has executable content**.</span></span>

   - <span data-ttu-id="d49e6-128">**Eseguire le operazioni seguenti**: selezionare **blocca il messaggio** e quindi scegliere l'azione desiderata:</span><span class="sxs-lookup"><span data-stu-id="d49e6-128">**Do the following**: Select **Block the message** and then choose the action you want:</span></span>

     - <span data-ttu-id="d49e6-129">**rifiuta il messaggio e Includi una spiegazione**: nella finestra di dialogo **specifica il motivo di rifiuto** che viene visualizzata, immettere il testo che si desidera visualizzare nel rapporto di mancato recapito (noto anche come NDR o messaggio di rimbalzo).</span><span class="sxs-lookup"><span data-stu-id="d49e6-129">**reject the message and include an explanation**: In the **Specify reject reason** dialog that appears, enter the text you want to appear in the non-delivery report (also known as an NDR or bounce message).</span></span> <span data-ttu-id="d49e6-130">Il codice di stato avanzato predefinito utilizzato è 5.7.1.</span><span class="sxs-lookup"><span data-stu-id="d49e6-130">The default enhanced status code that's used is 5.7.1.</span></span>

     - <span data-ttu-id="d49e6-131">**rifiutare il messaggio con il codice di stato avanzato seguente**: nella finestra di dialogo **Immetti codice di stato** avanzato visualizzato, immettere il codice di stato avanzato che si desidera venga visualizzato nel rapporto di mancato recapito.</span><span class="sxs-lookup"><span data-stu-id="d49e6-131">**reject the message with the enhanced status code of**:  In the **Enter enhanced status code** dialog that appears, enter the enhanced status code that you want to appear in the NDR.</span></span> <span data-ttu-id="d49e6-132">I valori validi sono 5.7.1 o un valore compreso tra 5.7.900 e 5.7.999.</span><span class="sxs-lookup"><span data-stu-id="d49e6-132">Valid values are 5.7.1 or a value from 5.7.900 to 5.7.999.</span></span> <span data-ttu-id="d49e6-133">Il testo di rifiuto predefinito è: Delivery not authorized, message refused.</span><span class="sxs-lookup"><span data-stu-id="d49e6-133">The default rejection text is: Delivery not authorized, message refused.</span></span>

     - <span data-ttu-id="d49e6-134">**rifiutare il messaggio senza inviare alcuna notifica**</span><span class="sxs-lookup"><span data-stu-id="d49e6-134">**reject the message without notifying anyone**</span></span>

4. <span data-ttu-id="d49e6-135">Al termine, scegliere **Salva**.</span><span class="sxs-lookup"><span data-stu-id="d49e6-135">When you're finished, click **Save**.</span></span> <span data-ttu-id="d49e6-136">A questo punto, la regola di blocco degli allegati è attiva.</span><span class="sxs-lookup"><span data-stu-id="d49e6-136">Your attachment blocking rule is now in force.</span></span>

## <a name="use-powershell-to-create-a-rule-that-blocks-messages-with-executable-attachments"></a><span data-ttu-id="d49e6-137">Utilizzo di PowerShell per creare una regola che consente di bloccare i messaggi con allegati eseguibili</span><span class="sxs-lookup"><span data-stu-id="d49e6-137">Use PowerShell to create a rule that blocks messages with executable attachments</span></span>

<span data-ttu-id="d49e6-138">Utilizzare la sintassi seguente per creare una regola per bloccare i messaggi che contengono allegati eseguibili:</span><span class="sxs-lookup"><span data-stu-id="d49e6-138">Use the following syntax to create a rule to blocks messages that contain executable attachments:</span></span>

```powershell
New-TransportRule -Name "<UniqueName>" -AttachmentHasExecutableContent $true [-RejectMessageEnhancedStatusCode <5.7.1 | 5.7.900 to 5.7.999>] [-RejectMessageReasonText "<Text>"] [-DeleteMessage $true]
```

<span data-ttu-id="d49e6-139">**Note**:</span><span class="sxs-lookup"><span data-stu-id="d49e6-139">**Notes**:</span></span>

- <span data-ttu-id="d49e6-140">Se si utilizza il parametro _RejectMessageEnhancedStatusCode_ senza il parametro _RejectMessageReasonText_ , il testo predefinito è: Delivery not authorized, message refused.</span><span class="sxs-lookup"><span data-stu-id="d49e6-140">If you use the _RejectMessageEnhancedStatusCode_ parameter without the _RejectMessageReasonText_ parameter, the default text is: Delivery not authorized, message refused.</span></span>

- <span data-ttu-id="d49e6-141">Se si utilizza il parametro _RejectMessageReasonText_ senza il parametro _RejectMessageEnhancedStatusCode_ , il codice predefinito è 5.7.1.</span><span class="sxs-lookup"><span data-stu-id="d49e6-141">If you use the _RejectMessageReasonText_ parameter without the _RejectMessageEnhancedStatusCode_ parameter, the default code is 5.7.1.</span></span>

<span data-ttu-id="d49e6-142">In questo esempio viene creata una nuova regola denominata Block Executable Attachments che consente di eliminare automaticamente i messaggi che contengono allegati eseguibili.</span><span class="sxs-lookup"><span data-stu-id="d49e6-142">This example creates a new rule named Block Executable Attachments that silently deletes messages that contain executable attachments.</span></span>

```powershell
New-TransportRule -Name "Block Executable Attachments" -AttachmentHasExecutableContent $true -DeleteMessage $true
```

<span data-ttu-id="d49e6-143">Per informazioni dettagliate su sintassi e parametri, vedere [New-TransportRule](https://docs.microsoft.com/powershell/module/exchange/new-transportrule).</span><span class="sxs-lookup"><span data-stu-id="d49e6-143">For detailed syntax and parameter information, see [New-TransportRule](https://docs.microsoft.com/powershell/module/exchange/new-transportrule).</span></span>

## <a name="how-do-you-know-this-worked"></a><span data-ttu-id="d49e6-144">Come verificare se l'operazione ha avuto esito positivo</span><span class="sxs-lookup"><span data-stu-id="d49e6-144">How do you know this worked?</span></span>

<span data-ttu-id="d49e6-145">Per verificare la corretta creazione di una regola del flusso di posta per bloccare i messaggi che contengono allegati eseguibili, eseguire una delle operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="d49e6-145">To verify that you've successfully create a mail flow rule to block messages that contain executable attachments, do any of the following steps:</span></span>

- <span data-ttu-id="d49e6-146">Nell'interfaccia di amministrazione di Exchange, andare a regole del **flusso di posta** \>  \> selezionare la regola \> fare clic su **Modifica** ![ icona modifica ](../../media/ITPro-EAC-EditIcon.png) e verificare le impostazioni.</span><span class="sxs-lookup"><span data-stu-id="d49e6-146">In the EAC, go to **Mail flow** \> **Rules** \> select the rule \> click **Edit** ![Edit icon](../../media/ITPro-EAC-EditIcon.png), and verify the settings.</span></span>

- <span data-ttu-id="d49e6-147">In PowerShell, eseguire il comando riportato di seguito per verificare le impostazioni:</span><span class="sxs-lookup"><span data-stu-id="d49e6-147">In PowerShell, run the following command to verify the settings:</span></span>

  ```powershell
  Get-TransportRule -Identity "<Rule Name>" | Format-List Name,AttachmentHasExecutableContent,RejectMessage*,DeleteMessage
  ```
