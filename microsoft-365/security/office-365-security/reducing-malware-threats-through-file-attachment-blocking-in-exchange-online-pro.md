---
title: Usare le regole del flusso di posta per bloccare i messaggi con allegati eseguibili
f1.keywords:
- NOCSH
ms.author: chrisda
author: chrisda
manager: dansimp
ms.date: ''
audience: ITPro
ms.topic: how-to
localization_priority: Normal
ms.assetid: c4fb4a86-b772-49d0-8773-e8ee897e175d
ms.custom:
- seo-marvel-apr2020
description: Gli amministratori possono imparare a creare regole del flusso di posta (regole di trasporto) per bloccare i messaggi che contengono allegati eseguibili.
ms.technology: mdo
ms.prod: m365-security
ms.openlocfilehash: 8631ae2a1370e338bfcc689c72d09533c39397a9
ms.sourcegitcommit: 27b2b2e5c41934b918cac2c171556c45e36661bf
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/19/2021
ms.locfileid: "50916911"
---
# <a name="use-mail-flow-rules-to-block-messages-with-executable-attachments-in-eop"></a><span data-ttu-id="fa278-103">Usare le regole del flusso di posta per bloccare messaggi con allegati eseguibili in Exchange Online Protection</span><span class="sxs-lookup"><span data-stu-id="fa278-103">Use mail flow rules to block messages with executable attachments in EOP</span></span>

[!INCLUDE [Microsoft 365 Defender rebranding](../includes/microsoft-defender-for-office.md)]

<span data-ttu-id="fa278-104">**Si applica a**</span><span class="sxs-lookup"><span data-stu-id="fa278-104">**Applies to**</span></span>
- [<span data-ttu-id="fa278-105">Exchange Online Protection</span><span class="sxs-lookup"><span data-stu-id="fa278-105">Exchange Online Protection</span></span>](exchange-online-protection-overview.md)
- [<span data-ttu-id="fa278-106">Microsoft Defender per Office 365 piano 1 e piano 2</span><span class="sxs-lookup"><span data-stu-id="fa278-106">Microsoft Defender for Office 365 plan 1 and plan 2</span></span>](office-365-atp.md)
- [<span data-ttu-id="fa278-107">Microsoft 365 Defender</span><span class="sxs-lookup"><span data-stu-id="fa278-107">Microsoft 365 Defender</span></span>](../mtp/microsoft-threat-protection.md)

<span data-ttu-id="fa278-108">Nelle organizzazioni di Microsoft 365 con cassette postali in Exchange Online o in organizzazioni autonome di Exchange Online Protection (EOP) senza cassette postali di Exchange Online, EOP utilizza criteri antimalware per bloccare i messaggi dannosi, inclusi i messaggi con allegati eseguibili.</span><span class="sxs-lookup"><span data-stu-id="fa278-108">In Microsoft 365 organizations with mailboxes in Exchange Online or standalone Exchange Online Protection (EOP) organizations without Exchange Online mailboxes, EOP uses anti-malware policies to block harmful messages, including messages with executable attachments.</span></span> <span data-ttu-id="fa278-109">Per ulteriori informazioni, vedere [Protezione antimalware in EOP.](anti-malware-protection.md)</span><span class="sxs-lookup"><span data-stu-id="fa278-109">For more information, see [Anti-malware protection in EOP](anti-malware-protection.md).</span></span>

<span data-ttu-id="fa278-110">Per migliorare ulteriormente la protezione, è possibile utilizzare le regole del flusso di posta (note anche come regole di trasporto) per identificare e bloccare i messaggi che contengono allegati eseguibili, come descritto in questo articolo.</span><span class="sxs-lookup"><span data-stu-id="fa278-110">To further enhance protection, you can use mail flow rules (also known as transport rules) to identify and block messages that contain executable attachments as described in this article.</span></span>

<span data-ttu-id="fa278-111">Ad esempio, in seguito a un'epidemia di malware, una società potrebbe applicare questa regola con un limite di tempo in modo che gli utenti interessati possano tornare a inviare allegati dopo un periodo di tempo specificato.</span><span class="sxs-lookup"><span data-stu-id="fa278-111">For example, following a malware outbreak, a company could apply this rule with a time limit so that affected users can get back to sending attachments after a specified length of time.</span></span>

## <a name="what-do-you-need-to-know-before-you-begin"></a><span data-ttu-id="fa278-112">Che cosa è necessario sapere prima di iniziare</span><span class="sxs-lookup"><span data-stu-id="fa278-112">What do you need to know before you begin?</span></span>

- <span data-ttu-id="fa278-113">Per eseguire le procedure descritte in questo articolo, è necessario disporre delle autorizzazioni in Exchange Online o Exchange Online Protection.</span><span class="sxs-lookup"><span data-stu-id="fa278-113">You need to be assigned permissions in Exchange Online or Exchange Online Protection before you can do the procedures in this article.</span></span> <span data-ttu-id="fa278-114">In particolare, è necessario il ruolo **Regole di** trasporto, assegnato  ai gruppi di ruoli **Gestione** **organizzazione,** Gestione conformità e Gestione record per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="fa278-114">Specifically, you need the **Transport Rules** role, which is assigned to the **Organization Management**, **Compliance Management**, and **Records Management** role groups by default.</span></span>

  <span data-ttu-id="fa278-115">Per ulteriori informazioni, vedere i seguenti argomenti:</span><span class="sxs-lookup"><span data-stu-id="fa278-115">For more information, see the following topics:</span></span>

  - [<span data-ttu-id="fa278-116">Autorizzazioni in Exchange Online</span><span class="sxs-lookup"><span data-stu-id="fa278-116">Permissions in Exchange Online</span></span>](/exchange/permissions-exo/permissions-exo)
  - [<span data-ttu-id="fa278-117">Autorizzazioni in Exchange Online Protection autonomo</span><span class="sxs-lookup"><span data-stu-id="fa278-117">Permissions in standalone EOP</span></span>](feature-permissions-in-eop.md)
  - [<span data-ttu-id="fa278-118">Utilizzo dell'interfaccia di amministrazione di Exchange per modificare l'elenco dei membri nei gruppi di ruoli</span><span class="sxs-lookup"><span data-stu-id="fa278-118">Use the EAC modify the list of members in role groups</span></span>](manage-admin-role-group-permissions-in-eop.md#use-the-eac-modify-the-list-of-members-in-role-groups)

- <span data-ttu-id="fa278-119">Per aprire l'interfaccia di amministrazione di Exchange in Exchange Online, vedere Interfaccia di amministrazione [di Exchange in Exchange Online.](/Exchange/exchange-admin-center)</span><span class="sxs-lookup"><span data-stu-id="fa278-119">To open the EAC in Exchange Online, see [Exchange admin center in Exchange Online](/Exchange/exchange-admin-center).</span></span> <span data-ttu-id="fa278-120">Per aprire l'interfaccia di amministrazione di Exchange in EOP autonomo, vedere Interfaccia di amministrazione [di Exchange in EOP autonomo.](exchange-admin-center-in-exchange-online-protection-eop.md)</span><span class="sxs-lookup"><span data-stu-id="fa278-120">To open the EAC in standalone EOP, see [Exchange admin center in standalone EOP](exchange-admin-center-in-exchange-online-protection-eop.md).</span></span>

- <span data-ttu-id="fa278-121">Per informazioni su come connettersi a PowerShell per Exchange Online, vedere [Connettersi a PowerShell per Exchange Online](/powershell/exchange/connect-to-exchange-online-powershell).</span><span class="sxs-lookup"><span data-stu-id="fa278-121">To connect to Exchange Online PowerShell, see [Connect to Exchange Online PowerShell](/powershell/exchange/connect-to-exchange-online-powershell).</span></span> <span data-ttu-id="fa278-122">Per connettersi a PowerShell di EOP autonomo, vedere [Connettersi a PowerShell per Exchange Online Protection](/powershell/exchange/connect-to-exchange-online-protection-powershell).</span><span class="sxs-lookup"><span data-stu-id="fa278-122">To connect to standalone EOP PowerShell, see [Connect to Exchange Online Protection PowerShell](/powershell/exchange/connect-to-exchange-online-protection-powershell).</span></span>

- <span data-ttu-id="fa278-123">Per ulteriori informazioni sulle regole del flusso di posta in Exchange Online e in EOP autonomo, vedere i seguenti argomenti:</span><span class="sxs-lookup"><span data-stu-id="fa278-123">For more information about mail flow rules in Exchange Online and standalone EOP, see the following topics:</span></span>

  - [<span data-ttu-id="fa278-124">Regole del flusso di posta (regole di trasporto) in Exchange Online</span><span class="sxs-lookup"><span data-stu-id="fa278-124">Mail flow rules (transport rules) in Exchange Online</span></span>](/Exchange/security-and-compliance/mail-flow-rules/mail-flow-rules)

  - [<span data-ttu-id="fa278-125">Condizioni ed eccezioni della regola del flusso di posta (predicati) in Exchange Online</span><span class="sxs-lookup"><span data-stu-id="fa278-125">Mail flow rule conditions and exceptions (predicates) in Exchange Online</span></span>](/Exchange/security-and-compliance/mail-flow-rules/conditions-and-exceptions)

  - [<span data-ttu-id="fa278-126">Azioni delle regole del flusso di posta in Exchange Online</span><span class="sxs-lookup"><span data-stu-id="fa278-126">Mail flow rule actions in Exchange Online</span></span>](/Exchange/security-and-compliance/mail-flow-rules/mail-flow-rule-actions)

## <a name="use-the-eac-to-create-a-rule-that-blocks-messages-with-executable-attachments"></a><span data-ttu-id="fa278-127">Creazione di una regola che blocca i messaggi con allegati eseguibili tramite EAC</span><span class="sxs-lookup"><span data-stu-id="fa278-127">Use the EAC to create a rule that blocks messages with executable attachments</span></span>

1. <span data-ttu-id="fa278-128">Nell'interfaccia di amministrazione di Exchange, andare a **Flusso di posta** \> **Regole**.</span><span class="sxs-lookup"><span data-stu-id="fa278-128">In the EAC, go to **Mail flow** \> **Rules**.</span></span>

2. <span data-ttu-id="fa278-129">Fare **clic su** Aggiungi Icona Aggiungi e quindi selezionare Crea una nuova ![ ](../../media/ITPro-EAC-AddIcon.png) **regola.**</span><span class="sxs-lookup"><span data-stu-id="fa278-129">Click **Add** ![Add icon](../../media/ITPro-EAC-AddIcon.png) and then select **Create a new rule**.</span></span>

3. <span data-ttu-id="fa278-130">Nella pagina **Nuova regola** che si apre, configurare le seguenti impostazioni:</span><span class="sxs-lookup"><span data-stu-id="fa278-130">In the **New rule** page that opens, configure the following settings:</span></span>

   - <span data-ttu-id="fa278-131">**Nome**: immettere un nome descrittivo univoco per la regola.</span><span class="sxs-lookup"><span data-stu-id="fa278-131">**Name**: Enter a unique, descriptive name for the rule.</span></span>

   - <span data-ttu-id="fa278-132">Fare **clic su Altre opzioni.**</span><span class="sxs-lookup"><span data-stu-id="fa278-132">Click **More Options**.</span></span>

   - <span data-ttu-id="fa278-133">**Applica questa regola se**: Selezionare Qualsiasi **allegato** \> **con contenuto eseguibile.**</span><span class="sxs-lookup"><span data-stu-id="fa278-133">**Apply this rule if**: Select **Any attachment** \> **has executable content**.</span></span>

   - <span data-ttu-id="fa278-134">**Eseguire le operazioni seguenti:** Selezionare **Blocca il messaggio** e quindi scegliere l'azione desiderata:</span><span class="sxs-lookup"><span data-stu-id="fa278-134">**Do the following**: Select **Block the message** and then choose the action you want:</span></span>

     - <span data-ttu-id="fa278-135">**rifiutare il messaggio** e includere  una spiegazione: nella finestra di dialogo Specifica motivo rifiuto visualizzata immettere il testo che si desidera visualizzare nel rapporto di mancato recapito (noto anche come rapporto di mancato recapito o messaggio di mancato recapito).</span><span class="sxs-lookup"><span data-stu-id="fa278-135">**reject the message and include an explanation**: In the **Specify reject reason** dialog that appears, enter the text you want to appear in the non-delivery report (also known as an NDR or bounce message).</span></span> <span data-ttu-id="fa278-136">Il codice di stato avanzato predefinito utilizzato è 5.7.1.</span><span class="sxs-lookup"><span data-stu-id="fa278-136">The default enhanced status code that's used is 5.7.1.</span></span>

     - <span data-ttu-id="fa278-137">**rifiutare il messaggio** con il codice  di stato avanzato di : Nella finestra di dialogo Immetti codice di stato avanzato visualizzata, immettere il codice di stato avanzato che si desidera visualizzare nel rapporto di mancato recapito.</span><span class="sxs-lookup"><span data-stu-id="fa278-137">**reject the message with the enhanced status code of**:  In the **Enter enhanced status code** dialog that appears, enter the enhanced status code that you want to appear in the NDR.</span></span> <span data-ttu-id="fa278-138">I valori validi sono 5.7.1 o un valore compreso tra 5.7.900 e 5.7.999.</span><span class="sxs-lookup"><span data-stu-id="fa278-138">Valid values are 5.7.1 or a value from 5.7.900 to 5.7.999.</span></span> <span data-ttu-id="fa278-139">Il testo di rifiuto predefinito è: Recapito non autorizzato, messaggio rifiutato.</span><span class="sxs-lookup"><span data-stu-id="fa278-139">The default rejection text is: Delivery not authorized, message refused.</span></span>

     - <span data-ttu-id="fa278-140">**rifiutare il messaggio senza informare nessuno**</span><span class="sxs-lookup"><span data-stu-id="fa278-140">**reject the message without notifying anyone**</span></span>

4. <span data-ttu-id="fa278-141">Al termine, fare clic su **Salva**.</span><span class="sxs-lookup"><span data-stu-id="fa278-141">When you're finished, click **Save**.</span></span> <span data-ttu-id="fa278-142">A questo punto, la regola di blocco degli allegati è attiva.</span><span class="sxs-lookup"><span data-stu-id="fa278-142">Your attachment blocking rule is now in force.</span></span>

## <a name="use-powershell-to-create-a-rule-that-blocks-messages-with-executable-attachments"></a><span data-ttu-id="fa278-143">Utilizzare PowerShell per creare una regola che blocca i messaggi con allegati eseguibili</span><span class="sxs-lookup"><span data-stu-id="fa278-143">Use PowerShell to create a rule that blocks messages with executable attachments</span></span>

<span data-ttu-id="fa278-144">Utilizzare la sintassi seguente per creare una regola per bloccare i messaggi che contengono allegati eseguibili:</span><span class="sxs-lookup"><span data-stu-id="fa278-144">Use the following syntax to create a rule to blocks messages that contain executable attachments:</span></span>

```powershell
New-TransportRule -Name "<UniqueName>" -AttachmentHasExecutableContent $true [-RejectMessageEnhancedStatusCode <5.7.1 | 5.7.900 to 5.7.999>] [-RejectMessageReasonText "<Text>"] [-DeleteMessage $true]
```

<span data-ttu-id="fa278-145">**Note**:</span><span class="sxs-lookup"><span data-stu-id="fa278-145">**Notes**:</span></span>

- <span data-ttu-id="fa278-146">Se si utilizza il _parametro RejectMessageEnhancedStatusCode_ senza il parametro _RejectMessageReasonText,_ il testo predefinito è: Recapito non autorizzato, messaggio rifiutato.</span><span class="sxs-lookup"><span data-stu-id="fa278-146">If you use the _RejectMessageEnhancedStatusCode_ parameter without the _RejectMessageReasonText_ parameter, the default text is: Delivery not authorized, message refused.</span></span>

- <span data-ttu-id="fa278-147">Se si utilizza il _parametro RejectMessageReasonText_ senza il _parametro RejectMessageEnhancedStatusCode,_ il codice predefinito è 5.7.1.</span><span class="sxs-lookup"><span data-stu-id="fa278-147">If you use the _RejectMessageReasonText_ parameter without the _RejectMessageEnhancedStatusCode_ parameter, the default code is 5.7.1.</span></span>

<span data-ttu-id="fa278-148">In questo esempio viene creata una nuova regola denominata Blocca allegati eseguibili che elimina automaticamente i messaggi che contengono allegati eseguibili.</span><span class="sxs-lookup"><span data-stu-id="fa278-148">This example creates a new rule named Block Executable Attachments that silently deletes messages that contain executable attachments.</span></span>

```powershell
New-TransportRule -Name "Block Executable Attachments" -AttachmentHasExecutableContent $true -DeleteMessage $true
```

<span data-ttu-id="fa278-149">Per informazioni dettagliate su sintassi e parametri, vedere [New-TransportRule](/powershell/module/exchange/new-transportrule).</span><span class="sxs-lookup"><span data-stu-id="fa278-149">For detailed syntax and parameter information, see [New-TransportRule](/powershell/module/exchange/new-transportrule).</span></span>

## <a name="how-do-you-know-this-worked"></a><span data-ttu-id="fa278-150">Come verificare se l'operazione ha avuto esito positivo</span><span class="sxs-lookup"><span data-stu-id="fa278-150">How do you know this worked?</span></span>

<span data-ttu-id="fa278-151">Per verificare la corretta creazione di una regola del flusso di posta per bloccare i messaggi che contengono allegati eseguibili, eseguire una delle operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="fa278-151">To verify that you've successfully create a mail flow rule to block messages that contain executable attachments, do any of the following steps:</span></span>

- <span data-ttu-id="fa278-152">Nell'interfaccia di amministrazione di Exchange, andare a **Flusso** di posta Regole selezionare la regola fare clic \>  \> su \> **Modifica** Icona Modifica e verificare ![ le ](../../media/ITPro-EAC-EditIcon.png) impostazioni.</span><span class="sxs-lookup"><span data-stu-id="fa278-152">In the EAC, go to **Mail flow** \> **Rules** \> select the rule \> click **Edit** ![Edit icon](../../media/ITPro-EAC-EditIcon.png), and verify the settings.</span></span>

- <span data-ttu-id="fa278-153">In PowerShell, eseguire il comando seguente per verificare le impostazioni:</span><span class="sxs-lookup"><span data-stu-id="fa278-153">In PowerShell, run the following command to verify the settings:</span></span>

  ```powershell
  Get-TransportRule -Identity "<Rule Name>" | Format-List Name,AttachmentHasExecutableContent,RejectMessage*,DeleteMessage
  ```