---
title: Utilizzare le regole del flusso di posta per bloccare i messaggi con allegati eseguibili
f1.keywords:
- NOCSH
ms.author: chrisda
author: chrisda
manager: dansimp
ms.date: ''
audience: ITPro
ms.topic: how-to
localization_priority: Normal
ms.assetid: c4fb4a86-b772-49d0-8773-e8ee897e175d
ms.custom:
- seo-marvel-apr2020
description: Gli amministratori possono imparare a creare regole del flusso di posta (regole di trasporto) per bloccare i messaggi che contengono allegati eseguibili.
ms.technology: mdo
ms.prod: m365-security
ms.openlocfilehash: 2145698f4268e592582024114216902fdab4c76d
ms.sourcegitcommit: a1846b1ee2e4fa397e39c1271c997fc4cf6d5619
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 02/09/2021
ms.locfileid: "50166892"
---
# <a name="use-mail-flow-rules-to-block-messages-with-executable-attachments-in-eop"></a>Usare le regole del flusso di posta per bloccare messaggi con allegati eseguibili in Exchange Online Protection

[!INCLUDE [Microsoft 365 Defender rebranding](../includes/microsoft-defender-for-office.md)]

**Si applica a**
- [Exchange Online Protection](https://go.microsoft.com/fwlink/?linkid=2148611)
- [Microsoft Defender per Office 365 piano 1 e piano 2](https://go.microsoft.com/fwlink/?linkid=2148715)
- [Microsoft 365 Defender](https://go.microsoft.com/fwlink/?linkid=2118804)

Nelle organizzazioni di Microsoft 365 con cassette postali in Exchange Online o nelle organizzazioni Exchange Online Protection (EOP) autonome senza cassette postali di Exchange Online, EOP utilizza criteri antimalware per bloccare i messaggi dannosi, inclusi i messaggi con allegati eseguibili. Per ulteriori informazioni, vedere [Protezione antimalware in EOP.](anti-malware-protection.md)

Per migliorare ulteriormente la protezione, è possibile utilizzare le regole del flusso di posta (note anche come regole di trasporto) per identificare e bloccare i messaggi che contengono allegati eseguibili, come descritto in questo articolo.

Ad esempio, in seguito a un attacco malware, una società potrebbe applicare questa regola con un limite di tempo in modo che gli utenti interessati possano tornare a inviare allegati dopo un periodo di tempo specificato.

## <a name="what-do-you-need-to-know-before-you-begin"></a>Che cosa è necessario sapere prima di iniziare

- Per eseguire le procedure descritte in questo articolo, è necessario disporre delle autorizzazioni in Exchange Online o Exchange Online Protection. In particolare, è necessario il ruolo **Regole** di trasporto, assegnato  ai gruppi di ruoli Gestione **organizzazione,** Gestione conformità e Gestione record per impostazione predefinita.

  Per ulteriori informazioni, vedere i seguenti argomenti:

  - [Autorizzazioni in Exchange Online](https://docs.microsoft.com/exchange/permissions-exo/permissions-exo)
  - [Autorizzazioni in Exchange Online Protection autonomo](feature-permissions-in-eop.md)
  - [Utilizzo dell'interfaccia di amministrazione di Exchange per modificare l'elenco dei membri nei gruppi di ruoli](manage-admin-role-group-permissions-in-eop.md#use-the-eac-modify-the-list-of-members-in-role-groups)

- Per aprire l'interfaccia di amministrazione di Exchange in Exchange Online, vedere Interfaccia di amministrazione [di Exchange in Exchange Online.](https://docs.microsoft.com/Exchange/exchange-admin-center) Per aprire l'interfaccia di amministrazione di Exchange in EOP autonomo, vedere Interfaccia di amministrazione [di Exchange in EOP autonomo.](exchange-admin-center-in-exchange-online-protection-eop.md)

- Per informazioni su come connettersi a PowerShell per Exchange Online, vedere [Connettersi a PowerShell per Exchange Online](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-powershell). Per connettersi a PowerShell di EOP autonomo, vedere [Connettersi a PowerShell per Exchange Online Protection](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-protection-powershell).

- Per ulteriori informazioni sulle regole del flusso di posta in Exchange Online ed EOP autonomo, vedere i seguenti argomenti:

  - [Regole del flusso di posta (regole di trasporto) in Exchange Online](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/mail-flow-rules)

  - [Condizioni ed eccezioni della regola del flusso di posta (predicati) in Exchange Online](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/conditions-and-exceptions)

  - [Azioni delle regole del flusso di posta in Exchange Online](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/mail-flow-rule-actions)

## <a name="use-the-eac-to-create-a-rule-that-blocks-messages-with-executable-attachments"></a>Utilizzo dell'interfaccia di amministrazione di Exchange per creare una regola che blocca i messaggi con allegati eseguibili

1. Nell'interfaccia di amministrazione di Exchange, andare a **Flusso di posta** \> **Regole**.

2. Fare **clic sull'icona** ![ Aggiungi e quindi selezionare Crea una nuova ](../../media/ITPro-EAC-AddIcon.png) **regola.**

3. Nella pagina **Nuova regola** che si apre, configurare le seguenti impostazioni:

   - **Nome**: immettere un nome descrittivo univoco per la regola.

   - Fare **clic su Altre opzioni.**

   - **Applica questa regola se**: Seleziona qualsiasi **allegato** \> **con contenuto eseguibile.**

   - **Eseguire le operazioni seguenti:** Selezionare **Blocca il messaggio** e quindi scegliere l'azione desiderata:

     - **rifiutare** il messaggio e includere  una spiegazione: nella finestra di dialogo Specifica motivo rifiuto visualizzata, immettere il testo che si desidera visualizzare nel rapporto di mancato recapito (noto anche come NDR o notifica di mancato recapito). Il codice di stato avanzato predefinito utilizzato è 5.7.1.

     - **rifiutare il messaggio** con il codice  di stato avanzato di : nella finestra di dialogo Immetti codice di stato avanzato visualizzata, immettere il codice di stato avanzato che si desidera visualizzare nel rapporto di mancato recapito. I valori validi sono 5.7.1 o un valore compreso tra 5.7.900 e 5.7.999. Il testo di rifiuto predefinito è: Recapito non autorizzato, messaggio rifiutato.

     - **rifiutare il messaggio senza inviare alcuna notifica**

4. Al termine, fare clic su **Salva**. A questo punto, la regola di blocco degli allegati è attiva.

## <a name="use-powershell-to-create-a-rule-that-blocks-messages-with-executable-attachments"></a>Utilizzare PowerShell per creare una regola che blocchi i messaggi con allegati eseguibili

Utilizzare la sintassi seguente per creare una regola per bloccare i messaggi che contengono allegati eseguibili:

```powershell
New-TransportRule -Name "<UniqueName>" -AttachmentHasExecutableContent $true [-RejectMessageEnhancedStatusCode <5.7.1 | 5.7.900 to 5.7.999>] [-RejectMessageReasonText "<Text>"] [-DeleteMessage $true]
```

**Note**:

- Se si utilizza il _parametro RejectMessageEnhancedStatusCode_ senza il parametro _RejectMessageReasonText,_ il testo predefinito è: Recapito non autorizzato, messaggio rifiutato.

- Se si utilizza il _parametro RejectMessageReasonText_ senza il parametro _RejectMessageEnhancedStatusCode,_ il codice predefinito è 5.7.1.

In questo esempio viene creata una nuova regola denominata Blocca allegati eseguibili che elimina automaticamente i messaggi che contengono allegati eseguibili.

```powershell
New-TransportRule -Name "Block Executable Attachments" -AttachmentHasExecutableContent $true -DeleteMessage $true
```

Per informazioni dettagliate su sintassi e parametri, vedere [New-TransportRule](https://docs.microsoft.com/powershell/module/exchange/new-transportrule).

## <a name="how-do-you-know-this-worked"></a>Come verificare se l'operazione ha avuto esito positivo

Per verificare la corretta creazione di una regola del flusso di posta per bloccare i messaggi contenenti allegati eseguibili, eseguire una delle operazioni seguenti:

- Nell'interfaccia di amministrazione di Exchange, andare a **Regole** del flusso di posta selezionare la regola fare clic \>  \> \> **sull'icona** Modifica ![ modifica e verificare le ](../../media/ITPro-EAC-EditIcon.png) impostazioni.

- In PowerShell, eseguire il comando seguente per verificare le impostazioni:

  ```powershell
  Get-TransportRule -Identity "<Rule Name>" | Format-List Name,AttachmentHasExecutableContent,RejectMessage*,DeleteMessage
  ```
