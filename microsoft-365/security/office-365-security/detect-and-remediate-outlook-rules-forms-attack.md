---
title: Rilevare e correggere le regole di Outlook e gli attacchi di inserimento di moduli personalizzati.
f1.keywords:
- NOCSH
ms.author: tracyp
author: MSFTTracyp
manager: dansimp
ms.date: 04/23/2018
audience: ITPro
ms.topic: article
ms.collection:
- o365_security_incident_response
- M365-security-compliance
localization_priority: Normal
search.appverid:
- MET150
description: Informazioni su come riconoscere e correggere gli attacchi iniezioni di moduli personalizzati e regole di Outlook in Office 365
ms.custom: seo-marvel-apr2020
ms.technology: mdo
ms.prod: m365-security
ms.openlocfilehash: 0846051b65b34ec26358f87bb4ca49302573e6e7
ms.sourcegitcommit: 27b2b2e5c41934b918cac2c171556c45e36661bf
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/19/2021
ms.locfileid: "50917047"
---
# <a name="detect-and-remediate-outlook-rules-and-custom-forms-injections-attacks"></a><span data-ttu-id="8516b-103">Rilevare e correggere le regole di Outlook e gli attacchi iniezioni di moduli personalizzati</span><span class="sxs-lookup"><span data-stu-id="8516b-103">Detect and Remediate Outlook Rules and Custom Forms Injections Attacks</span></span>

[!INCLUDE [Microsoft 365 Defender rebranding](../includes/microsoft-defender-for-office.md)]


<span data-ttu-id="8516b-104">**Riepilogo** Informazioni su come riconoscere e correggere le regole di Outlook e gli attacchi iniezioni di moduli personalizzati in Office 365.</span><span class="sxs-lookup"><span data-stu-id="8516b-104">**Summary** Learn how to recognize and remediate the Outlook rules and custom Forms injections attacks in Office 365.</span></span>

## <a name="what-is-the-outlook-rules-and-custom-forms-injection-attack"></a><span data-ttu-id="8516b-105">Che cos'è l'attacco di inserimento di regole e moduli personalizzati di Outlook?</span><span class="sxs-lookup"><span data-stu-id="8516b-105">What is the Outlook Rules and Custom Forms injection attack?</span></span>

<span data-ttu-id="8516b-106">Dopo che un utente malintenzionato ottiene l'accesso all'organizzazione, tenterà di stabilire un punto di appoggio per rimanere o rientrare dopo essere stato individuato.</span><span class="sxs-lookup"><span data-stu-id="8516b-106">After an attacker gains access to your organization, they'll try to establish a foothold to stay in or get back in after they've been discovered.</span></span> <span data-ttu-id="8516b-107">Questa attività è denominata *definizione di un meccanismo di persistenza.*</span><span class="sxs-lookup"><span data-stu-id="8516b-107">This activity is called *establishing a persistence mechanism*.</span></span> <span data-ttu-id="8516b-108">Un utente malintenzionato può utilizzare Outlook in due modi per stabilire un meccanismo di persistenza:</span><span class="sxs-lookup"><span data-stu-id="8516b-108">There are two ways that an attacker can use Outlook to establish a persistence mechanism:</span></span>

- <span data-ttu-id="8516b-109">Sfruttando le regole di Outlook.</span><span class="sxs-lookup"><span data-stu-id="8516b-109">By exploiting Outlook rules.</span></span>
- <span data-ttu-id="8516b-110">Iniettando moduli personalizzati in Outlook.</span><span class="sxs-lookup"><span data-stu-id="8516b-110">By injecting custom forms into Outlook.</span></span>

<span data-ttu-id="8516b-111">La reinstallazione di Outlook o anche l'installazione di un nuovo computer da parte della persona interessata non sarà utile.</span><span class="sxs-lookup"><span data-stu-id="8516b-111">Reinstalling Outlook, or even giving the affected person a new computer won't help.</span></span> <span data-ttu-id="8516b-112">Quando la nuova installazione di Outlook si connette alla cassetta postale, tutte le regole e i moduli vengono sincronizzati dal cloud.</span><span class="sxs-lookup"><span data-stu-id="8516b-112">When the fresh installation of Outlook connects to the mailbox, all rules and forms are synchronized from the cloud.</span></span> <span data-ttu-id="8516b-113">Le regole o i moduli sono in genere progettati per eseguire codice remoto e installare malware nel computer locale.</span><span class="sxs-lookup"><span data-stu-id="8516b-113">The rules or forms are typically designed to run remote code and install malware on the local machine.</span></span> <span data-ttu-id="8516b-114">Il malware ruba le credenziali o esegue altre attività illecite.</span><span class="sxs-lookup"><span data-stu-id="8516b-114">The malware steals credentials or performs other illicit activity.</span></span>

<span data-ttu-id="8516b-115">La buona notizia è che se si mantiene i client outlook patch alla versione più recente, non si è vulnerabili alla minaccia in quanto le impostazioni predefinite correnti del client outlook bloccano entrambi i meccanismi.</span><span class="sxs-lookup"><span data-stu-id="8516b-115">The good news is: if you keep your Outlook clients patched to the latest version, you aren't vulnerable to the threat as current Outlook client defaults block both mechanisms.</span></span>

<span data-ttu-id="8516b-116">Gli attacchi in genere seguono questi modelli:</span><span class="sxs-lookup"><span data-stu-id="8516b-116">The attacks typically follow these patterns:</span></span>

<span data-ttu-id="8516b-117">**L'exploit delle regole**:</span><span class="sxs-lookup"><span data-stu-id="8516b-117">**The Rules Exploit**:</span></span>

1. <span data-ttu-id="8516b-118">L'autore dell'attacco ruba le credenziali di un utente.</span><span class="sxs-lookup"><span data-stu-id="8516b-118">The attacker steals a user's credentials.</span></span>

2. <span data-ttu-id="8516b-119">L'autore dell'attacco accede alla cassetta postale di Exchange dell'utente (Exchange Online o Exchange locale).</span><span class="sxs-lookup"><span data-stu-id="8516b-119">The attacker signs in to that user's Exchange mailbox (Exchange Online or on-premises Exchange).</span></span>

3. <span data-ttu-id="8516b-120">L'autore dell'attacco crea una regola di posta in arrivo di inoltro nella cassetta postale.</span><span class="sxs-lookup"><span data-stu-id="8516b-120">The attacker creates a forwarding Inbox rule in the mailbox.</span></span> <span data-ttu-id="8516b-121">La regola di inoltro viene attivata quando la cassetta postale riceve un messaggio specifico dall'autore dell'attacco che soddisfa le condizioni della regola.</span><span class="sxs-lookup"><span data-stu-id="8516b-121">The forwarding rule is triggered when the mailbox receives a specific message from the attacker that matches the conditions of the rule.</span></span> <span data-ttu-id="8516b-122">Le condizioni della regola e il formato del messaggio sono personalizzati l'uno per l'altro.</span><span class="sxs-lookup"><span data-stu-id="8516b-122">The rule conditions and message format are tailor-made for each other.</span></span>

4. <span data-ttu-id="8516b-123">L'utente malintenzionato invia il messaggio di posta elettronica di attivazione alla cassetta postale compromessa, che viene comunque utilizzata normalmente dall'utente ignara.</span><span class="sxs-lookup"><span data-stu-id="8516b-123">The attacker sends the trigger email to the compromised mailbox, which is still being used as normal by the unsuspecting user.</span></span>

5. <span data-ttu-id="8516b-124">Quando la cassetta postale riceve un messaggio che soddisfa le condizioni della regola, viene applicata l'azione della regola.</span><span class="sxs-lookup"><span data-stu-id="8516b-124">When the mailbox receives a message that matches the conditions of rule, the action of the rule is applied.</span></span> <span data-ttu-id="8516b-125">In genere, l'azione della regola è avviare un'applicazione in un server remoto (WebDAV).</span><span class="sxs-lookup"><span data-stu-id="8516b-125">Typically, the rule action is to launch an application on a remote (WebDAV) server.</span></span>

6. <span data-ttu-id="8516b-126">In genere, l'applicazione installa malware nel computer dell'utente (ad esempio, [PowerShell Imperial](https://www.powershellempire.com/)).</span><span class="sxs-lookup"><span data-stu-id="8516b-126">Typically, the application installs malware on the user's machine (for example, [PowerShell Empire](https://www.powershellempire.com/)).</span></span>

7. <span data-ttu-id="8516b-127">Il malware consente all'utente malintenzionato di rubare (o rubare di nuovo) il nome utente e la password o altre credenziali dal computer locale ed eseguire altre attività dannose.</span><span class="sxs-lookup"><span data-stu-id="8516b-127">The malware allows the attacker to steal (or steal again) the user's username and password or other credentials from local machine and perform other malicious activities.</span></span>

<span data-ttu-id="8516b-128">**L'exploit dei moduli**:</span><span class="sxs-lookup"><span data-stu-id="8516b-128">**The Forms Exploit**:</span></span>

1. <span data-ttu-id="8516b-129">L'autore dell'attacco ruba le credenziali di un utente.</span><span class="sxs-lookup"><span data-stu-id="8516b-129">The attacker steals a user's credentials.</span></span>

2. <span data-ttu-id="8516b-130">L'autore dell'attacco accede alla cassetta postale di Exchange dell'utente (Exchange Online o Exchange locale).</span><span class="sxs-lookup"><span data-stu-id="8516b-130">The attacker signs in to that user's Exchange mailbox (Exchange Online or on-premises Exchange).</span></span>

3. <span data-ttu-id="8516b-131">L'autore dell'attacco inserisce un modello di modulo di posta elettronica personalizzato nella cassetta postale dell'utente.</span><span class="sxs-lookup"><span data-stu-id="8516b-131">The attacker inserts a custom mail form template into the user's mailbox.</span></span> <span data-ttu-id="8516b-132">Il modulo personalizzato viene attivato quando la cassetta postale riceve un messaggio specifico dall'autore dell'attacco che richiede alla cassetta postale di caricare il modulo personalizzato.</span><span class="sxs-lookup"><span data-stu-id="8516b-132">The custom form is triggered when the mailbox receives a specific message from the attacker that requires the mailbox to load the custom form.</span></span> <span data-ttu-id="8516b-133">Il modulo personalizzato e il formato del messaggio sono personalizzati l'uno per l'altro.</span><span class="sxs-lookup"><span data-stu-id="8516b-133">The custom form and the message format are tailor-made for each other.</span></span>

4. <span data-ttu-id="8516b-134">L'utente malintenzionato invia il messaggio di posta elettronica di attivazione alla cassetta postale compromessa, che viene comunque utilizzata normalmente dall'utente ignara.</span><span class="sxs-lookup"><span data-stu-id="8516b-134">The attacker sends the trigger email to the compromised mailbox, which is still being used as normal by the unsuspecting user.</span></span>

5. <span data-ttu-id="8516b-135">Quando la cassetta postale riceve il messaggio, la cassetta postale carica il modulo necessario.</span><span class="sxs-lookup"><span data-stu-id="8516b-135">When the mailbox receives the message, the mailbox loads the required form.</span></span> <span data-ttu-id="8516b-136">Il modulo avvia un'applicazione in un server remoto (WebDAV).</span><span class="sxs-lookup"><span data-stu-id="8516b-136">The form launches an application on a remote (WebDAV) server.</span></span>

6. <span data-ttu-id="8516b-137">In genere, l'applicazione installa malware nel computer dell'utente (ad esempio, [PowerShell Imperial](https://www.powershellempire.com/)).</span><span class="sxs-lookup"><span data-stu-id="8516b-137">Typically, the application installs malware on the user's machine (for example, [PowerShell Empire](https://www.powershellempire.com/)).</span></span>

7. <span data-ttu-id="8516b-138">Il malware consente all'utente malintenzionato di rubare (o rubare di nuovo) il nome utente e la password o altre credenziali dal computer locale ed eseguire altre attività dannose.</span><span class="sxs-lookup"><span data-stu-id="8516b-138">The malware allows the attacker to steal (or steal again) the user's username and password or other credentials from local machine and perform other malicious activities.</span></span>

## <a name="what-a-rules-and-custom-forms-injection-attack-might-look-like-office-365"></a><span data-ttu-id="8516b-139">Che aspetto potrebbe avere un attacco di inserimento di regole e moduli personalizzati come Office 365?</span><span class="sxs-lookup"><span data-stu-id="8516b-139">What a Rules and Custom Forms Injection attack might look like Office 365?</span></span>

<span data-ttu-id="8516b-140">È improbabile che questi meccanismi di persistenza siano notati dagli utenti e in alcuni casi potrebbero anche essere invisibili.</span><span class="sxs-lookup"><span data-stu-id="8516b-140">These persistence mechanisms are unlikely to be noticed by your users and may in some cases even be invisible to them.</span></span> <span data-ttu-id="8516b-141">In questo articolo viene illustrato come cercare uno dei sette segni (Indicatori di compromissione) elencati di seguito.</span><span class="sxs-lookup"><span data-stu-id="8516b-141">This article tells you how to look for any of the seven signs (Indicators of Compromise) listed below.</span></span> <span data-ttu-id="8516b-142">Se si trova uno di questi elementi, è necessario eseguire la procedura di correzione.</span><span class="sxs-lookup"><span data-stu-id="8516b-142">If you find any of these, you need to take remediation steps.</span></span>

- <span data-ttu-id="8516b-143">**Indicatori della compromissione delle regole**:</span><span class="sxs-lookup"><span data-stu-id="8516b-143">**Indicators of the Rules compromise**:</span></span>
  - <span data-ttu-id="8516b-144">Regola L'azione consente di avviare un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="8516b-144">Rule Action is to start an application.</span></span>
  - <span data-ttu-id="8516b-145">La regola fa riferimento a un FILE EXE, ZIP o URL.</span><span class="sxs-lookup"><span data-stu-id="8516b-145">Rule References an EXE, ZIP, or URL.</span></span>
  - <span data-ttu-id="8516b-146">Nel computer locale cercare i nuovi processi avviati dal PID di Outlook.</span><span class="sxs-lookup"><span data-stu-id="8516b-146">On the local machine, look for new process starts that originate from the Outlook PID.</span></span>

- <span data-ttu-id="8516b-147">**Indicatori della compromissione dei moduli personalizzati:**</span><span class="sxs-lookup"><span data-stu-id="8516b-147">**Indicators of the Custom forms compromise**:</span></span>
  - <span data-ttu-id="8516b-148">Moduli personalizzati presenti salvati come classe messaggio personalizzata.</span><span class="sxs-lookup"><span data-stu-id="8516b-148">Custom forms present saved as their own message class.</span></span>
  - <span data-ttu-id="8516b-149">La classe messaggio contiene codice eseguibile.</span><span class="sxs-lookup"><span data-stu-id="8516b-149">Message class contains executable code.</span></span>
  - <span data-ttu-id="8516b-150">In genere, i moduli dannosi vengono archiviati nelle cartelle Libreria moduli personali o Posta in arrivo.</span><span class="sxs-lookup"><span data-stu-id="8516b-150">Typically, malicious forms are stored in Personal Forms Library or Inbox folders.</span></span>
  - <span data-ttu-id="8516b-151">Il modulo è denominato IPM. Nota. [nome personalizzato].</span><span class="sxs-lookup"><span data-stu-id="8516b-151">Form is named IPM.Note.[custom name].</span></span>

## <a name="steps-for-finding-signs-of-this-attack-and-confirming-it"></a><span data-ttu-id="8516b-152">Passaggi per trovare i segni di questo attacco e confermarlo</span><span class="sxs-lookup"><span data-stu-id="8516b-152">Steps for finding signs of this attack and confirming it</span></span>

<span data-ttu-id="8516b-153">È possibile utilizzare uno dei metodi seguenti per confermare l'attacco:</span><span class="sxs-lookup"><span data-stu-id="8516b-153">You can use either of the following methods to confirm the attack:</span></span>

- <span data-ttu-id="8516b-154">Esaminare manualmente le regole e i moduli per ogni cassetta postale utilizzando il client Outlook.</span><span class="sxs-lookup"><span data-stu-id="8516b-154">Manually examine the rules and forms for each mailbox using the Outlook client.</span></span> <span data-ttu-id="8516b-155">Questo metodo è accurato, ma è possibile controllare solo una cassetta postale alla volta.</span><span class="sxs-lookup"><span data-stu-id="8516b-155">This method is thorough, but you can only check one mailbox at a time.</span></span> <span data-ttu-id="8516b-156">Questo metodo può richiedere molto tempo se hai molti utenti da controllare e potrebbe anche infettare il computer in uso.</span><span class="sxs-lookup"><span data-stu-id="8516b-156">This method can be very time consuming if you have many users to check, and might also infect the computer that you're using.</span></span>

- <span data-ttu-id="8516b-157">Usa lo script [Get-AllTenantRulesAndForms.ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) PowerShell per scaricare automaticamente tutte le regole di inoltro della posta e i moduli personalizzati per tutti gli utenti della tenancy.</span><span class="sxs-lookup"><span data-stu-id="8516b-157">Use the [Get-AllTenantRulesAndForms.ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) PowerShell script to automatically dump all the mail forwarding rules and custom forms for all the users in your tenancy.</span></span> <span data-ttu-id="8516b-158">Questo è il metodo più rapido e sicuro con il minor sovraccarico.</span><span class="sxs-lookup"><span data-stu-id="8516b-158">This is the fastest and safest method with the least amount of overhead.</span></span>

### <a name="confirm-the-rules-attack-using-the-outlook-client"></a><span data-ttu-id="8516b-159">Confermare l'attacco alle regole utilizzando il client Outlook</span><span class="sxs-lookup"><span data-stu-id="8516b-159">Confirm the Rules Attack Using the Outlook client</span></span>

1. <span data-ttu-id="8516b-160">Aprire il client Outlook degli utenti come utente.</span><span class="sxs-lookup"><span data-stu-id="8516b-160">Open the users Outlook client as the user.</span></span> <span data-ttu-id="8516b-161">L'utente potrebbe avere bisogno del supporto per esaminare le regole della propria cassetta postale.</span><span class="sxs-lookup"><span data-stu-id="8516b-161">The user may need your help in examining the rules on their mailbox.</span></span>

2. <span data-ttu-id="8516b-162">Per le [procedure su](https://support.microsoft.com/office/c24f5dea-9465-4df4-ad17-a50704d66c59) come aprire l'interfaccia delle regole in Outlook, vedere Gestire i messaggi di posta elettronica utilizzando le regole.</span><span class="sxs-lookup"><span data-stu-id="8516b-162">Refer to [Manage email messages by using rules](https://support.microsoft.com/office/c24f5dea-9465-4df4-ad17-a50704d66c59) article for the procedures on how to open the rules interface in Outlook.</span></span>

3. <span data-ttu-id="8516b-163">Cercare le regole che l'utente non ha creato o eventuali regole impreviste o regole con nomi sospetti.</span><span class="sxs-lookup"><span data-stu-id="8516b-163">Look for rules that the user did not create, or any unexpected rules or rules with suspicious names.</span></span>

4. <span data-ttu-id="8516b-164">Cercare nella descrizione della regola le azioni delle regole avviate e applicazioni o che fanno riferimento a un oggetto . EXE, . ZIP o per avviare un URL.</span><span class="sxs-lookup"><span data-stu-id="8516b-164">Look in the rule description for rule actions that start and application or refer to an .EXE, .ZIP file or to launching a URL.</span></span>

5. <span data-ttu-id="8516b-165">Cercare eventuali nuovi processi che iniziano a utilizzare l'ID processo di Outlook.</span><span class="sxs-lookup"><span data-stu-id="8516b-165">Look for any new processes that start using the Outlook process ID.</span></span> <span data-ttu-id="8516b-166">Fare riferimento [a Trovare l'ID processo](/windows-hardware/drivers/debugger/finding-the-process-id).</span><span class="sxs-lookup"><span data-stu-id="8516b-166">Refer to [Find the Process ID](/windows-hardware/drivers/debugger/finding-the-process-id).</span></span>

### <a name="steps-to-confirm-the-forms-attack-using-the-outlook-client"></a><span data-ttu-id="8516b-167">Passaggi per confermare l'attacco dei moduli tramite il client Outlook</span><span class="sxs-lookup"><span data-stu-id="8516b-167">Steps to confirm the Forms attack using the Outlook client</span></span>

1. <span data-ttu-id="8516b-168">Aprire il client Outlook dell'utente come utente.</span><span class="sxs-lookup"><span data-stu-id="8516b-168">Open the user Outlook client as the user.</span></span>

2. <span data-ttu-id="8516b-169">Seguire i passaggi descritti in [Show the Developer tab](https://support.microsoft.com/office/e1192344-5e56-4d45-931b-e5fd9bea2d45) for the user's version of Outlook.</span><span class="sxs-lookup"><span data-stu-id="8516b-169">Follow the steps in, [Show the Developer tab](https://support.microsoft.com/office/e1192344-5e56-4d45-931b-e5fd9bea2d45) for the user's version of Outlook.</span></span>

3. <span data-ttu-id="8516b-170">Aprire la scheda sviluppatore ora visibile in Outlook e fare clic **su Progetta un modulo.**</span><span class="sxs-lookup"><span data-stu-id="8516b-170">Open the now visible developer tab in Outlook and click **design a form**.</span></span>

4. <span data-ttu-id="8516b-171">Selezionare Posta **in** arrivo **nell'elenco Cerca in.**</span><span class="sxs-lookup"><span data-stu-id="8516b-171">Select the **Inbox** from the **Look In** list.</span></span> <span data-ttu-id="8516b-172">Cercare eventuali moduli personalizzati.</span><span class="sxs-lookup"><span data-stu-id="8516b-172">Look for any custom forms.</span></span> <span data-ttu-id="8516b-173">I moduli personalizzati sono abbastanza rari che, se si dispone di moduli personalizzati, vale la pena di avere un'occhiata più approfondita.</span><span class="sxs-lookup"><span data-stu-id="8516b-173">Custom forms are rare enough that if you have any custom forms at all, it is worth a deeper look.</span></span>

5. <span data-ttu-id="8516b-174">Analizzare eventuali moduli personalizzati, in particolare quelli contrassegnati come nascosti.</span><span class="sxs-lookup"><span data-stu-id="8516b-174">Investigate any custom forms, especially those marked as hidden.</span></span>

6. <span data-ttu-id="8516b-175">Aprire eventuali moduli personalizzati e nel gruppo **Modulo** fare clic **su Visualizza codice** per vedere cosa viene eseguito quando il modulo viene caricato.</span><span class="sxs-lookup"><span data-stu-id="8516b-175">Open any custom forms and in the **Form** group click **View Code** to see what runs when the form is loaded.</span></span>

### <a name="steps-to-confirm-the-rules-and-forms-attack-using-powershell"></a><span data-ttu-id="8516b-176">Passaggi per confermare l'attacco di regole e moduli tramite PowerShell</span><span class="sxs-lookup"><span data-stu-id="8516b-176">Steps to confirm the Rules and Forms attack using PowerShell</span></span>

<span data-ttu-id="8516b-177">Il modo più semplice per verificare un attacco a regole o moduli personalizzati è eseguire lo script [Get-AllTenantRulesAndForms.ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) PowerShell.</span><span class="sxs-lookup"><span data-stu-id="8516b-177">The simplest way to verify a rules or custom forms attack is to run the [Get-AllTenantRulesAndForms.ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) PowerShell script.</span></span> <span data-ttu-id="8516b-178">Questo script si connette a ogni cassetta postale del tenant e scarica tutte le regole e i moduli in due file CSV.</span><span class="sxs-lookup"><span data-stu-id="8516b-178">This script connects to every mailbox in your tenant and dumps all the rules and forms into two .csv files.</span></span>

#### <a name="pre-requisites"></a><span data-ttu-id="8516b-179">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="8516b-179">Pre-requisites</span></span>

<span data-ttu-id="8516b-180">Sarà necessario disporre dei diritti di amministratore globale per eseguire lo script perché lo script si connette a ogni cassetta postale nella tenancy per leggere le regole e i moduli.</span><span class="sxs-lookup"><span data-stu-id="8516b-180">You will need to have global administrator rights to run the script because the script connects to every mailbox in the tenancy to read the rules and forms.</span></span>

1. <span data-ttu-id="8516b-181">Accedi al computer da cui eseguirai lo script con diritti di amministratore locale.</span><span class="sxs-lookup"><span data-stu-id="8516b-181">Sign in to the machine that you will run the script from with local administrator rights.</span></span>

2. <span data-ttu-id="8516b-182">Scaricare o copiare Get-AllTenantRulesAndForms.ps1 script da GitHub in una cartella da cui verrà eseguito.</span><span class="sxs-lookup"><span data-stu-id="8516b-182">Download or copy the Get-AllTenantRulesAndForms.ps1 script from GitHub to a folder from which you will run it.</span></span> <span data-ttu-id="8516b-183">Lo script creerà due file contrassegnati con data in questa cartella, MailboxFormsExport-yyyy-mm-dd.csv e MailboxRulesExport-yyyy-mm-dd.csv.</span><span class="sxs-lookup"><span data-stu-id="8516b-183">The script will create two date stamped files to this folder, MailboxFormsExport-yyyy-mm-dd.csv, and MailboxRulesExport-yyyy-mm-dd.csv.</span></span>

3. <span data-ttu-id="8516b-184">Aprire un'istanza di PowerShell come amministratore e aprire la cartella in cui è stato salvato lo script.</span><span class="sxs-lookup"><span data-stu-id="8516b-184">Open a PowerShell instance as an administrator and open the folder you saved the script to.</span></span>

4. <span data-ttu-id="8516b-185">Eseguire questa riga di comando di PowerShell come `.\Get-AllTenantRulesAndForms.ps1`.\Get-AllTenantRulesAndForms.ps1</span><span class="sxs-lookup"><span data-stu-id="8516b-185">Run this PowerShell command line as follows `.\Get-AllTenantRulesAndForms.ps1`.\Get-AllTenantRulesAndForms.ps1</span></span>

#### <a name="interpreting-the-output"></a><span data-ttu-id="8516b-186">Interpretazione dell'output</span><span class="sxs-lookup"><span data-stu-id="8516b-186">Interpreting the output</span></span>

- <span data-ttu-id="8516b-187">**MailboxRulesExport-*aaaa-mm-dd*.csv**: esaminare le regole (una per riga) per le condizioni di azione che includono applicazioni o eseguibili:</span><span class="sxs-lookup"><span data-stu-id="8516b-187">**MailboxRulesExport-*yyyy-mm-dd*.csv**: Examine the rules (one per row) for action conditions that include applications or executables:</span></span>

  - <span data-ttu-id="8516b-188">**ActionType (colonna A):** se viene visualizzato il valore "ID_ACTION_CUSTOM", è probabile che la regola sia dannosa.</span><span class="sxs-lookup"><span data-stu-id="8516b-188">**ActionType (column A)**: If you see the value "ID_ACTION_CUSTOM", the rule is likely malicious.</span></span>

  - <span data-ttu-id="8516b-189">**IsPotentiallyMalicious (colonna D):** se questo valore è "TRUE", è probabile che la regola sia dannosa.</span><span class="sxs-lookup"><span data-stu-id="8516b-189">**IsPotentiallyMalicious (column D)**: If this value is "TRUE", the rule is likely malicious.</span></span>

  - <span data-ttu-id="8516b-190">**ActionCommand (colonna G):** se questa colonna elenca un'applicazione o un file con estensioni exe o zip o una voce sconosciuta che fa riferimento a un URL, è probabile che la regola sia dannosa.</span><span class="sxs-lookup"><span data-stu-id="8516b-190">**ActionCommand (column G)**: If this column lists an application or any file with .exe or .zip extensions, or an unknown entry that refers to a URL, the rule is likely malicious.</span></span>

- <span data-ttu-id="8516b-191">**MailboxFormsExport-*yyyy-mm-dd*.csv**: in generale, l'utilizzo di moduli personalizzati è raro.</span><span class="sxs-lookup"><span data-stu-id="8516b-191">**MailboxFormsExport-*yyyy-mm-dd*.csv**: In general, the use of custom forms is rare.</span></span> <span data-ttu-id="8516b-192">Se nella cartella di lavoro è presente una cartella di lavoro, aprire la cassetta postale dell'utente ed esaminare il modulo stesso.</span><span class="sxs-lookup"><span data-stu-id="8516b-192">If you find any in this workbook, you open that user's mailbox and examine the form itself.</span></span> <span data-ttu-id="8516b-193">Se l'organizzazione non l'ha inserita intenzionalmente, è probabile che sia dannosa.</span><span class="sxs-lookup"><span data-stu-id="8516b-193">If your organization did not put it there intentionally, it is likely malicious.</span></span>

## <a name="how-to-stop-and-remediate-the-outlook-rules-and-forms-attack"></a><span data-ttu-id="8516b-194">Come arrestare e correggere l'attacco di regole e moduli di Outlook</span><span class="sxs-lookup"><span data-stu-id="8516b-194">How to stop and remediate the Outlook Rules and Forms attack</span></span>

<span data-ttu-id="8516b-195">Se si trova una prova di uno di questi attacchi, la correzione è semplice, basta eliminare la regola o il modulo dalla cassetta postale.</span><span class="sxs-lookup"><span data-stu-id="8516b-195">If you find any evidence of either of these attacks, remediation is simple, just delete the rule or form from the mailbox.</span></span> <span data-ttu-id="8516b-196">A tale scopo, è possibile utilizzare il client Outlook o PowerShell remoto per rimuovere le regole.</span><span class="sxs-lookup"><span data-stu-id="8516b-196">You can do this with the Outlook client or using remote PowerShell to remove rules.</span></span>

### <a name="using-outlook"></a><span data-ttu-id="8516b-197">Utilizzo di Outlook</span><span class="sxs-lookup"><span data-stu-id="8516b-197">Using Outlook</span></span>

1. <span data-ttu-id="8516b-198">Identificare tutti i dispositivi utilizzati dall'utente con Outlook.</span><span class="sxs-lookup"><span data-stu-id="8516b-198">Identify all the devices that the user has used with Outlook.</span></span> <span data-ttu-id="8516b-199">Tutti dovranno essere puliti da potenziali malware.</span><span class="sxs-lookup"><span data-stu-id="8516b-199">They will all need to be cleaned of potential malware.</span></span> <span data-ttu-id="8516b-200">Non consentire all'utente di accedere e usare la posta elettronica finché non vengono puliti tutti i dispositivi.</span><span class="sxs-lookup"><span data-stu-id="8516b-200">Do not allow the user to sign on and use email until all the devices are cleaned.</span></span>

2. <span data-ttu-id="8516b-201">Segui i passaggi descritti in [Eliminare una regola](https://support.microsoft.com/office/2f0e7139-f696-4422-8498-44846db9067f) per ogni dispositivo.</span><span class="sxs-lookup"><span data-stu-id="8516b-201">Follow the steps in [Delete a rule](https://support.microsoft.com/office/2f0e7139-f696-4422-8498-44846db9067f) for each device.</span></span>

3. <span data-ttu-id="8516b-202">Se non sei sicuro della presenza di altro malware, puoi formattare e reinstallare tutto il software nel dispositivo.</span><span class="sxs-lookup"><span data-stu-id="8516b-202">If you are unsure about the presence of other malware, you can format and reinstall all the software on the device.</span></span> <span data-ttu-id="8516b-203">Per i dispositivi mobili, puoi seguire la procedura dei produttori per reimpostare il dispositivo sull'immagine di fabbrica.</span><span class="sxs-lookup"><span data-stu-id="8516b-203">For mobile devices, you can follow the manufacturers steps to reset the device to the factory image.</span></span>

4. <span data-ttu-id="8516b-204">Installare le versioni più aggiornate di Outlook.</span><span class="sxs-lookup"><span data-stu-id="8516b-204">Install the most up-to-date versions of Outlook.</span></span> <span data-ttu-id="8516b-205">Tenere presente che la versione corrente di Outlook blocca entrambi i tipi di attacco per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="8516b-205">Remember that the current version of Outlook blocks both types of this attack by default.</span></span>

5. <span data-ttu-id="8516b-206">Dopo aver rimosso tutte le copie offline della cassetta postale, reimpostare la password dell'utente (usarne una di alta qualità) e seguire i passaggi descritti in [Configurare](../../admin/security-and-compliance/set-up-multi-factor-authentication.md) l'autenticazione a più fattori per gli utenti se la MFA non è già stata abilitata.</span><span class="sxs-lookup"><span data-stu-id="8516b-206">Once all offline copies of the mailbox have been removed, reset the user's password (use a high quality one) and follow the steps in [Setup multi-factor authentication for users](../../admin/security-and-compliance/set-up-multi-factor-authentication.md) if MFA has not already been enabled.</span></span> <span data-ttu-id="8516b-207">In questo modo si garantisce che le credenziali dell'utente non siano esposte con altri mezzi (ad esempio phishing o ri-uso della password).</span><span class="sxs-lookup"><span data-stu-id="8516b-207">This ensures that the user's credentials are not exposed via other means (such as phishing or password re-use).</span></span>

### <a name="using-powershell"></a><span data-ttu-id="8516b-208">Utilizzo di PowerShell</span><span class="sxs-lookup"><span data-stu-id="8516b-208">Using PowerShell</span></span>

<span data-ttu-id="8516b-209">Esistono due cmdlet di PowerShell remoti che è possibile utilizzare per rimuovere o disabilitare le regole pericolose.</span><span class="sxs-lookup"><span data-stu-id="8516b-209">There are two remote PowerShell cmdlets you can use to remove or disable dangerous rules.</span></span> <span data-ttu-id="8516b-210">Basta seguire i passaggi.</span><span class="sxs-lookup"><span data-stu-id="8516b-210">Just follow the steps.</span></span>

#### <a name="steps-for-mailboxes-that-are-on-an-exchange-server"></a><span data-ttu-id="8516b-211">Passaggi per le cassette postali presenti in un server Exchange</span><span class="sxs-lookup"><span data-stu-id="8516b-211">Steps for mailboxes that are on an Exchange server</span></span>

1. <span data-ttu-id="8516b-212">Connettersi al server Exchange tramite PowerShell remoto.</span><span class="sxs-lookup"><span data-stu-id="8516b-212">Connect to the Exchange server using remote PowerShell.</span></span> <span data-ttu-id="8516b-213">Seguire i passaggi descritti in [Connect to Exchange servers using remote PowerShell](/powershell/exchange/connect-to-exchange-servers-using-remote-powershell).</span><span class="sxs-lookup"><span data-stu-id="8516b-213">Follow the steps in [Connect to Exchange servers using remote PowerShell](/powershell/exchange/connect-to-exchange-servers-using-remote-powershell).</span></span>

2. <span data-ttu-id="8516b-214">Se si desidera rimuovere completamente una singola regola, più regole o tutte le regole da una cassetta postale, utilizzare il cmdlet [Remove-InboxRule.](/powershell/module/exchange/Remove-InboxRule)</span><span class="sxs-lookup"><span data-stu-id="8516b-214">If you want to completely remove a single rule, multiple rules, or all rules from a mailbox use the [Remove-InboxRule](/powershell/module/exchange/Remove-InboxRule) cmdlet.</span></span>

3. <span data-ttu-id="8516b-215">Se si desidera conservare la regola e il relativo contenuto per ulteriori indagini, utilizzare il cmdlet [Disable-InboxRule.](/powershell/module/exchange/disable-inboxrule)</span><span class="sxs-lookup"><span data-stu-id="8516b-215">If you want to retain the rule and its contents for further investigation use the [Disable-InboxRule](/powershell/module/exchange/disable-inboxrule) cmdlet.</span></span>

#### <a name="steps-for-mailboxes-in-exchange-online"></a><span data-ttu-id="8516b-216">Passaggi per le cassette postali in Exchange Online</span><span class="sxs-lookup"><span data-stu-id="8516b-216">Steps for mailboxes in Exchange Online</span></span>

1. <span data-ttu-id="8516b-217">Seguire i passaggi descritti in [Connect to Exchange Online using PowerShell](/powershell/exchange/connect-to-exchange-online-powershell).</span><span class="sxs-lookup"><span data-stu-id="8516b-217">Follow the steps in [Connect to Exchange Online using PowerShell](/powershell/exchange/connect-to-exchange-online-powershell).</span></span>

2. <span data-ttu-id="8516b-218">Se si desidera rimuovere completamente una singola regola, più regole o tutte le regole da una cassetta postale, utilizzare il cmdlet [Remove-Inbox Rule.](/powershell/module/exchange/Remove-InboxRule)</span><span class="sxs-lookup"><span data-stu-id="8516b-218">If you want to completely remove a single rule, multiple rules, or all rules from a mailbox use the [Remove-Inbox Rule](/powershell/module/exchange/Remove-InboxRule) cmdlet.</span></span>

3. <span data-ttu-id="8516b-219">Se si desidera conservare la regola e il relativo contenuto per ulteriori indagini, utilizzare il cmdlet [Disable-InboxRule.](/powershell/module/exchange/disable-inboxrule)</span><span class="sxs-lookup"><span data-stu-id="8516b-219">If you want to retain the rule and its contents for further investigation use the [Disable-InboxRule](/powershell/module/exchange/disable-inboxrule) cmdlet.</span></span>

## <a name="how-to-minimize-future-attacks"></a><span data-ttu-id="8516b-220">Come ridurre al minimo gli attacchi futuri</span><span class="sxs-lookup"><span data-stu-id="8516b-220">How to minimize future attacks</span></span>

### <a name="first-protect-your-accounts"></a><span data-ttu-id="8516b-221">Primo: proteggere gli account</span><span class="sxs-lookup"><span data-stu-id="8516b-221">First: protect your accounts</span></span>

<span data-ttu-id="8516b-222">Gli exploit Regole e moduli vengono utilizzati da un utente malintenzionato solo dopo aver rubato o violato uno degli account dell'utente.</span><span class="sxs-lookup"><span data-stu-id="8516b-222">The Rules and Forms exploits are only used by an attacker after they have stolen or breached one of your user's accounts.</span></span> <span data-ttu-id="8516b-223">Pertanto, il primo passaggio per impedire l'utilizzo di questi exploit contro l'organizzazione consiste nel proteggere in modo aggressivo gli account utente.</span><span class="sxs-lookup"><span data-stu-id="8516b-223">So, your first step to preventing the use of these exploits against your organization is to aggressively protect your user accounts.</span></span> <span data-ttu-id="8516b-224">Alcuni dei modi più comuni in cui vengono violati gli account sono gli attacchi di phishing o [di spray con password.](https://www.microsoft.com/security/blog/2020/04/23/protecting-organization-password-spray-attacks/)</span><span class="sxs-lookup"><span data-stu-id="8516b-224">Some of the most common ways that accounts are breached are through phishing or [password spray attacks](https://www.microsoft.com/security/blog/2020/04/23/protecting-organization-password-spray-attacks/).</span></span>

<span data-ttu-id="8516b-225">Il modo migliore per proteggere gli account utente e in particolare gli account amministratore è configurare l'autenticazione a più fattori [per gli utenti.](../../admin/security-and-compliance/set-up-multi-factor-authentication.md)</span><span class="sxs-lookup"><span data-stu-id="8516b-225">The best way to protect your user accounts, and especially your administrator accounts, is to [set up multi-factor authentication for users](../../admin/security-and-compliance/set-up-multi-factor-authentication.md).</span></span> <span data-ttu-id="8516b-226">È inoltre consigliabile:</span><span class="sxs-lookup"><span data-stu-id="8516b-226">You should also:</span></span>

- <span data-ttu-id="8516b-227">Monitorare la modalità di accesso e utilizzo [degli account utente.](/azure/active-directory/active-directory-view-access-usage-reports)</span><span class="sxs-lookup"><span data-stu-id="8516b-227">Monitor how your user accounts are [accessed and used](/azure/active-directory/active-directory-view-access-usage-reports).</span></span> <span data-ttu-id="8516b-228">Non puoi impedire la violazione iniziale, ma ridurrai la durata e l'impatto della violazione rilevandola prima.</span><span class="sxs-lookup"><span data-stu-id="8516b-228">You may not prevent the initial breach, but you will shorten the duration and the impact of the breach by detecting it sooner.</span></span> <span data-ttu-id="8516b-229">È possibile usare questi criteri [di Office 365 Cloud App Security](/cloud-app-security/what-is-cloud-app-security) per monitorare gli account e avvisare le attività insolite:</span><span class="sxs-lookup"><span data-stu-id="8516b-229">You can use these [Office 365 Cloud App Security policies](/cloud-app-security/what-is-cloud-app-security) to monitor you accounts and alert on unusual activity:</span></span>

  - <span data-ttu-id="8516b-230">**Più tentativi** di accesso non riusciti: questo criterio profili l'ambiente e attiva avvisi quando gli utenti eseguono più attività di accesso non riuscite in una singola sessione rispetto alla linea di base appresa, che potrebbe indicare un tentativo di violazione.</span><span class="sxs-lookup"><span data-stu-id="8516b-230">**Multiple failed login attempts**: This policy profiles your environment and triggers alerts when users perform multiple failed login activities in a single session with respect to the learned baseline, which could indicate an attempted breach.</span></span>

  - <span data-ttu-id="8516b-231">**Viaggi impossibili:** questo criterio consente di profilire l'ambiente e di attivare avvisi quando vengono rilevate attività dallo stesso utente in posizioni diverse in un periodo di tempo inferiore al tempo di viaggio previsto tra le due posizioni.</span><span class="sxs-lookup"><span data-stu-id="8516b-231">**Impossible travel**: This policy profiles your environment and triggers alerts when activities are detected from the same user in different locations within a time period that is shorter than the expected travel time between the two locations.</span></span> <span data-ttu-id="8516b-232">Ciò potrebbe indicare che un utente diverso usa le stesse credenziali.</span><span class="sxs-lookup"><span data-stu-id="8516b-232">This could indicate that a different user is using the same credentials.</span></span> <span data-ttu-id="8516b-233">Il rilevamento di questo comportamento anomalo richiede un periodo di apprendimento iniziale di sette giorni durante il quale apprende il modello di attività di un nuovo utente.</span><span class="sxs-lookup"><span data-stu-id="8516b-233">Detecting this anomalous behavior necessitates an initial learning period of seven days during which it learns a new user's activity pattern.</span></span>

  - <span data-ttu-id="8516b-234">Attività impersonata insolita **(dall'utente):** questo criterio profili l'ambiente e attiva avvisi quando gli utenti eseguono più attività rappresentate in una singola sessione rispetto alla linea di base appresa, che potrebbe indicare un tentativo di violazione.</span><span class="sxs-lookup"><span data-stu-id="8516b-234">**Unusual impersonated activity (by user)**: This policy profiles your environment and triggers alerts when users perform multiple impersonated activities in a single session with respect to the baseline learned, which could indicate an attempted breach.</span></span>

- <span data-ttu-id="8516b-235">Usare uno strumento come [Punteggio sicuro di Office 365](https://securescore.office.com/) per gestire le configurazioni e i comportamenti di sicurezza degli account.</span><span class="sxs-lookup"><span data-stu-id="8516b-235">Use a tool like [Office 365 Secure Score](https://securescore.office.com/) to manage account security configurations and behaviors.</span></span>

### <a name="second-keep-your-outlook-clients-current"></a><span data-ttu-id="8516b-236">Secondo: Mantenere i client Outlook correnti</span><span class="sxs-lookup"><span data-stu-id="8516b-236">Second: Keep your Outlook clients current</span></span>

<span data-ttu-id="8516b-237">Le versioni completamente aggiornate e con patch di Outlook 2013 e 2016 disabilitano l'azione regola/modulo "Avvia applicazione" per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="8516b-237">Fully updated and patched versions of Outlook 2013, and 2016 disable the "Start Application" rule/form action by default.</span></span> <span data-ttu-id="8516b-238">In questo modo, anche se un utente malintenzionato viola l'account, le azioni della regola e del modulo verranno bloccate.</span><span class="sxs-lookup"><span data-stu-id="8516b-238">This will ensure that even if an attacker breaches the account, the rule and form actions will be blocked.</span></span> <span data-ttu-id="8516b-239">È possibile installare gli aggiornamenti e le patch di sicurezza più recenti seguendo la procedura descritta in [Installare gli aggiornamenti di Office.](https://support.microsoft.com/office/2ab296f3-7f03-43a2-8e50-46de917611c5)</span><span class="sxs-lookup"><span data-stu-id="8516b-239">You can install the latest updates and security patches by following the steps in [Install Office updates](https://support.microsoft.com/office/2ab296f3-7f03-43a2-8e50-46de917611c5).</span></span>

<span data-ttu-id="8516b-240">Ecco le versioni della patch per i client Outlook 2013 e 2016:</span><span class="sxs-lookup"><span data-stu-id="8516b-240">Here are the patch versions for your Outlook 2013 and 2016 clients:</span></span>

- <span data-ttu-id="8516b-241">**Outlook 2016**: 16.0.4534.1001 o versione successiva.</span><span class="sxs-lookup"><span data-stu-id="8516b-241">**Outlook 2016**: 16.0.4534.1001 or greater.</span></span>

- <span data-ttu-id="8516b-242">**Outlook 2013**: 15.0.4937.1000 o versione successiva.</span><span class="sxs-lookup"><span data-stu-id="8516b-242">**Outlook 2013**: 15.0.4937.1000 or greater.</span></span>

<span data-ttu-id="8516b-243">Per ulteriori informazioni sulle singole patch di sicurezza, vedere:</span><span class="sxs-lookup"><span data-stu-id="8516b-243">For more information on the individual security patches, see:</span></span>

- [<span data-ttu-id="8516b-244">Patch di sicurezza per Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="8516b-244">Outlook 2016 Security Patch</span></span>](https://support.microsoft.com/help/3191883)

- [<span data-ttu-id="8516b-245">Patch di sicurezza per Outlook 2013</span><span class="sxs-lookup"><span data-stu-id="8516b-245">Outlook 2013 Security Patch</span></span>](https://support.microsoft.com/help/3191938)

### <a name="third-monitor-your-outlook-clients"></a><span data-ttu-id="8516b-246">Terzo: monitorare i client outlook</span><span class="sxs-lookup"><span data-stu-id="8516b-246">Third: Monitor your Outlook clients</span></span>

<span data-ttu-id="8516b-247">Si noti che, anche con le patch e gli aggiornamenti installati, è possibile che un utente malintenzionato modii la configurazione del computer locale per abilitare nuovamente il comportamento "Avvia applicazione".</span><span class="sxs-lookup"><span data-stu-id="8516b-247">Note that even with the patches and updates installed, it is possible for an attacker to change the local machine configuration to re-enable the "Start Application" behavior.</span></span> <span data-ttu-id="8516b-248">È possibile utilizzare [Gestione avanzata Criteri di gruppo](/microsoft-desktop-optimization-pack/agpm/) per monitorare e applicare i criteri del computer locale ai client.</span><span class="sxs-lookup"><span data-stu-id="8516b-248">You can use [Advanced Group Policy Management](/microsoft-desktop-optimization-pack/agpm/) to monitor and enforce local machine policies on your clients.</span></span>

<span data-ttu-id="8516b-249">Puoi vedere se "Avvia applicazione" è stato ri-abilitato tramite una sostituzione nel Registro di sistema usando le informazioni in [How to view the system registry by using 64-bit versions of Windows](https://support.microsoft.com/help/305097).</span><span class="sxs-lookup"><span data-stu-id="8516b-249">You can see if "Start Application" has been re-enabled through an override in the registry by using the information in [How to view the system registry by using 64-bit versions of Windows](https://support.microsoft.com/help/305097).</span></span> <span data-ttu-id="8516b-250">Controllare queste sottochiavi:</span><span class="sxs-lookup"><span data-stu-id="8516b-250">Check these subkeys:</span></span>

- <span data-ttu-id="8516b-251">**Outlook 2016**: `HKEY_CURRENT_USER\Software\Microsoft\Office\16.0\Outlook\Security\`</span><span class="sxs-lookup"><span data-stu-id="8516b-251">**Outlook 2016**: `HKEY_CURRENT_USER\Software\Microsoft\Office\16.0\Outlook\Security\`</span></span>

- <span data-ttu-id="8516b-252">**Outlook 2013**: `HKEY_CURRENT_USER\Software\Microsoft\Office\15.0\Outlook\Security\`</span><span class="sxs-lookup"><span data-stu-id="8516b-252">**Outlook 2013**: `HKEY_CURRENT_USER\Software\Microsoft\Office\15.0\Outlook\Security\`</span></span>

<span data-ttu-id="8516b-253">Cercare la chiave EnableUnsafeClientMailRules.</span><span class="sxs-lookup"><span data-stu-id="8516b-253">Look for the key EnableUnsafeClientMailRules.</span></span> <span data-ttu-id="8516b-254">Se è presente ed è impostato su 1, la patch di sicurezza di Outlook è stata ignorata e il computer è vulnerabile all'attacco Modulo/Regole.</span><span class="sxs-lookup"><span data-stu-id="8516b-254">If it is there and is set to 1, the Outlook security patch has been overridden and the computer is vulnerable to the Form/Rules attack.</span></span> <span data-ttu-id="8516b-255">Se il valore è 0, l'azione "Avvia applicazione" è disabilitata.</span><span class="sxs-lookup"><span data-stu-id="8516b-255">If the value is 0, the "Start Application" action is disabled.</span></span> <span data-ttu-id="8516b-256">Se è installata la versione aggiornata e con patch di Outlook e questa chiave del Registro di sistema non è presente, un sistema non è vulnerabile a questi attacchi.</span><span class="sxs-lookup"><span data-stu-id="8516b-256">If the updated and patched version of Outlook is installed and this registry key is not present, then a system is not vulnerable to these attacks.</span></span>

<span data-ttu-id="8516b-257">I clienti con installazioni di Exchange locali devono prendere in considerazione la possibilità di bloccare le versioni precedenti di Outlook in cui non sono disponibili patch.</span><span class="sxs-lookup"><span data-stu-id="8516b-257">Customers with on-premises Exchange installations should consider blocking older versions of Outlook that do not have patches available.</span></span> <span data-ttu-id="8516b-258">Per informazioni dettagliate su questo processo, vedere l'articolo [Configure Outlook client blocking](/exchange/configure-outlook-client-blocking-exchange-2013-help).</span><span class="sxs-lookup"><span data-stu-id="8516b-258">Details on this process can be found in the article [Configure Outlook client blocking](/exchange/configure-outlook-client-blocking-exchange-2013-help).</span></span>

## <a name="secure-microsoft-365-like-a-cybersecurity-pro"></a><span data-ttu-id="8516b-259">Proteggere Microsoft 365 come un professionista della sicurezza informatica</span><span class="sxs-lookup"><span data-stu-id="8516b-259">Secure Microsoft 365 like a cybersecurity pro</span></span>

<span data-ttu-id="8516b-260">L'abbonamento a Microsoft 365 include un potente set di funzionalità di protezione che consente di proteggere i propri dati e quelli degli altri utenti.</span><span class="sxs-lookup"><span data-stu-id="8516b-260">Your Microsoft 365 subscription comes with a powerful set of security capabilities that you can use to protect your data and your users.</span></span> <span data-ttu-id="8516b-261">Usare la [Roadmap della sicurezza di Microsoft 365: principali priorità per i primi 30 giorni, 90 giorni e oltre](security-roadmap.md) per implementare le procedure consigliate da Microsoft per proteggere il tenant di Microsoft 365.</span><span class="sxs-lookup"><span data-stu-id="8516b-261">Use the [Microsoft 365 security roadmap - Top priorities for the first 30 days, 90 days, and beyond](security-roadmap.md) to implement Microsoft recommended best practices for securing your Microsoft 365 tenant.</span></span>

- <span data-ttu-id="8516b-262">Attività da eseguire i primi 30 giorni.</span><span class="sxs-lookup"><span data-stu-id="8516b-262">Tasks to accomplish in the first 30 days.</span></span> <span data-ttu-id="8516b-263">Questi hanno un effetto immediato e hanno un impatto basso per gli utenti.</span><span class="sxs-lookup"><span data-stu-id="8516b-263">These have immediate effect and are low-impact to your users.</span></span>

- <span data-ttu-id="8516b-264">Attività da completare in 90 giorni.</span><span class="sxs-lookup"><span data-stu-id="8516b-264">Tasks to accomplish in 90 days.</span></span> <span data-ttu-id="8516b-265">Queste attività richiedono una quantità di tempo leggermente superiore per la pianificazione e l'implementazione, ma aumentano notevolmente il livello di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="8516b-265">These take a bit more time to plan and implement but greatly improve your security posture.</span></span>

- <span data-ttu-id="8516b-266">Dopo 90 giorni.</span><span class="sxs-lookup"><span data-stu-id="8516b-266">Beyond 90 days.</span></span> <span data-ttu-id="8516b-267">Questi miglioramenti si instaurano nei primi 90 giorni di lavoro effettuato.</span><span class="sxs-lookup"><span data-stu-id="8516b-267">These enhancements build in your first 90 days work.</span></span>

## <a name="see-also"></a><span data-ttu-id="8516b-268">Vedere anche:</span><span class="sxs-lookup"><span data-stu-id="8516b-268">See also:</span></span>

- <span data-ttu-id="8516b-269">[Malicious Outlook Rules](https://silentbreaksecurity.com/malicious-outlook-rules/) by SilentBreak Security Post about Rules Vector fornisce una revisione dettagliata del modo in cui le regole di Outlook.</span><span class="sxs-lookup"><span data-stu-id="8516b-269">[Malicious Outlook Rules](https://silentbreaksecurity.com/malicious-outlook-rules/) by SilentBreak Security Post about Rules Vector provides a detailed review of how the Outlook Rules.</span></span>

- <span data-ttu-id="8516b-270">[MAPI su HTTP e Mailrule Pwnage](https://sensepost.com/blog/2016/mapi-over-http-and-mailrule-pwnage/) nel blog Sensepost su Mailrule Pwnage illustra uno strumento denominato Ruler che consente di sfruttare le cassette postali tramite le regole di Outlook.</span><span class="sxs-lookup"><span data-stu-id="8516b-270">[MAPI over HTTP and Mailrule Pwnage](https://sensepost.com/blog/2016/mapi-over-http-and-mailrule-pwnage/) on the Sensepost blog about Mailrule Pwnage discusses a tool called Ruler that lets you exploit mailboxes through Outlook rules.</span></span>

- <span data-ttu-id="8516b-271">[Moduli e shell di Outlook nel](https://sensepost.com/blog/2017/outlook-forms-and-shells/) blog sensepost su Forms Threat Vector.</span><span class="sxs-lookup"><span data-stu-id="8516b-271">[Outlook forms and shells](https://sensepost.com/blog/2017/outlook-forms-and-shells/) on the Sensepost blog about Forms Threat Vector.</span></span>

- [<span data-ttu-id="8516b-272">Codebase righello</span><span class="sxs-lookup"><span data-stu-id="8516b-272">Ruler Codebase</span></span>](https://github.com/sensepost/ruler)

- [<span data-ttu-id="8516b-273">Indicatori di compromissione dei righelli</span><span class="sxs-lookup"><span data-stu-id="8516b-273">Ruler Indicators of Compromise</span></span>](https://github.com/sensepost/notruler/blob/master/iocs.md)