---
title: Rilevare e correggere gli attacchi di inserimento di regole e moduli personalizzati di Outlook.
f1.keywords:
- NOCSH
ms.author: tracyp
author: MSFTTracyp
manager: dansimp
ms.date: 04/23/2018
audience: ITPro
ms.topic: article
ms.collection:
- o365_security_incident_response
- M365-security-compliance
localization_priority: Normal
search.appverid:
- MET150
description: Informazioni su come riconoscere e correggere gli attacchi iniezioni di regole e moduli personalizzati di Outlook in Office 365
ms.custom: seo-marvel-apr2020
ms.technology: mdo
ms.prod: m365-security
ms.openlocfilehash: e22cfa97ae59fdd094c161cdaeff899dc1dd6507
ms.sourcegitcommit: 786f90a163d34c02b8451d09aa1efb1e1d5f543c
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 02/18/2021
ms.locfileid: "50286394"
---
# <a name="detect-and-remediate-outlook-rules-and-custom-forms-injections-attacks"></a><span data-ttu-id="17302-103">Rilevare e correggere gli attacchi iniezioni di regole e moduli personalizzati di Outlook</span><span class="sxs-lookup"><span data-stu-id="17302-103">Detect and Remediate Outlook Rules and Custom Forms Injections Attacks</span></span>

[!INCLUDE [Microsoft 365 Defender rebranding](../includes/microsoft-defender-for-office.md)]


<span data-ttu-id="17302-104">**Riepilogo** Informazioni su come riconoscere e correggere gli attacchi iniezioni di inserimenti di moduli personalizzati e regole di Outlook in Office 365.</span><span class="sxs-lookup"><span data-stu-id="17302-104">**Summary** Learn how to recognize and remediate the Outlook rules and custom Forms injections attacks in Office 365.</span></span>

## <a name="what-is-the-outlook-rules-and-custom-forms-injection-attack"></a><span data-ttu-id="17302-105">Che cos'è l'attacco di inserimento di regole e moduli personalizzati di Outlook?</span><span class="sxs-lookup"><span data-stu-id="17302-105">What is the Outlook Rules and Custom Forms injection attack?</span></span>

<span data-ttu-id="17302-106">Dopo che un utente malintenzionato ha violato un account nella tenancy e si è insediato, ci sarà il tentativo di stabilire un modo per rimanere o un modo per rientrare dopo che sono stati individuati e rimossi.</span><span class="sxs-lookup"><span data-stu-id="17302-106">After an attacker has breached an account in your tenancy and gets in, they're are going to try and establish a way to stay in or a way to get back in after they are discovered and removed.</span></span> <span data-ttu-id="17302-107">Questa operazione viene definita creazione di un meccanismo di persistenza.</span><span class="sxs-lookup"><span data-stu-id="17302-107">This is called establishing a persistence mechanism.</span></span> <span data-ttu-id="17302-108">A tale scopo, è possibile utilizzare le regole di Outlook o inserire moduli personalizzati in Outlook.</span><span class="sxs-lookup"><span data-stu-id="17302-108">Two ways that they can do this are by exploiting Outlook rules or by injecting custom forms into Outlook.</span></span>
<span data-ttu-id="17302-109">In entrambi i casi, la regola o il modulo viene sincronizzato dal servizio cloud fino al client desktop, in modo che un formato completo e la nuova installazione del software client non eliminino il meccanismo di inserimento.</span><span class="sxs-lookup"><span data-stu-id="17302-109">In both cases, the rule or form is synced from the cloud service down to the desktop client, so a full format and re-install of the client software doesn't eliminate the injection mechanism.</span></span> <span data-ttu-id="17302-110">Questo perché quando il software client Outlook si riconnette alla cassetta postale nel cloud, scarica nuovamente le regole e i moduli dal cloud.</span><span class="sxs-lookup"><span data-stu-id="17302-110">This is because when the Outlook client software reconnects to the mailbox in the cloud it will re-download the rules and forms from the cloud.</span></span> <span data-ttu-id="17302-111">Una volta che le regole e i moduli sono stati installati, l'utente malintenzionato le usa per eseguire codice remoto o personalizzato, in genere per installare malware nel computer locale.</span><span class="sxs-lookup"><span data-stu-id="17302-111">Once the rules and forms are in place, the attacker uses them to execute remote or custom code, usually to install malware on the local machine.</span></span> <span data-ttu-id="17302-112">Il malware quindi ruba nuovamente le credenziali o esegue altre attività illecite.</span><span class="sxs-lookup"><span data-stu-id="17302-112">The malware then re-steals credentials or performs other illicit activity.</span></span>
<span data-ttu-id="17302-113">La buona notizia è che se si mantiene i client patch alla versione più recente, non si è vulnerabili alla minaccia in quanto le impostazioni predefinite del client Outlook bloccano entrambi i meccanismi.</span><span class="sxs-lookup"><span data-stu-id="17302-113">The good news here is that if you keep your clients patched to the latest version, you are not vulnerable to the threat as current Outlook client defaults block both mechanisms.</span></span>

<span data-ttu-id="17302-114">Gli attacchi in genere seguono questi modelli:</span><span class="sxs-lookup"><span data-stu-id="17302-114">The attacks typically follow these patterns:</span></span>

<span data-ttu-id="17302-115">**L'exploit delle regole:**</span><span class="sxs-lookup"><span data-stu-id="17302-115">**The Rules Exploit**:</span></span>

1. <span data-ttu-id="17302-116">L'autore dell'attacco ruba il nome utente e la password di uno degli utenti.</span><span class="sxs-lookup"><span data-stu-id="17302-116">The attacker steals the username and password of one of your users.</span></span>

2. <span data-ttu-id="17302-117">L'utente malintenzionato accede quindi alla cassetta postale di Exchange degli utenti.</span><span class="sxs-lookup"><span data-stu-id="17302-117">The attacker then signs in to that users Exchange mailbox.</span></span> <span data-ttu-id="17302-118">La cassetta postale può essere in Exchange online o in Exchange locale.</span><span class="sxs-lookup"><span data-stu-id="17302-118">The mailbox can either be in Exchange online or in Exchange on-premises.</span></span>

3. <span data-ttu-id="17302-119">L'autore dell'attacco crea quindi una regola di inoltro nella cassetta postale che viene attivata quando la cassetta postale riceve un messaggio di posta elettronica che corrisponde ai criteri della regola.</span><span class="sxs-lookup"><span data-stu-id="17302-119">The attacker then creates a forwarding rule in the mailbox that is triggered when the mailbox receives an email that matches the criteria of the rule.</span></span> <span data-ttu-id="17302-120">I criteri della regola e il contenuto del messaggio di posta elettronica trigger sono personalizzati l'uno per l'altro.</span><span class="sxs-lookup"><span data-stu-id="17302-120">The criteria of rule and the contents of the trigger email are tailor-made for each other.</span></span>

4. <span data-ttu-id="17302-121">L'utente malintenzionato invia il messaggio di posta elettronica trigger all'utente che utilizza normalmente la propria cassetta postale.</span><span class="sxs-lookup"><span data-stu-id="17302-121">The attacker sends the trigger email to the user who is using their mailbox normally.</span></span>

5. <span data-ttu-id="17302-122">Quando il messaggio di posta elettronica viene ricevuto, la regola viene attivata.</span><span class="sxs-lookup"><span data-stu-id="17302-122">When the email is received, the rule is triggered.</span></span> <span data-ttu-id="17302-123">L'azione della regola è in genere l'avvio di un'applicazione in un server remoto (WebDAV).</span><span class="sxs-lookup"><span data-stu-id="17302-123">The action of the rule is usually to launch an application on a remote (WebDAV) server.</span></span>

6. <span data-ttu-id="17302-124">L'applicazione installa in genere malware, ad esempio [Powershell,](https://www.powershellempire.com/)localmente nel computer dell'utente.</span><span class="sxs-lookup"><span data-stu-id="17302-124">The application typically installs malware, such as [Powershell Empire](https://www.powershellempire.com/), locally on the user's machine.</span></span>

7. <span data-ttu-id="17302-125">Il malware consente all'utente malintenzionato di rubare nuovamente il nome utente e la password o altre credenziali dal computer locale ed eseguire altre attività dannose.</span><span class="sxs-lookup"><span data-stu-id="17302-125">The malware allows the attacker to re-steal the user's username and password or other credentials from local machine and perform other malicious activities.</span></span>

<span data-ttu-id="17302-126">**L'exploit dei moduli:**</span><span class="sxs-lookup"><span data-stu-id="17302-126">**The Forms Exploit**:</span></span>

1. <span data-ttu-id="17302-127">L'autore dell'attacco ruba il nome utente e la password di uno degli utenti.</span><span class="sxs-lookup"><span data-stu-id="17302-127">The attacker steals the username and password of one of your users.</span></span>

2. <span data-ttu-id="17302-128">L'utente malintenzionato accede quindi alla cassetta postale di Exchange degli utenti.</span><span class="sxs-lookup"><span data-stu-id="17302-128">The attacker then sign in to that users Exchange mailbox.</span></span> <span data-ttu-id="17302-129">La cassetta postale può essere in Exchange online o in Exchange locale.</span><span class="sxs-lookup"><span data-stu-id="17302-129">The mailbox can either be in Exchange online or in Exchange on-premises.</span></span>

3. <span data-ttu-id="17302-130">L'autore dell'attacco crea quindi un modello di modulo di posta elettronica personalizzato e lo inserisce nella cassetta postale dell'utente.</span><span class="sxs-lookup"><span data-stu-id="17302-130">The attacker then creates a custom mail form template and inserts it into the user's mailbox.</span></span> <span data-ttu-id="17302-131">Il modulo personalizzato viene attivato quando la cassetta postale riceve un messaggio di posta elettronica che richiede che la cassetta postale carichi il modulo personalizzato.</span><span class="sxs-lookup"><span data-stu-id="17302-131">The custom form is triggered when the mailbox receives an email that requires the mailbox to load the custom form.</span></span> <span data-ttu-id="17302-132">Il modulo personalizzato e il formato dei messaggi di posta elettronica sono personalizzati l'uno per l'altro.</span><span class="sxs-lookup"><span data-stu-id="17302-132">The custom form and the format of email are tailor-made for each other.</span></span>
4. <span data-ttu-id="17302-133">L'utente malintenzionato invia il messaggio di posta elettronica trigger all'utente, che utilizza normalmente la propria cassetta postale.</span><span class="sxs-lookup"><span data-stu-id="17302-133">The attacker sends the trigger email to the user, who is using their mailbox normally.</span></span>

5. <span data-ttu-id="17302-134">Quando il messaggio di posta elettronica viene ricevuto, il modulo viene caricato.</span><span class="sxs-lookup"><span data-stu-id="17302-134">When the email is received, the form is loaded.</span></span> <span data-ttu-id="17302-135">Il modulo avvia un'applicazione in un server Remoto (WebDAV).</span><span class="sxs-lookup"><span data-stu-id="17302-135">The form launches an application on a remote (WebDAV) server.</span></span>

6. <span data-ttu-id="17302-136">L'applicazione installa in genere malware, ad esempio [Powershell,](https://www.powershellempire.com/)localmente nel computer dell'utente.</span><span class="sxs-lookup"><span data-stu-id="17302-136">The application typically installs malware, such as [Powershell Empire](https://www.powershellempire.com/), locally on the user's machine.</span></span>

7. <span data-ttu-id="17302-137">Il malware consente all'utente malintenzionato di rubare nuovamente il nome utente e la password o altre credenziali dal computer locale ed eseguire altre attività dannose.</span><span class="sxs-lookup"><span data-stu-id="17302-137">The malware allows the attacker to re-steal the user's username and password or other credentials from local machine and perform other malicious activities.</span></span>

## <a name="what-a-rules-and-custom-forms-injection-attack-might-look-like-office-365"></a><span data-ttu-id="17302-138">Quale potrebbe essere l'aspetto di un attacco di inserimento di regole e moduli personalizzati come Office 365?</span><span class="sxs-lookup"><span data-stu-id="17302-138">What a Rules and Custom Forms Injection attack might look like Office 365?</span></span>

<span data-ttu-id="17302-139">È improbabile che questi meccanismi di persistenza siano notati dagli utenti e in alcuni casi potrebbero anche essere invisibili.</span><span class="sxs-lookup"><span data-stu-id="17302-139">These persistence mechanisms are unlikely to be noticed by your users and may in some cases even be invisible to them.</span></span> <span data-ttu-id="17302-140">Questo articolo spiega come cercare uno dei sette segni (Indicatori di compromissione) elencati di seguito.</span><span class="sxs-lookup"><span data-stu-id="17302-140">This article tells you how to look for any of the seven signs (Indicators of Compromise) listed below.</span></span> <span data-ttu-id="17302-141">Se si trova uno di questi elementi, è necessario eseguire la procedura di correzione.</span><span class="sxs-lookup"><span data-stu-id="17302-141">If you find any of these, you need to take remediation steps.</span></span>

- <span data-ttu-id="17302-142">Indicatori della compromissione delle regole:</span><span class="sxs-lookup"><span data-stu-id="17302-142">Indicators of the Rules compromise:</span></span>

  - <span data-ttu-id="17302-143">L'azione regola è avviare un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="17302-143">Rule Action is to start an application.</span></span>

  - <span data-ttu-id="17302-144">La regola fa riferimento a un FILE EXE, ZIP o URL.</span><span class="sxs-lookup"><span data-stu-id="17302-144">Rule References an EXE, ZIP, or URL.</span></span>

  - <span data-ttu-id="17302-145">Nel computer locale cercare i nuovi processi avviati dal PID di Outlook.</span><span class="sxs-lookup"><span data-stu-id="17302-145">On the local machine, look for new process starts that originate from the Outlook PID.</span></span>

- <span data-ttu-id="17302-146">Indicatori della compromissione dei moduli personalizzati:</span><span class="sxs-lookup"><span data-stu-id="17302-146">Indicators of the Custom forms compromise:</span></span>

  - <span data-ttu-id="17302-147">Modulo personalizzato presente salvato come classe messaggio personalizzata.</span><span class="sxs-lookup"><span data-stu-id="17302-147">Custom form present saved as their own message class.</span></span>

  - <span data-ttu-id="17302-148">La classe messaggio contiene codice eseguibile.</span><span class="sxs-lookup"><span data-stu-id="17302-148">Message class contains executable code.</span></span>

  - <span data-ttu-id="17302-149">In genere archiviati nelle cartelle Libreria moduli personali o Posta in arrivo.</span><span class="sxs-lookup"><span data-stu-id="17302-149">Usually stored in Personal Forms Library or Inbox folders.</span></span>

  - <span data-ttu-id="17302-150">Il modulo è denominato IPM. Nota. [nome personalizzato].</span><span class="sxs-lookup"><span data-stu-id="17302-150">Form is named IPM.Note.[custom name].</span></span>

## <a name="steps-for-finding-signs-of-this-attack-and-confirming-it"></a><span data-ttu-id="17302-151">Passaggi per individuare i segni di questo attacco e confermarlo</span><span class="sxs-lookup"><span data-stu-id="17302-151">Steps for finding signs of this attack and confirming it</span></span>

<span data-ttu-id="17302-152">È possibile utilizzare uno di questi due metodi per confermare l'attacco:</span><span class="sxs-lookup"><span data-stu-id="17302-152">You can use either of these two methods to confirm the attack:</span></span>

- <span data-ttu-id="17302-153">Esaminare manualmente le regole e i moduli per ogni cassetta postale utilizzando il client Outlook.</span><span class="sxs-lookup"><span data-stu-id="17302-153">Manually examine the rules and forms for each mailbox using the Outlook client.</span></span> <span data-ttu-id="17302-154">Questo metodo è accurato, ma è possibile controllare solo l'utente della cassetta postale alla volta che può richiedere molto tempo se si dispone di molti utenti da controllare.</span><span class="sxs-lookup"><span data-stu-id="17302-154">This method is thorough, but you can only check mailbox user at a time which can be very time consuming if you have many users to check.</span></span> <span data-ttu-id="17302-155">Può anche causare una violazione del computer da cui si esegue il controllo.</span><span class="sxs-lookup"><span data-stu-id="17302-155">It can also result in a breach of the computer that you are running the check from.</span></span>

- <span data-ttu-id="17302-156">Utilizzare lo script [Get-AllTenantRulesAndForms.ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) PowerShell per eseguire automaticamente il dump di tutte le regole di inoltro della posta e i moduli personalizzati per tutti gli utenti della tenancy.</span><span class="sxs-lookup"><span data-stu-id="17302-156">Use the [Get-AllTenantRulesAndForms.ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) PowerShell script to automatically dump all the mail forwarding rules and custom forms for all the users in your tenancy.</span></span> <span data-ttu-id="17302-157">Questo è il metodo più rapido e sicuro con il minor sovraccarico possibile.</span><span class="sxs-lookup"><span data-stu-id="17302-157">This is the fastest and safest method with the least amount of overhead.</span></span>

### <a name="confirm-the-rules-attack-using-the-outlook-client"></a><span data-ttu-id="17302-158">Confermare l'attacco alle regole utilizzando il client Outlook</span><span class="sxs-lookup"><span data-stu-id="17302-158">Confirm the Rules Attack Using the Outlook client</span></span>

1. <span data-ttu-id="17302-159">Aprire il client Outlook degli utenti come utente.</span><span class="sxs-lookup"><span data-stu-id="17302-159">Open the users Outlook client as the user.</span></span> <span data-ttu-id="17302-160">L'utente potrebbe avere bisogno di assistenza per esaminare le regole nella propria cassetta postale.</span><span class="sxs-lookup"><span data-stu-id="17302-160">The user may need your help in examining the rules on their mailbox.</span></span>

2. <span data-ttu-id="17302-161">Vedere [l'articolo sulla gestione dei messaggi di](https://support.microsoft.com/office/c24f5dea-9465-4df4-ad17-a50704d66c59) posta elettronica utilizzando le regole per le procedure su come aprire l'interfaccia delle regole in Outlook.</span><span class="sxs-lookup"><span data-stu-id="17302-161">Refer to [Manage email messages by using rules](https://support.microsoft.com/office/c24f5dea-9465-4df4-ad17-a50704d66c59) article for the procedures on how to open the rules interface in Outlook.</span></span>

3. <span data-ttu-id="17302-162">Cercare le regole che l'utente non ha creato o eventuali regole impreviste o regole con nomi sospetti.</span><span class="sxs-lookup"><span data-stu-id="17302-162">Look for rules that the user did not create, or any unexpected rules or rules with suspicious names.</span></span>

4. <span data-ttu-id="17302-163">Cercare nella descrizione della regola le azioni delle regole che avviano e si ese verificano o fanno riferimento a un oggetto . EXE, . File ZIP o per avviare un URL.</span><span class="sxs-lookup"><span data-stu-id="17302-163">Look in the rule description for rule actions that start and application or refer to an .EXE, .ZIP file or to launching a URL.</span></span>

5. <span data-ttu-id="17302-164">Cercare eventuali nuovi processi che iniziano a utilizzare l'ID processo di Outlook.</span><span class="sxs-lookup"><span data-stu-id="17302-164">Look for any new processes that start using the Outlook process ID.</span></span> <span data-ttu-id="17302-165">Fare riferimento [a Trovare l'ID processo.](https://docs.microsoft.com/windows-hardware/drivers/debugger/finding-the-process-id)</span><span class="sxs-lookup"><span data-stu-id="17302-165">Refer to [Find the Process ID](https://docs.microsoft.com/windows-hardware/drivers/debugger/finding-the-process-id).</span></span>

### <a name="steps-to-confirm-the-forms-attack-using-the-outlook-client"></a><span data-ttu-id="17302-166">Procedura per confermare l'attacco ai moduli tramite il client Outlook</span><span class="sxs-lookup"><span data-stu-id="17302-166">Steps to confirm the Forms attack using the Outlook client</span></span>

1. <span data-ttu-id="17302-167">Aprire il client Outlook dell'utente come utente.</span><span class="sxs-lookup"><span data-stu-id="17302-167">Open the user Outlook client as the user.</span></span>

2. <span data-ttu-id="17302-168">Seguire i passaggi descritti in [Mostra la scheda Sviluppo](https://support.microsoft.com/office/e1192344-5e56-4d45-931b-e5fd9bea2d45) per la versione di Outlook degli utenti.</span><span class="sxs-lookup"><span data-stu-id="17302-168">Follow the steps in, [Show the Developer tab](https://support.microsoft.com/office/e1192344-5e56-4d45-931b-e5fd9bea2d45) for the users version of Outlook.</span></span>

3. <span data-ttu-id="17302-169">Aprire la scheda sviluppatore ora visibile in Outlook e fare clic **su Progetta modulo.**</span><span class="sxs-lookup"><span data-stu-id="17302-169">Open the now visible developer tab in Outlook and click **design a form**.</span></span>

4. <span data-ttu-id="17302-170">Selezionare Posta **in** arrivo **dall'elenco Cerca in.**</span><span class="sxs-lookup"><span data-stu-id="17302-170">Select the **Inbox** from the **Look In** list.</span></span> <span data-ttu-id="17302-171">Cercare eventuali moduli personalizzati.</span><span class="sxs-lookup"><span data-stu-id="17302-171">Look for any custom forms.</span></span> <span data-ttu-id="17302-172">I moduli personalizzati sono abbastanza rari che, se si dispone di moduli personalizzati, vale la pena avere un aspetto più approfondito.</span><span class="sxs-lookup"><span data-stu-id="17302-172">Custom forms are rare enough that if you have any custom forms at all, it is worth a deeper look.</span></span>

5. <span data-ttu-id="17302-173">Analizzare eventuali moduli personalizzati, in particolare quelli contrassegnati come nascosti.</span><span class="sxs-lookup"><span data-stu-id="17302-173">Investigate any custom forms, especially those marked as hidden.</span></span>

6. <span data-ttu-id="17302-174">Aprire eventuali moduli personalizzati e nel **gruppo** Modulo fare clic su **Visualizza codice** per vedere cosa viene eseguito quando il modulo viene caricato.</span><span class="sxs-lookup"><span data-stu-id="17302-174">Open any custom forms and in the **Form** group click **View Code** to see what runs when the form is loaded.</span></span>

### <a name="steps-to-confirm-the-rules-and-forms-attack-using-powershell"></a><span data-ttu-id="17302-175">Procedura per confermare l'attacco di regole e moduli tramite PowerShell</span><span class="sxs-lookup"><span data-stu-id="17302-175">Steps to confirm the Rules and Forms attack using PowerShell</span></span>

<span data-ttu-id="17302-176">Il modo più semplice per verificare un attacco a regole o moduli personalizzati è eseguire lo script [Get-AllTenantRulesAndForms.ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) PowerShell.</span><span class="sxs-lookup"><span data-stu-id="17302-176">The simplest way to verify a rules or custom forms attack is to run the [Get-AllTenantRulesAndForms.ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) PowerShell script.</span></span> <span data-ttu-id="17302-177">Questo script si connette a ogni cassetta postale nel tenant ed esegue il dump di tutte le regole e i moduli in due file CSV.</span><span class="sxs-lookup"><span data-stu-id="17302-177">This script connects to every mailbox in your tenant and dumps all the rules and forms into two .csv files.</span></span>

#### <a name="pre-requisites"></a><span data-ttu-id="17302-178">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="17302-178">Pre-requisites</span></span>

<span data-ttu-id="17302-179">Per eseguire lo script, è necessario disporre di diritti di amministratore globale perché lo script si connette a tutte le cassette postali della tenancy per leggere le regole e i moduli.</span><span class="sxs-lookup"><span data-stu-id="17302-179">You will need to have a global administrator rights to run the script because the script connects to every mailbox in the tenancy to read the rules and forms.</span></span>

1. <span data-ttu-id="17302-180">Accedi al computer da cui eseguirai lo script con diritti di amministratore locale.</span><span class="sxs-lookup"><span data-stu-id="17302-180">Sign in to the machine that you will run the script from with local administrator rights.</span></span>

2. <span data-ttu-id="17302-181">Scaricare o copiare lo script Get-AllTenantRulesAndForms.ps1 da GitHub in una cartella da cui verrà eseguito.</span><span class="sxs-lookup"><span data-stu-id="17302-181">Download or copy the Get-AllTenantRulesAndForms.ps1 script from GitHub to a folder from which you will run it.</span></span> <span data-ttu-id="17302-182">Lo script creerà due file contrassegnati con data in questa cartella, MailboxFormsExport-yyyy-mm-dd.csv e MailboxRulesExport-yyyy-mm-dd.csv.</span><span class="sxs-lookup"><span data-stu-id="17302-182">The script will create two date stamped files to this folder, MailboxFormsExport-yyyy-mm-dd.csv, and MailboxRulesExport-yyyy-mm-dd.csv.</span></span>

3. <span data-ttu-id="17302-183">Aprire un'istanza di PowerShell come amministratore e aprire la cartella in cui è stato salvato lo script.</span><span class="sxs-lookup"><span data-stu-id="17302-183">Open a PowerShell instance as an administrator and open the folder you saved the script to.</span></span>

4. <span data-ttu-id="17302-184">Eseguire questa riga di comando di PowerShell come indicato di `.\Get-AllTenantRulesAndForms.ps1` seguito.\Get-AllTenantRulesAndForms.ps1</span><span class="sxs-lookup"><span data-stu-id="17302-184">Run this PowerShell command line as follows `.\Get-AllTenantRulesAndForms.ps1`.\Get-AllTenantRulesAndForms.ps1</span></span>

#### <a name="interpreting-the-output"></a><span data-ttu-id="17302-185">Interpretazione dell'output</span><span class="sxs-lookup"><span data-stu-id="17302-185">Interpreting the output</span></span>

- <span data-ttu-id="17302-186">**MailboxRulesExport-*aaaa-mm-gg*.csv**: esaminare le regole (una per riga) per le condizioni di azione che includono applicazioni o eseguibili:</span><span class="sxs-lookup"><span data-stu-id="17302-186">**MailboxRulesExport-*yyyy-mm-dd*.csv**: Examine the rules (one per row) for action conditions that include applications or executables:</span></span>

  - <span data-ttu-id="17302-187">**ActionType (colonna A):** se viene visualizzato il valore "ID_ACTION_CUSTOM", è probabile che la regola sia dannosa.</span><span class="sxs-lookup"><span data-stu-id="17302-187">**ActionType (column A)**: If you see the value "ID_ACTION_CUSTOM", the rule is likely malicious.</span></span>

  - <span data-ttu-id="17302-188">**IsPotentiallyMalicious (colonna D):** se questo valore è "TRUE", è probabile che la regola sia dannosa.</span><span class="sxs-lookup"><span data-stu-id="17302-188">**IsPotentiallyMalicious (column D)**: If this value is "TRUE", the rule is likely malicious.</span></span>

  - <span data-ttu-id="17302-189">**ActionCommand (colonna G):** se viene elencata un'applicazione o un file con estensione exe, zip o una voce che fa riferimento a un URL, che non dovrebbe essere presente, è probabile che la regola sia dannosa.</span><span class="sxs-lookup"><span data-stu-id="17302-189">**ActionCommand (column G)**: If this lists an application or any file with a .exe, .zip extension or an entry that refers to a URL, that is not supposed to be there, the rule is likely malicious.</span></span>

- <span data-ttu-id="17302-190">**MailboxFormsExport-*aaaa-mm-gg*.csv:** in generale, l'utilizzo di moduli personalizzati è molto raro.</span><span class="sxs-lookup"><span data-stu-id="17302-190">**MailboxFormsExport-*yyyy-mm-dd*.csv**: In general, the use of custom forms is very rare.</span></span> <span data-ttu-id="17302-191">Se nella cartella di lavoro è presente una cartella di lavoro, aprire la cassetta postale dell'utente ed esaminare il modulo stesso.</span><span class="sxs-lookup"><span data-stu-id="17302-191">If you find any in this workbook, you open that user's mailbox and examine the form itself.</span></span> <span data-ttu-id="17302-192">Se l'organizzazione non l'ha inserita intenzionalmente, è probabile che sia dannosa.</span><span class="sxs-lookup"><span data-stu-id="17302-192">If your organization did not put it there intentionally, it is likely malicious.</span></span>

## <a name="how-to-stop-and-remediate-the-outlook-rules-and-forms-attack"></a><span data-ttu-id="17302-193">Come arrestare e correggere l'attacco alle regole e ai moduli di Outlook</span><span class="sxs-lookup"><span data-stu-id="17302-193">How to stop and remediate the Outlook Rules and Forms attack</span></span>

<span data-ttu-id="17302-194">Se si trovano prove di uno di questi attacchi, la correzione è semplice, basta eliminare la regola o il modulo dalla cassetta postale.</span><span class="sxs-lookup"><span data-stu-id="17302-194">If you find any evidence of either of these attacks, remediation is simple, just delete the rule or form from the mailbox.</span></span> <span data-ttu-id="17302-195">A tale scopo, è possibile utilizzare il client Outlook o PowerShell remoto per rimuovere le regole.</span><span class="sxs-lookup"><span data-stu-id="17302-195">You can do this with the Outlook client or using remote PowerShell to remove rules.</span></span>

### <a name="using-outlook"></a><span data-ttu-id="17302-196">Utilizzo di Outlook</span><span class="sxs-lookup"><span data-stu-id="17302-196">Using Outlook</span></span>

1. <span data-ttu-id="17302-197">Identificare tutti i dispositivi utilizzati dall'utente con Outlook.</span><span class="sxs-lookup"><span data-stu-id="17302-197">Identify all the devices that the user has used with Outlook.</span></span> <span data-ttu-id="17302-198">Dovranno essere tutti puliti dal potenziale malware.</span><span class="sxs-lookup"><span data-stu-id="17302-198">They will all need to be cleaned of potential malware.</span></span> <span data-ttu-id="17302-199">Non consentire all'utente di accedere e usare la posta elettronica finché non vengono puliti tutti i dispositivi.</span><span class="sxs-lookup"><span data-stu-id="17302-199">Do not allow the user to sign on and use email until all the devices are cleaned.</span></span>

2. <span data-ttu-id="17302-200">Seguire i passaggi descritti in [Eliminare una regola](https://support.microsoft.com/office/2f0e7139-f696-4422-8498-44846db9067f) per ogni dispositivo.</span><span class="sxs-lookup"><span data-stu-id="17302-200">Follow the steps in [Delete a rule](https://support.microsoft.com/office/2f0e7139-f696-4422-8498-44846db9067f) for each device.</span></span>

3. <span data-ttu-id="17302-201">Se non si è sicuri della presenza di altro malware, è possibile formattare e installare di nuovo tutto il software nel dispositivo.</span><span class="sxs-lookup"><span data-stu-id="17302-201">If you are unsure about the presence of other malware, you can format and re-install all the software on the device.</span></span> <span data-ttu-id="17302-202">Per i dispositivi mobili puoi seguire i passaggi del produttore per ripristinare l'immagine di fabbrica del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="17302-202">For mobile devices you can follow the manufacturers steps to reset the device to the factory image.</span></span>

4. <span data-ttu-id="17302-203">Installare le versioni più aggiornate di Outlook.</span><span class="sxs-lookup"><span data-stu-id="17302-203">Install the most up-to-date versions of Outlook.</span></span> <span data-ttu-id="17302-204">Tenere presente che la versione corrente di Outlook blocca entrambi i tipi di attacco per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="17302-204">Remember that the current version of Outlook blocks both types of this attack by default.</span></span>

5. <span data-ttu-id="17302-205">Dopo aver rimosso tutte le copie offline della cassetta postale, reimpostare la password dell'utente (utilizzarne una di alta qualità) e seguire i passaggi descritti [in](../../admin/security-and-compliance/set-up-multi-factor-authentication.md) Configurare l'autenticazione a più fattori per gli utenti se l'autenticazione a più fattori non è già stata abilitata.</span><span class="sxs-lookup"><span data-stu-id="17302-205">Once all offline copies of the mailbox have been removed, reset the user's password (use a high-quality one) and follow the steps in [Setup multi-factor authentication for users](../../admin/security-and-compliance/set-up-multi-factor-authentication.md) if MFA has not already been enabled.</span></span> <span data-ttu-id="17302-206">Ciò garantisce che le credenziali dell'utente non siano esposte tramite altri mezzi (ad esempio phishing o re-uso della password).</span><span class="sxs-lookup"><span data-stu-id="17302-206">This ensures that the user's credentials are not exposed via other means (such as phishing or password re-use).</span></span>

### <a name="using-powershell"></a><span data-ttu-id="17302-207">Utilizzo di PowerShell</span><span class="sxs-lookup"><span data-stu-id="17302-207">Using PowerShell</span></span>

<span data-ttu-id="17302-208">Esistono due cmdlet di PowerShell remoti che è possibile utilizzare per rimuovere o disabilitare le regole pericolose.</span><span class="sxs-lookup"><span data-stu-id="17302-208">There are two remote PowerShell cmdlets you can use to remove or disable dangerous rules.</span></span> <span data-ttu-id="17302-209">Seguire i passaggi.</span><span class="sxs-lookup"><span data-stu-id="17302-209">Just follow the steps.</span></span>

#### <a name="steps-for-mailboxes-that-are-on-an-exchange-server"></a><span data-ttu-id="17302-210">Passaggi per le cassette postali presenti in un server Exchange</span><span class="sxs-lookup"><span data-stu-id="17302-210">Steps for mailboxes that are on an Exchange server</span></span>

1. <span data-ttu-id="17302-211">Connettersi al server Exchange utilizzando Remote PowerShell.</span><span class="sxs-lookup"><span data-stu-id="17302-211">Connect to the Exchange server using remote PowerShell.</span></span> <span data-ttu-id="17302-212">Seguire i passaggi descritti in [Connettersi ai server Exchange tramite PowerShell remoto.](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-servers-using-remote-powershell)</span><span class="sxs-lookup"><span data-stu-id="17302-212">Follow the steps in [Connect to Exchange servers using remote PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-servers-using-remote-powershell).</span></span>

2. <span data-ttu-id="17302-213">Se si desidera rimuovere completamente una singola regola, più regole o tutte le regole da una cassetta postale, utilizzare il cmdlet [Remove-InboxRule.](https://docs.microsoft.com/powershell/module/exchange/Remove-InboxRule)</span><span class="sxs-lookup"><span data-stu-id="17302-213">If you want to completely remove a single rule, multiple rules, or all rules from a mailbox use the [Remove-InboxRule](https://docs.microsoft.com/powershell/module/exchange/Remove-InboxRule) cmdlet.</span></span>

3. <span data-ttu-id="17302-214">Se si desidera mantenere la regola e il relativo contenuto per ulteriori indagini, utilizzare il cmdlet [Disable-InboxRule.](https://docs.microsoft.com/powershell/module/exchange/disable-inboxrule)</span><span class="sxs-lookup"><span data-stu-id="17302-214">If you want to retain the rule and its contents for further investigation use the [Disable-InboxRule](https://docs.microsoft.com/powershell/module/exchange/disable-inboxrule) cmdlet.</span></span>

#### <a name="steps-for-mailboxes-in-exchange-online"></a><span data-ttu-id="17302-215">Passaggi per le cassette postali in Exchange Online</span><span class="sxs-lookup"><span data-stu-id="17302-215">Steps for mailboxes in Exchange Online</span></span>

1. <span data-ttu-id="17302-216">Seguire i passaggi descritti in [Connettersi a Exchange Online tramite PowerShell.](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-powershell)</span><span class="sxs-lookup"><span data-stu-id="17302-216">Follow the steps in [Connect to Exchange Online using PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-powershell).</span></span>

2. <span data-ttu-id="17302-217">Se si desidera rimuovere completamente una singola regola, più regole o tutte le regole da una cassetta postale, utilizzare il cmdlet [Remove-Inbox Rule.](https://docs.microsoft.com/powershell/module/exchange/Remove-InboxRule)</span><span class="sxs-lookup"><span data-stu-id="17302-217">If you want to completely remove a single rule, multiple rules, or all rules from a mailbox use the [Remove-Inbox Rule](https://docs.microsoft.com/powershell/module/exchange/Remove-InboxRule) cmdlet.</span></span>

3. <span data-ttu-id="17302-218">Se si desidera mantenere la regola e il relativo contenuto per ulteriori indagini, utilizzare il cmdlet [Disable-InboxRule.](https://docs.microsoft.com/powershell/module/exchange/disable-inboxrule)</span><span class="sxs-lookup"><span data-stu-id="17302-218">If you want to retain the rule and its contents for further investigation use the [Disable-InboxRule](https://docs.microsoft.com/powershell/module/exchange/disable-inboxrule) cmdlet.</span></span>

## <a name="how-to-minimize-future-attacks"></a><span data-ttu-id="17302-219">Come ridurre al minimo gli attacchi futuri</span><span class="sxs-lookup"><span data-stu-id="17302-219">How to minimize future attacks</span></span>

### <a name="first-protect-your-accounts"></a><span data-ttu-id="17302-220">Prima di tutto: proteggere gli account</span><span class="sxs-lookup"><span data-stu-id="17302-220">First: protect your accounts</span></span>

<span data-ttu-id="17302-221">Gli exploit regole e moduli vengono usati da un utente malintenzionato solo dopo aver rubato o violato uno degli account dell'utente.</span><span class="sxs-lookup"><span data-stu-id="17302-221">The Rules and Forms exploits are only used by an attacker after they have stolen or breached one of your user's accounts.</span></span> <span data-ttu-id="17302-222">Pertanto, il primo passaggio per impedire l'uso di questi exploit nell'organizzazione consiste nel proteggere in modo aggressivo gli account utente.</span><span class="sxs-lookup"><span data-stu-id="17302-222">So, your first step to preventing the use of these exploits against your organization is to aggressively protect your user accounts.</span></span> <span data-ttu-id="17302-223">Alcuni dei modi più comuni in cui vengono violati gli account sono gli attacchi di phishing [o di irrorazione delle password.](https://www.dabcc.com/microsoft-defending-against-password-spray-attacks/)</span><span class="sxs-lookup"><span data-stu-id="17302-223">Some of the most common ways that accounts are breached are through phishing or [password spraying](https://www.dabcc.com/microsoft-defending-against-password-spray-attacks/) attacks.</span></span>

<span data-ttu-id="17302-224">Il modo migliore per proteggere gli account utente, in particolare gli account amministratore, è configurare l'autenticazione a più [fattori per gli utenti.](../../admin/security-and-compliance/set-up-multi-factor-authentication.md)</span><span class="sxs-lookup"><span data-stu-id="17302-224">The best way to protect your user accounts, and especially your administrator accounts, is to [set up multi-factor authentication for users](../../admin/security-and-compliance/set-up-multi-factor-authentication.md).</span></span> <span data-ttu-id="17302-225">È inoltre consigliabile:</span><span class="sxs-lookup"><span data-stu-id="17302-225">You should also:</span></span>

- <span data-ttu-id="17302-226">Monitorare la modalità di accesso e utilizzo [degli account utente.](https://docs.microsoft.com/azure/active-directory/active-directory-view-access-usage-reports)</span><span class="sxs-lookup"><span data-stu-id="17302-226">Monitor how your user accounts are [accessed and used](https://docs.microsoft.com/azure/active-directory/active-directory-view-access-usage-reports).</span></span> <span data-ttu-id="17302-227">Non è possibile impedire la violazione iniziale, ma si ridurrà la durata e l'impatto della violazione rilevandola prima.</span><span class="sxs-lookup"><span data-stu-id="17302-227">You may not prevent the initial breach, but you will shorten the duration and the impact of the breach by detecting it sooner.</span></span> <span data-ttu-id="17302-228">È possibile usare questi criteri [di Office 365 Cloud App Security](https://docs.microsoft.com/cloud-app-security/what-is-cloud-app-security) per monitorare gli account e avvisare in caso di attività insolite:</span><span class="sxs-lookup"><span data-stu-id="17302-228">You can use these [Office 365 Cloud App Security policies](https://docs.microsoft.com/cloud-app-security/what-is-cloud-app-security) to monitor you accounts and alert on unusual activity:</span></span>

  - <span data-ttu-id="17302-229">**Più tentativi** di accesso non riusciti: questo criterio consente di profilire l'ambiente e di attivare avvisi quando gli utenti eseguono più attività di accesso non riuscite in una singola sessione rispetto alla linea di base appresa, che potrebbe indicare un tentativo di violazione.</span><span class="sxs-lookup"><span data-stu-id="17302-229">**Multiple failed login attempts**: This policy profiles your environment and triggers alerts when users perform multiple failed login activities in a single session with respect to the learned baseline, which could indicate an attempted breach.</span></span>

  - <span data-ttu-id="17302-230">**Viaggi impossibili:** questo criterio consente di profilire l'ambiente e di attivare avvisi quando le attività vengono rilevate dallo stesso utente in posizioni diverse in un periodo di tempo inferiore al tempo di viaggio previsto tra le due posizioni.</span><span class="sxs-lookup"><span data-stu-id="17302-230">**Impossible travel**: This policy profiles your environment and triggers alerts when activities are detected from the same user in different locations within a time period that is shorter than the expected travel time between the two locations.</span></span> <span data-ttu-id="17302-231">Ciò potrebbe indicare che un utente diverso usa le stesse credenziali.</span><span class="sxs-lookup"><span data-stu-id="17302-231">This could indicate that a different user is using the same credentials.</span></span> <span data-ttu-id="17302-232">Il rilevamento di questo comportamento anomalo richiede un periodo di apprendimento iniziale di sette giorni durante il quale apprende il modello di attività di un nuovo utente.</span><span class="sxs-lookup"><span data-stu-id="17302-232">Detecting this anomalous behavior necessitates an initial learning period of seven days during which it learns a new user's activity pattern.</span></span>

  - <span data-ttu-id="17302-233">**Attività impersonata** insolita (da parte dell'utente): questo criterio consente di profilire l'ambiente e di attivare avvisi quando gli utenti eseguono più attività rappresentate in una singola sessione rispetto alla previsione appresa, che potrebbe indicare un tentativo di violazione.</span><span class="sxs-lookup"><span data-stu-id="17302-233">**Unusual impersonated activity (by user)**: This policy profiles your environment and triggers alerts when users perform multiple impersonated activities in a single session with respect to the baseline learned, which could indicate an attempted breach.</span></span>

- <span data-ttu-id="17302-234">Sfruttare uno strumento come [Office 365 Secure Score per](https://securescore.office.com/) gestire le configurazioni e i comportamenti di sicurezza dell'account.</span><span class="sxs-lookup"><span data-stu-id="17302-234">Leverage a tool like [Office 365 Secure Score](https://securescore.office.com/) to manage account security configurations and behaviors.</span></span>

### <a name="second-keep-your-outlook-clients-current"></a><span data-ttu-id="17302-235">Secondo: Mantenere i client Outlook sempre attivi</span><span class="sxs-lookup"><span data-stu-id="17302-235">Second: Keep your Outlook clients current</span></span>

<span data-ttu-id="17302-236">Le versioni completamente aggiornate e con patch di Outlook 2013 e 2016 disabilitano l'azione regola/modulo "Avvia applicazione" per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="17302-236">Fully-updated and patched versions of Outlook 2013, and 2016 disable the "Start Application" rule/form action by default.</span></span> <span data-ttu-id="17302-237">In questo modo, anche se un utente malintenzionato viola l'account, le azioni della regola e del modulo verranno bloccate.</span><span class="sxs-lookup"><span data-stu-id="17302-237">This will ensure that, even if an attacker breaches the account, the rule and form actions will be blocked.</span></span> <span data-ttu-id="17302-238">È possibile installare gli aggiornamenti e le patch di sicurezza più recenti seguendo la procedura descritta in [Installare gli aggiornamenti di Office.](https://support.microsoft.com/office/2ab296f3-7f03-43a2-8e50-46de917611c5)</span><span class="sxs-lookup"><span data-stu-id="17302-238">You can install the latest updates and security patches by following the steps in [Install Office updates](https://support.microsoft.com/office/2ab296f3-7f03-43a2-8e50-46de917611c5).</span></span>

<span data-ttu-id="17302-239">Ecco le versioni delle patch per i client Outlook 2013 e 2016:</span><span class="sxs-lookup"><span data-stu-id="17302-239">Here are the patch versions for your Outlook 2013 and 2016 clients:</span></span>

- <span data-ttu-id="17302-240">**Outlook 2016**: 16.0.4534.1001 o versione successiva.</span><span class="sxs-lookup"><span data-stu-id="17302-240">**Outlook 2016**: 16.0.4534.1001 or greater.</span></span>

- <span data-ttu-id="17302-241">**Outlook 2013**: 15.0.4937.1000 o versione successiva.</span><span class="sxs-lookup"><span data-stu-id="17302-241">**Outlook 2013**: 15.0.4937.1000 or greater.</span></span>

<span data-ttu-id="17302-242">Per ulteriori informazioni sulle singole patch di sicurezza, vedere:</span><span class="sxs-lookup"><span data-stu-id="17302-242">For more information on the individual security patches, see:</span></span>

- [<span data-ttu-id="17302-243">Patch di sicurezza di Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="17302-243">Outlook 2016 Security Patch</span></span>](https://support.microsoft.com/help/3191883)

- [<span data-ttu-id="17302-244">Patch di sicurezza di Outlook 2013</span><span class="sxs-lookup"><span data-stu-id="17302-244">Outlook 2013 Security Patch</span></span>](https://support.microsoft.com/help/3191938)

### <a name="third-monitor-your-outlook-clients"></a><span data-ttu-id="17302-245">Terzo: monitorare i client Outlook</span><span class="sxs-lookup"><span data-stu-id="17302-245">Third: Monitor your Outlook clients</span></span>

<span data-ttu-id="17302-246">Tieni presente che anche con le patch e gli aggiornamenti installati, un utente malintenzionato può modificare la configurazione del computer locale per abilitare nuovamente il comportamento "Avvia applicazione".</span><span class="sxs-lookup"><span data-stu-id="17302-246">Note that even with the patches and updates installed, it is possible for an attacker to change the local machine configuration to re-enable the "Start Application" behavior.</span></span> <span data-ttu-id="17302-247">È possibile utilizzare [Gestione avanzata Criteri di gruppo](https://docs.microsoft.com/microsoft-desktop-optimization-pack/agpm/) per monitorare e applicare i criteri del computer locale ai client.</span><span class="sxs-lookup"><span data-stu-id="17302-247">You can use [Advanced Group Policy Management](https://docs.microsoft.com/microsoft-desktop-optimization-pack/agpm/) to monitor and enforce local machine policies on your clients.</span></span>

<span data-ttu-id="17302-248">Puoi vedere se "Avvia applicazione" è stato ri-abilitato tramite una sostituzione nel Registro di sistema usando le informazioni in Come visualizzare il Registro di sistema usando le versioni a [64 bit di Windows.](https://support.microsoft.com/help/305097)</span><span class="sxs-lookup"><span data-stu-id="17302-248">You can to see if "Start Application" has been re-enabled through an override in the registry by using the information in [How to view the system registry by using 64-bit versions of Windows](https://support.microsoft.com/help/305097).</span></span> <span data-ttu-id="17302-249">Controllare queste sottochiavi:</span><span class="sxs-lookup"><span data-stu-id="17302-249">Check these subkeys:</span></span>

- <span data-ttu-id="17302-250">**Outlook 2016:**`HKEY_CURRENT_USER\Software\Microsoft\Office\16.0\Outlook\Security\`</span><span class="sxs-lookup"><span data-stu-id="17302-250">**Outlook 2016**: `HKEY_CURRENT_USER\Software\Microsoft\Office\16.0\Outlook\Security\`</span></span>

- <span data-ttu-id="17302-251">**Outlook 2013:**`HKEY_CURRENT_USER\Software\Microsoft\Office\15.0\Outlook\Security\`</span><span class="sxs-lookup"><span data-stu-id="17302-251">**Outlook 2013**: `HKEY_CURRENT_USER\Software\Microsoft\Office\15.0\Outlook\Security\`</span></span>

<span data-ttu-id="17302-252">Cercare la chiave EnableUnsafeClientMailRules.</span><span class="sxs-lookup"><span data-stu-id="17302-252">Look for the key EnableUnsafeClientMailRules.</span></span> <span data-ttu-id="17302-253">Se è presente ed è impostato su 1, la patch di sicurezza di Outlook è stata ignorata e il computer è vulnerabile all'attacco modulo/regole.</span><span class="sxs-lookup"><span data-stu-id="17302-253">If it is there and is set to 1, the Outlook security patch has been overridden and the computer is vulnerable to the Form/Rules attack.</span></span> <span data-ttu-id="17302-254">Se il valore è 0, l'azione "Avvia applicazione" viene disabilitata.</span><span class="sxs-lookup"><span data-stu-id="17302-254">If the value is 0, the "Start Application" action is disabled.</span></span> <span data-ttu-id="17302-255">Se è installata la versione aggiornata e con patch di Outlook e questa chiave del Registro di sistema non è presente, un sistema non è vulnerabile a questi attacchi.</span><span class="sxs-lookup"><span data-stu-id="17302-255">If the updated and patched version of Outlook is installed and this registry key is not present, then a system is not vulnerable to these attacks.</span></span>

<span data-ttu-id="17302-256">I clienti con installazioni di Exchange locali devono prendere in considerazione la possibilità di bloccare le versioni precedenti di Outlook che non dispongono di patch disponibili.</span><span class="sxs-lookup"><span data-stu-id="17302-256">Customers with on-premises Exchange installations should consider blocking older versions of Outlook that do not have patches available.</span></span> <span data-ttu-id="17302-257">Per informazioni dettagliate su questo processo, vedere l'articolo [Configure Outlook client blocking.](https://docs.microsoft.com/exchange/configure-outlook-client-blocking-exchange-2013-help)</span><span class="sxs-lookup"><span data-stu-id="17302-257">Details on this process can be found in the article [Configure Outlook client blocking](https://docs.microsoft.com/exchange/configure-outlook-client-blocking-exchange-2013-help).</span></span>

## <a name="secure-microsoft-365-like-a-cybersecurity-pro"></a><span data-ttu-id="17302-258">Proteggere Microsoft 365 come un professionista della sicurezza informatica</span><span class="sxs-lookup"><span data-stu-id="17302-258">Secure Microsoft 365 like a cybersecurity pro</span></span>

<span data-ttu-id="17302-259">L'abbonamento a Microsoft 365 include un potente set di funzionalità di protezione che consente di proteggere i propri dati e quelli degli altri utenti.</span><span class="sxs-lookup"><span data-stu-id="17302-259">Your Microsoft 365 subscription comes with a powerful set of security capabilities that you can use to protect your data and your users.</span></span> <span data-ttu-id="17302-260">Usare la [Roadmap della sicurezza di Microsoft 365: principali priorità per i primi 30 giorni, 90 giorni e oltre](security-roadmap.md) per implementare le procedure consigliate da Microsoft per proteggere il tenant di Microsoft 365.</span><span class="sxs-lookup"><span data-stu-id="17302-260">Use the [Microsoft 365 security roadmap - Top priorities for the first 30 days, 90 days, and beyond](security-roadmap.md) to implement Microsoft recommended best practices for securing your Microsoft 365 tenant.</span></span>

- <span data-ttu-id="17302-261">Attività da eseguire i primi 30 giorni.</span><span class="sxs-lookup"><span data-stu-id="17302-261">Tasks to accomplish in the first 30 days.</span></span> <span data-ttu-id="17302-262">Queste hanno effetto immediato e sono a basso impatto per gli utenti.</span><span class="sxs-lookup"><span data-stu-id="17302-262">These have immediate affect and are low-impact to your users.</span></span>

- <span data-ttu-id="17302-263">Attività da completare in 90 giorni.</span><span class="sxs-lookup"><span data-stu-id="17302-263">Tasks to accomplish in 90 days.</span></span> <span data-ttu-id="17302-264">Queste attività richiedono una quantità di tempo leggermente superiore per la pianificazione e l'implementazione, ma aumentano notevolmente il livello di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="17302-264">These take a bit more time to plan and implement but greatly improve your security posture.</span></span>

- <span data-ttu-id="17302-265">Dopo 90 giorni.</span><span class="sxs-lookup"><span data-stu-id="17302-265">Beyond 90 days.</span></span> <span data-ttu-id="17302-266">Questi miglioramenti si instaurano nei primi 90 giorni di lavoro effettuato.</span><span class="sxs-lookup"><span data-stu-id="17302-266">These enhancements build in your first 90 days work.</span></span>

## <a name="see-also"></a><span data-ttu-id="17302-267">Vedere anche:</span><span class="sxs-lookup"><span data-stu-id="17302-267">See also:</span></span>

- <span data-ttu-id="17302-268">[Malicious Outlook Rules](https://silentbreaksecurity.com/malicious-outlook-rules/) by SilentBreak Security Post about Rules Vector fornisce una revisione dettagliata del modo in cui le regole di Outlook.</span><span class="sxs-lookup"><span data-stu-id="17302-268">[Malicious Outlook Rules](https://silentbreaksecurity.com/malicious-outlook-rules/) by SilentBreak Security Post about Rules Vector provides a detailed review of how the Outlook Rules.</span></span>

- <span data-ttu-id="17302-269">[MAPI su HTTP e Mailrule Pwnage](https://sensepost.com/blog/2016/mapi-over-http-and-mailrule-pwnage/) nel blog Sensepost su Mailrule Pwnage illustra uno strumento denominato Ruler che consente di sfruttare le cassette postali tramite le regole di Outlook.</span><span class="sxs-lookup"><span data-stu-id="17302-269">[MAPI over HTTP and Mailrule Pwnage](https://sensepost.com/blog/2016/mapi-over-http-and-mailrule-pwnage/) on the Sensepost blog about Mailrule Pwnage discusses a tool called Ruler that lets you exploit mailboxes through Outlook rules.</span></span>

- <span data-ttu-id="17302-270">[Moduli e shell di Outlook nel](https://sensepost.com/blog/2017/outlook-forms-and-shells/) blog Sensepost su Forms Threat Vector.</span><span class="sxs-lookup"><span data-stu-id="17302-270">[Outlook forms and shells](https://sensepost.com/blog/2017/outlook-forms-and-shells/) on the Sensepost blog about Forms Threat Vector.</span></span>

- [<span data-ttu-id="17302-271">Codebase righello</span><span class="sxs-lookup"><span data-stu-id="17302-271">Ruler Codebase</span></span>](https://github.com/sensepost/ruler)

- [<span data-ttu-id="17302-272">Indicatori di compromissione dei righelli</span><span class="sxs-lookup"><span data-stu-id="17302-272">Ruler Indicators of Compromise</span></span>](https://github.com/sensepost/notruler/blob/master/iocs.md)
