---
title: Rilevare e correggere gli attacchi di inserimento di regole e moduli personalizzati di Outlook.
f1.keywords:
- NOCSH
ms.author: tracyp
author: MSFTTracyp
manager: dansimp
ms.date: 04/23/2018
audience: ITPro
ms.topic: article
ms.collection:
- o365_security_incident_response
- M365-security-compliance
localization_priority: Normal
search.appverid:
- MET150
description: Informazioni su come riconoscere e correggere gli attacchi iniezioni di regole e moduli personalizzati di Outlook in Office 365
ms.custom: seo-marvel-apr2020
ms.technology: mdo
ms.prod: m365-security
ms.openlocfilehash: 30ddd5f57dee2156504211e76304d346a63e192d
ms.sourcegitcommit: 070724118be25cd83418d2a56863da95582dae65
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/03/2021
ms.locfileid: "50406701"
---
# <a name="detect-and-remediate-outlook-rules-and-custom-forms-injections-attacks"></a><span data-ttu-id="d32f4-103">Rilevare e correggere gli attacchi iniezioni di regole e moduli personalizzati di Outlook</span><span class="sxs-lookup"><span data-stu-id="d32f4-103">Detect and Remediate Outlook Rules and Custom Forms Injections Attacks</span></span>

[!INCLUDE [Microsoft 365 Defender rebranding](../includes/microsoft-defender-for-office.md)]


<span data-ttu-id="d32f4-104">**Riepilogo** Informazioni su come riconoscere e correggere gli attacchi iniezioni di inserimenti di moduli personalizzati e regole di Outlook in Office 365.</span><span class="sxs-lookup"><span data-stu-id="d32f4-104">**Summary** Learn how to recognize and remediate the Outlook rules and custom Forms injections attacks in Office 365.</span></span>

## <a name="what-is-the-outlook-rules-and-custom-forms-injection-attack"></a><span data-ttu-id="d32f4-105">Che cos'è l'attacco di inserimento di regole e moduli personalizzati di Outlook?</span><span class="sxs-lookup"><span data-stu-id="d32f4-105">What is the Outlook Rules and Custom Forms injection attack?</span></span>

<span data-ttu-id="d32f4-106">Dopo che un utente malintenzionato ottiene l'accesso all'organizzazione, tenterà di stabilire una base per rimanere o rientrare dopo essere stato individuato.</span><span class="sxs-lookup"><span data-stu-id="d32f4-106">After an attacker gains access to your organization, they'll try to establish a foothold to stay in or get back in after they've been discovered.</span></span> <span data-ttu-id="d32f4-107">Questa attività viene definita *creazione di un meccanismo di persistenza.*</span><span class="sxs-lookup"><span data-stu-id="d32f4-107">This activity is called *establishing a persistence mechanism*.</span></span> <span data-ttu-id="d32f4-108">Esistono due modi in cui un utente malintenzionato può utilizzare Outlook per stabilire un meccanismo di persistenza:</span><span class="sxs-lookup"><span data-stu-id="d32f4-108">There are two ways that an attacker can use Outlook to establish a persistence mechanism:</span></span>

- <span data-ttu-id="d32f4-109">Sfruttando le regole di Outlook.</span><span class="sxs-lookup"><span data-stu-id="d32f4-109">By exploiting Outlook rules.</span></span>
- <span data-ttu-id="d32f4-110">Inserimento di moduli personalizzati in Outlook.</span><span class="sxs-lookup"><span data-stu-id="d32f4-110">By injecting custom forms into Outlook.</span></span>

<span data-ttu-id="d32f4-111">La reinstallazione di Outlook o la configurazione di un nuovo computer da parte dell'utente interessato non sarà utile.</span><span class="sxs-lookup"><span data-stu-id="d32f4-111">Reinstalling Outlook, or even giving the affected person a new computer won't help.</span></span> <span data-ttu-id="d32f4-112">Quando la nuova installazione di Outlook si connette alla cassetta postale, tutte le regole e i moduli vengono sincronizzati dal cloud.</span><span class="sxs-lookup"><span data-stu-id="d32f4-112">When the fresh installation of Outlook connects to the mailbox, all rules and forms are synchronized from the cloud.</span></span> <span data-ttu-id="d32f4-113">Le regole o i moduli sono in genere progettati per eseguire codice remoto e installare malware nel computer locale.</span><span class="sxs-lookup"><span data-stu-id="d32f4-113">The rules or forms are typically designed to run remote code and install malware on the local machine.</span></span> <span data-ttu-id="d32f4-114">Il malware ruba le credenziali o esegue altre attività illecite.</span><span class="sxs-lookup"><span data-stu-id="d32f4-114">The malware steals credentials or performs other illicit activity.</span></span>

<span data-ttu-id="d32f4-115">La buona notizia è che, se si mantiene i client outlook patch alla versione più recente, non si è vulnerabili alla minaccia in quanto le impostazioni predefinite del client Outlook bloccano entrambi i meccanismi.</span><span class="sxs-lookup"><span data-stu-id="d32f4-115">The good news is: if you keep your Outlook clients patched to the latest version, you aren't vulnerable to the threat as current Outlook client defaults block both mechanisms.</span></span>

<span data-ttu-id="d32f4-116">Gli attacchi in genere seguono questi modelli:</span><span class="sxs-lookup"><span data-stu-id="d32f4-116">The attacks typically follow these patterns:</span></span>

<span data-ttu-id="d32f4-117">**L'exploit delle regole:**</span><span class="sxs-lookup"><span data-stu-id="d32f4-117">**The Rules Exploit**:</span></span>

1. <span data-ttu-id="d32f4-118">L'utente malintenzionato ruba le credenziali di un utente.</span><span class="sxs-lookup"><span data-stu-id="d32f4-118">The attacker steals a user's credentials.</span></span>

2. <span data-ttu-id="d32f4-119">L'autore dell'attacco accede alla cassetta postale di Exchange dell'utente (Exchange Online o Exchange locale).</span><span class="sxs-lookup"><span data-stu-id="d32f4-119">The attacker signs in to that user's Exchange mailbox (Exchange Online or on-premises Exchange).</span></span>

3. <span data-ttu-id="d32f4-120">L'autore dell'attacco crea una regola di inoltro della posta in arrivo nella cassetta postale.</span><span class="sxs-lookup"><span data-stu-id="d32f4-120">The attacker creates a forwarding Inbox rule in the mailbox.</span></span> <span data-ttu-id="d32f4-121">La regola di inoltro viene attivata quando la cassetta postale riceve un messaggio specifico dall'utente malintenzionato che soddisfa le condizioni della regola.</span><span class="sxs-lookup"><span data-stu-id="d32f4-121">The forwarding rule is triggered when the mailbox receives a specific message from the attacker that matches the conditions of the rule.</span></span> <span data-ttu-id="d32f4-122">Le condizioni della regola e il formato dei messaggi sono personalizzati.</span><span class="sxs-lookup"><span data-stu-id="d32f4-122">The rule conditions and message format are tailor-made for each other.</span></span>

4. <span data-ttu-id="d32f4-123">L'utente malintenzionato invia il messaggio di posta elettronica trigger alla cassetta postale compromessa, che viene ancora utilizzata normalmente dall'utente ignara.</span><span class="sxs-lookup"><span data-stu-id="d32f4-123">The attacker sends the trigger email to the compromised mailbox, which is still being used as normal by the unsuspecting user.</span></span>

5. <span data-ttu-id="d32f4-124">Quando la cassetta postale riceve un messaggio che soddisfa le condizioni della regola, viene applicata l'azione della regola.</span><span class="sxs-lookup"><span data-stu-id="d32f4-124">When the mailbox receives a message that matches the conditions of rule, the action of the rule is applied.</span></span> <span data-ttu-id="d32f4-125">In genere, l'azione della regola è avviare un'applicazione in un server Remoto (WebDAV).</span><span class="sxs-lookup"><span data-stu-id="d32f4-125">Typically, the rule action is to launch an application on a remote (WebDAV) server.</span></span>

6. <span data-ttu-id="d32f4-126">In genere, l'applicazione installa malware nel computer dell'utente ,ad esempio [PowerShell 2013.](https://www.powershellempire.com/)</span><span class="sxs-lookup"><span data-stu-id="d32f4-126">Typically, the application installs malware on the user's machine (for example, [PowerShell Empire](https://www.powershellempire.com/)).</span></span>

7. <span data-ttu-id="d32f4-127">Il malware consente all'utente malintenzionato di rubare (o rubare di nuovo) il nome utente e la password o altre credenziali dal computer locale ed eseguire altre attività dannose.</span><span class="sxs-lookup"><span data-stu-id="d32f4-127">The malware allows the attacker to steal (or steal again) the user's username and password or other credentials from local machine and perform other malicious activities.</span></span>

<span data-ttu-id="d32f4-128">**L'exploit dei moduli:**</span><span class="sxs-lookup"><span data-stu-id="d32f4-128">**The Forms Exploit**:</span></span>

1. <span data-ttu-id="d32f4-129">L'utente malintenzionato ruba le credenziali di un utente.</span><span class="sxs-lookup"><span data-stu-id="d32f4-129">The attacker steals a user's credentials.</span></span>

2. <span data-ttu-id="d32f4-130">L'autore dell'attacco accede alla cassetta postale di Exchange dell'utente (Exchange Online o Exchange locale).</span><span class="sxs-lookup"><span data-stu-id="d32f4-130">The attacker signs in to that user's Exchange mailbox (Exchange Online or on-premises Exchange).</span></span>

3. <span data-ttu-id="d32f4-131">L'autore dell'attacco inserisce un modello di modulo di posta elettronica personalizzato nella cassetta postale dell'utente.</span><span class="sxs-lookup"><span data-stu-id="d32f4-131">The attacker inserts a custom mail form template into the user's mailbox.</span></span> <span data-ttu-id="d32f4-132">Il modulo personalizzato viene attivato quando la cassetta postale riceve un messaggio specifico dall'utente malintenzionato che richiede alla cassetta postale di caricare il modulo personalizzato.</span><span class="sxs-lookup"><span data-stu-id="d32f4-132">The custom form is triggered when the mailbox receives a specific message from the attacker that requires the mailbox to load the custom form.</span></span> <span data-ttu-id="d32f4-133">Il modulo personalizzato e il formato del messaggio sono personalizzati l'uno per l'altro.</span><span class="sxs-lookup"><span data-stu-id="d32f4-133">The custom form and the message format are tailor-made for each other.</span></span>

4. <span data-ttu-id="d32f4-134">L'utente malintenzionato invia il messaggio di posta elettronica trigger alla cassetta postale compromessa, che viene ancora utilizzata normalmente dall'utente ignara.</span><span class="sxs-lookup"><span data-stu-id="d32f4-134">The attacker sends the trigger email to the compromised mailbox, which is still being used as normal by the unsuspecting user.</span></span>

5. <span data-ttu-id="d32f4-135">Quando la cassetta postale riceve il messaggio, la cassetta postale carica il modulo richiesto.</span><span class="sxs-lookup"><span data-stu-id="d32f4-135">When the mailbox receives the message, the mailbox loads the required form.</span></span> <span data-ttu-id="d32f4-136">Il modulo avvia un'applicazione in un server Remoto (WebDAV).</span><span class="sxs-lookup"><span data-stu-id="d32f4-136">The form launches an application on a remote (WebDAV) server.</span></span>

6. <span data-ttu-id="d32f4-137">In genere, l'applicazione installa malware nel computer dell'utente ,ad esempio [PowerShell 2013.](https://www.powershellempire.com/)</span><span class="sxs-lookup"><span data-stu-id="d32f4-137">Typically, the application installs malware on the user's machine (for example, [PowerShell Empire](https://www.powershellempire.com/)).</span></span>

7. <span data-ttu-id="d32f4-138">Il malware consente all'utente malintenzionato di rubare (o rubare di nuovo) il nome utente e la password o altre credenziali dal computer locale ed eseguire altre attività dannose.</span><span class="sxs-lookup"><span data-stu-id="d32f4-138">The malware allows the attacker to steal (or steal again) the user's username and password or other credentials from local machine and perform other malicious activities.</span></span>

## <a name="what-a-rules-and-custom-forms-injection-attack-might-look-like-office-365"></a><span data-ttu-id="d32f4-139">Quale potrebbe essere l'aspetto di un attacco di inserimento di regole e moduli personalizzati come Office 365?</span><span class="sxs-lookup"><span data-stu-id="d32f4-139">What a Rules and Custom Forms Injection attack might look like Office 365?</span></span>

<span data-ttu-id="d32f4-140">È improbabile che questi meccanismi di persistenza siano notati dagli utenti e in alcuni casi potrebbero anche essere invisibili.</span><span class="sxs-lookup"><span data-stu-id="d32f4-140">These persistence mechanisms are unlikely to be noticed by your users and may in some cases even be invisible to them.</span></span> <span data-ttu-id="d32f4-141">Questo articolo spiega come cercare uno dei sette segni (Indicatori di compromissione) elencati di seguito.</span><span class="sxs-lookup"><span data-stu-id="d32f4-141">This article tells you how to look for any of the seven signs (Indicators of Compromise) listed below.</span></span> <span data-ttu-id="d32f4-142">Se si trova uno di questi elementi, è necessario eseguire la procedura di correzione.</span><span class="sxs-lookup"><span data-stu-id="d32f4-142">If you find any of these, you need to take remediation steps.</span></span>

- <span data-ttu-id="d32f4-143">**Indicatori della compromissione delle regole:**</span><span class="sxs-lookup"><span data-stu-id="d32f4-143">**Indicators of the Rules compromise**:</span></span>
  - <span data-ttu-id="d32f4-144">L'azione regola è avviare un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="d32f4-144">Rule Action is to start an application.</span></span>
  - <span data-ttu-id="d32f4-145">La regola fa riferimento a un FILE EXE, ZIP o URL.</span><span class="sxs-lookup"><span data-stu-id="d32f4-145">Rule References an EXE, ZIP, or URL.</span></span>
  - <span data-ttu-id="d32f4-146">Nel computer locale cercare i nuovi processi avviati dal PID di Outlook.</span><span class="sxs-lookup"><span data-stu-id="d32f4-146">On the local machine, look for new process starts that originate from the Outlook PID.</span></span>

- <span data-ttu-id="d32f4-147">**Indicatori della compromissione dei moduli personalizzati:**</span><span class="sxs-lookup"><span data-stu-id="d32f4-147">**Indicators of the Custom forms compromise**:</span></span>
  - <span data-ttu-id="d32f4-148">Moduli personalizzati presenti salvati come classe messaggio personalizzata.</span><span class="sxs-lookup"><span data-stu-id="d32f4-148">Custom forms present saved as their own message class.</span></span>
  - <span data-ttu-id="d32f4-149">La classe messaggio contiene codice eseguibile.</span><span class="sxs-lookup"><span data-stu-id="d32f4-149">Message class contains executable code.</span></span>
  - <span data-ttu-id="d32f4-150">In genere, i moduli dannosi vengono archiviati nelle cartelle Libreria moduli personali o Posta in arrivo.</span><span class="sxs-lookup"><span data-stu-id="d32f4-150">Typically, malicious forms are stored in Personal Forms Library or Inbox folders.</span></span>
  - <span data-ttu-id="d32f4-151">Il modulo è denominato IPM. Nota. [nome personalizzato].</span><span class="sxs-lookup"><span data-stu-id="d32f4-151">Form is named IPM.Note.[custom name].</span></span>

## <a name="steps-for-finding-signs-of-this-attack-and-confirming-it"></a><span data-ttu-id="d32f4-152">Passaggi per individuare i segni di questo attacco e confermarlo</span><span class="sxs-lookup"><span data-stu-id="d32f4-152">Steps for finding signs of this attack and confirming it</span></span>

<span data-ttu-id="d32f4-153">È possibile utilizzare uno dei metodi seguenti per confermare l'attacco:</span><span class="sxs-lookup"><span data-stu-id="d32f4-153">You can use either of the following methods to confirm the attack:</span></span>

- <span data-ttu-id="d32f4-154">Esaminare manualmente le regole e i moduli per ogni cassetta postale utilizzando il client Outlook.</span><span class="sxs-lookup"><span data-stu-id="d32f4-154">Manually examine the rules and forms for each mailbox using the Outlook client.</span></span> <span data-ttu-id="d32f4-155">Questo metodo è accurato, ma è possibile controllare una sola cassetta postale alla volta.</span><span class="sxs-lookup"><span data-stu-id="d32f4-155">This method is thorough, but you can only check one mailbox at a time.</span></span> <span data-ttu-id="d32f4-156">Questo metodo può richiedere molto tempo se hai molti utenti da controllare e potrebbe anche infettare il computer in uso.</span><span class="sxs-lookup"><span data-stu-id="d32f4-156">This method can be very time consuming if you have many users to check, and might also infect the computer that you're using.</span></span>

- <span data-ttu-id="d32f4-157">Utilizzare lo script [Get-AllTenantRulesAndForms.ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) PowerShell per eseguire automaticamente il dump di tutte le regole di inoltro della posta e i moduli personalizzati per tutti gli utenti della tenancy.</span><span class="sxs-lookup"><span data-stu-id="d32f4-157">Use the [Get-AllTenantRulesAndForms.ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) PowerShell script to automatically dump all the mail forwarding rules and custom forms for all the users in your tenancy.</span></span> <span data-ttu-id="d32f4-158">Questo è il metodo più rapido e sicuro con il minor sovraccarico possibile.</span><span class="sxs-lookup"><span data-stu-id="d32f4-158">This is the fastest and safest method with the least amount of overhead.</span></span>

### <a name="confirm-the-rules-attack-using-the-outlook-client"></a><span data-ttu-id="d32f4-159">Confermare l'attacco alle regole utilizzando il client Outlook</span><span class="sxs-lookup"><span data-stu-id="d32f4-159">Confirm the Rules Attack Using the Outlook client</span></span>

1. <span data-ttu-id="d32f4-160">Aprire il client Outlook degli utenti come utente.</span><span class="sxs-lookup"><span data-stu-id="d32f4-160">Open the users Outlook client as the user.</span></span> <span data-ttu-id="d32f4-161">L'utente potrebbe avere bisogno di assistenza per esaminare le regole nella propria cassetta postale.</span><span class="sxs-lookup"><span data-stu-id="d32f4-161">The user may need your help in examining the rules on their mailbox.</span></span>

2. <span data-ttu-id="d32f4-162">Vedere [l'articolo sulla gestione dei messaggi di](https://support.microsoft.com/office/c24f5dea-9465-4df4-ad17-a50704d66c59) posta elettronica utilizzando le regole per le procedure su come aprire l'interfaccia delle regole in Outlook.</span><span class="sxs-lookup"><span data-stu-id="d32f4-162">Refer to [Manage email messages by using rules](https://support.microsoft.com/office/c24f5dea-9465-4df4-ad17-a50704d66c59) article for the procedures on how to open the rules interface in Outlook.</span></span>

3. <span data-ttu-id="d32f4-163">Cercare le regole che l'utente non ha creato o eventuali regole impreviste o regole con nomi sospetti.</span><span class="sxs-lookup"><span data-stu-id="d32f4-163">Look for rules that the user did not create, or any unexpected rules or rules with suspicious names.</span></span>

4. <span data-ttu-id="d32f4-164">Cercare nella descrizione della regola le azioni delle regole che avviano e si ese verificano o fanno riferimento a un oggetto . EXE, . File ZIP o per avviare un URL.</span><span class="sxs-lookup"><span data-stu-id="d32f4-164">Look in the rule description for rule actions that start and application or refer to an .EXE, .ZIP file or to launching a URL.</span></span>

5. <span data-ttu-id="d32f4-165">Cercare eventuali nuovi processi che iniziano a utilizzare l'ID processo di Outlook.</span><span class="sxs-lookup"><span data-stu-id="d32f4-165">Look for any new processes that start using the Outlook process ID.</span></span> <span data-ttu-id="d32f4-166">Fare riferimento [a Trovare l'ID processo.](https://docs.microsoft.com/windows-hardware/drivers/debugger/finding-the-process-id)</span><span class="sxs-lookup"><span data-stu-id="d32f4-166">Refer to [Find the Process ID](https://docs.microsoft.com/windows-hardware/drivers/debugger/finding-the-process-id).</span></span>

### <a name="steps-to-confirm-the-forms-attack-using-the-outlook-client"></a><span data-ttu-id="d32f4-167">Procedura per confermare l'attacco ai moduli tramite il client Outlook</span><span class="sxs-lookup"><span data-stu-id="d32f4-167">Steps to confirm the Forms attack using the Outlook client</span></span>

1. <span data-ttu-id="d32f4-168">Aprire il client Outlook dell'utente come utente.</span><span class="sxs-lookup"><span data-stu-id="d32f4-168">Open the user Outlook client as the user.</span></span>

2. <span data-ttu-id="d32f4-169">Seguire i passaggi descritti in [Mostra la scheda Sviluppo](https://support.microsoft.com/office/e1192344-5e56-4d45-931b-e5fd9bea2d45) per la versione di Outlook dell'utente.</span><span class="sxs-lookup"><span data-stu-id="d32f4-169">Follow the steps in, [Show the Developer tab](https://support.microsoft.com/office/e1192344-5e56-4d45-931b-e5fd9bea2d45) for the user's version of Outlook.</span></span>

3. <span data-ttu-id="d32f4-170">Aprire la scheda sviluppatore ora visibile in Outlook e fare clic **su Progetta modulo.**</span><span class="sxs-lookup"><span data-stu-id="d32f4-170">Open the now visible developer tab in Outlook and click **design a form**.</span></span>

4. <span data-ttu-id="d32f4-171">Selezionare Posta **in** arrivo dall'elenco **Cerca in.**</span><span class="sxs-lookup"><span data-stu-id="d32f4-171">Select the **Inbox** from the **Look In** list.</span></span> <span data-ttu-id="d32f4-172">Cercare eventuali moduli personalizzati.</span><span class="sxs-lookup"><span data-stu-id="d32f4-172">Look for any custom forms.</span></span> <span data-ttu-id="d32f4-173">I moduli personalizzati sono abbastanza rari che, se si dispone di moduli personalizzati, vale la pena avere un aspetto più approfondito.</span><span class="sxs-lookup"><span data-stu-id="d32f4-173">Custom forms are rare enough that if you have any custom forms at all, it is worth a deeper look.</span></span>

5. <span data-ttu-id="d32f4-174">Analizzare eventuali moduli personalizzati, in particolare quelli contrassegnati come nascosti.</span><span class="sxs-lookup"><span data-stu-id="d32f4-174">Investigate any custom forms, especially those marked as hidden.</span></span>

6. <span data-ttu-id="d32f4-175">Aprire eventuali moduli personalizzati e nel **gruppo** Modulo fare clic su **Visualizza codice** per vedere cosa viene eseguito quando il modulo viene caricato.</span><span class="sxs-lookup"><span data-stu-id="d32f4-175">Open any custom forms and in the **Form** group click **View Code** to see what runs when the form is loaded.</span></span>

### <a name="steps-to-confirm-the-rules-and-forms-attack-using-powershell"></a><span data-ttu-id="d32f4-176">Procedura per confermare l'attacco di regole e moduli tramite PowerShell</span><span class="sxs-lookup"><span data-stu-id="d32f4-176">Steps to confirm the Rules and Forms attack using PowerShell</span></span>

<span data-ttu-id="d32f4-177">Il modo più semplice per verificare un attacco a regole o moduli personalizzati è eseguire lo script [Get-AllTenantRulesAndForms.ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) PowerShell.</span><span class="sxs-lookup"><span data-stu-id="d32f4-177">The simplest way to verify a rules or custom forms attack is to run the [Get-AllTenantRulesAndForms.ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) PowerShell script.</span></span> <span data-ttu-id="d32f4-178">Questo script si connette a ogni cassetta postale nel tenant ed esegue il dump di tutte le regole e i moduli in due file CSV.</span><span class="sxs-lookup"><span data-stu-id="d32f4-178">This script connects to every mailbox in your tenant and dumps all the rules and forms into two .csv files.</span></span>

#### <a name="pre-requisites"></a><span data-ttu-id="d32f4-179">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="d32f4-179">Pre-requisites</span></span>

<span data-ttu-id="d32f4-180">Sarà necessario disporre dei diritti di amministratore globale per eseguire lo script perché lo script si connette a tutte le cassette postali del tenancy per leggere le regole e i moduli.</span><span class="sxs-lookup"><span data-stu-id="d32f4-180">You will need to have global administrator rights to run the script because the script connects to every mailbox in the tenancy to read the rules and forms.</span></span>

1. <span data-ttu-id="d32f4-181">Accedi al computer da cui eseguirai lo script con diritti di amministratore locale.</span><span class="sxs-lookup"><span data-stu-id="d32f4-181">Sign in to the machine that you will run the script from with local administrator rights.</span></span>

2. <span data-ttu-id="d32f4-182">Scaricare o copiare lo script Get-AllTenantRulesAndForms.ps1 da GitHub in una cartella da cui verrà eseguito.</span><span class="sxs-lookup"><span data-stu-id="d32f4-182">Download or copy the Get-AllTenantRulesAndForms.ps1 script from GitHub to a folder from which you will run it.</span></span> <span data-ttu-id="d32f4-183">Lo script creerà due file contrassegnati con data in questa cartella, MailboxFormsExport-yyyy-mm-dd.csv e MailboxRulesExport-yyyy-mm-dd.csv.</span><span class="sxs-lookup"><span data-stu-id="d32f4-183">The script will create two date stamped files to this folder, MailboxFormsExport-yyyy-mm-dd.csv, and MailboxRulesExport-yyyy-mm-dd.csv.</span></span>

3. <span data-ttu-id="d32f4-184">Aprire un'istanza di PowerShell come amministratore e aprire la cartella in cui è stato salvato lo script.</span><span class="sxs-lookup"><span data-stu-id="d32f4-184">Open a PowerShell instance as an administrator and open the folder you saved the script to.</span></span>

4. <span data-ttu-id="d32f4-185">Eseguire questa riga di comando di PowerShell come indicato di `.\Get-AllTenantRulesAndForms.ps1` seguito.\Get-AllTenantRulesAndForms.ps1</span><span class="sxs-lookup"><span data-stu-id="d32f4-185">Run this PowerShell command line as follows `.\Get-AllTenantRulesAndForms.ps1`.\Get-AllTenantRulesAndForms.ps1</span></span>

#### <a name="interpreting-the-output"></a><span data-ttu-id="d32f4-186">Interpretazione dell'output</span><span class="sxs-lookup"><span data-stu-id="d32f4-186">Interpreting the output</span></span>

- <span data-ttu-id="d32f4-187">**MailboxRulesExport-*aaaa-mm-gg*.csv**: esaminare le regole (una per riga) per le condizioni di azione che includono applicazioni o eseguibili:</span><span class="sxs-lookup"><span data-stu-id="d32f4-187">**MailboxRulesExport-*yyyy-mm-dd*.csv**: Examine the rules (one per row) for action conditions that include applications or executables:</span></span>

  - <span data-ttu-id="d32f4-188">**ActionType (colonna A):** se viene visualizzato il valore "ID_ACTION_CUSTOM", è probabile che la regola sia dannosa.</span><span class="sxs-lookup"><span data-stu-id="d32f4-188">**ActionType (column A)**: If you see the value "ID_ACTION_CUSTOM", the rule is likely malicious.</span></span>

  - <span data-ttu-id="d32f4-189">**IsPotentiallyMalicious (colonna D):** se questo valore è "TRUE", è probabile che la regola sia dannosa.</span><span class="sxs-lookup"><span data-stu-id="d32f4-189">**IsPotentiallyMalicious (column D)**: If this value is "TRUE", the rule is likely malicious.</span></span>

  - <span data-ttu-id="d32f4-190">**ActionCommand (colonna G):** se questa colonna elenca un'applicazione o un file con estensioni .exe o .zip o una voce sconosciuta che fa riferimento a un URL, è probabile che la regola sia dannosa.</span><span class="sxs-lookup"><span data-stu-id="d32f4-190">**ActionCommand (column G)**: If this column lists an application or any file with .exe or .zip extensions, or an unknown entry that refers to a URL, the rule is likely malicious.</span></span>

- <span data-ttu-id="d32f4-191">**MailboxFormsExport-*aaaa-mm-gg*.csv:** in generale, l'utilizzo di moduli personalizzati è raro.</span><span class="sxs-lookup"><span data-stu-id="d32f4-191">**MailboxFormsExport-*yyyy-mm-dd*.csv**: In general, the use of custom forms is rare.</span></span> <span data-ttu-id="d32f4-192">Se nella cartella di lavoro è presente una cartella di lavoro, aprire la cassetta postale dell'utente ed esaminare il modulo stesso.</span><span class="sxs-lookup"><span data-stu-id="d32f4-192">If you find any in this workbook, you open that user's mailbox and examine the form itself.</span></span> <span data-ttu-id="d32f4-193">Se l'organizzazione non l'ha inserita intenzionalmente, è probabile che sia dannosa.</span><span class="sxs-lookup"><span data-stu-id="d32f4-193">If your organization did not put it there intentionally, it is likely malicious.</span></span>

## <a name="how-to-stop-and-remediate-the-outlook-rules-and-forms-attack"></a><span data-ttu-id="d32f4-194">Come arrestare e correggere l'attacco alle regole e ai moduli di Outlook</span><span class="sxs-lookup"><span data-stu-id="d32f4-194">How to stop and remediate the Outlook Rules and Forms attack</span></span>

<span data-ttu-id="d32f4-195">Se si trovano prove di uno di questi attacchi, la correzione è semplice, basta eliminare la regola o il modulo dalla cassetta postale.</span><span class="sxs-lookup"><span data-stu-id="d32f4-195">If you find any evidence of either of these attacks, remediation is simple, just delete the rule or form from the mailbox.</span></span> <span data-ttu-id="d32f4-196">A tale scopo, è possibile utilizzare il client Outlook o PowerShell remoto per rimuovere le regole.</span><span class="sxs-lookup"><span data-stu-id="d32f4-196">You can do this with the Outlook client or using remote PowerShell to remove rules.</span></span>

### <a name="using-outlook"></a><span data-ttu-id="d32f4-197">Utilizzo di Outlook</span><span class="sxs-lookup"><span data-stu-id="d32f4-197">Using Outlook</span></span>

1. <span data-ttu-id="d32f4-198">Identificare tutti i dispositivi utilizzati dall'utente con Outlook.</span><span class="sxs-lookup"><span data-stu-id="d32f4-198">Identify all the devices that the user has used with Outlook.</span></span> <span data-ttu-id="d32f4-199">Dovranno essere tutti puliti da potenziali malware.</span><span class="sxs-lookup"><span data-stu-id="d32f4-199">They will all need to be cleaned of potential malware.</span></span> <span data-ttu-id="d32f4-200">Non consentire all'utente di accedere e usare la posta elettronica finché non vengono puliti tutti i dispositivi.</span><span class="sxs-lookup"><span data-stu-id="d32f4-200">Do not allow the user to sign on and use email until all the devices are cleaned.</span></span>

2. <span data-ttu-id="d32f4-201">Seguire i passaggi descritti in [Eliminare una regola](https://support.microsoft.com/office/2f0e7139-f696-4422-8498-44846db9067f) per ogni dispositivo.</span><span class="sxs-lookup"><span data-stu-id="d32f4-201">Follow the steps in [Delete a rule](https://support.microsoft.com/office/2f0e7139-f696-4422-8498-44846db9067f) for each device.</span></span>

3. <span data-ttu-id="d32f4-202">Se non si è sicuri della presenza di altro malware, è possibile formattare e reinstallare tutto il software nel dispositivo.</span><span class="sxs-lookup"><span data-stu-id="d32f4-202">If you are unsure about the presence of other malware, you can format and reinstall all the software on the device.</span></span> <span data-ttu-id="d32f4-203">Per i dispositivi mobili, puoi seguire i passaggi del produttore per ripristinare l'immagine di fabbrica del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="d32f4-203">For mobile devices, you can follow the manufacturers steps to reset the device to the factory image.</span></span>

4. <span data-ttu-id="d32f4-204">Installare le versioni più aggiornate di Outlook.</span><span class="sxs-lookup"><span data-stu-id="d32f4-204">Install the most up-to-date versions of Outlook.</span></span> <span data-ttu-id="d32f4-205">Tenere presente che la versione corrente di Outlook blocca entrambi i tipi di attacco per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="d32f4-205">Remember that the current version of Outlook blocks both types of this attack by default.</span></span>

5. <span data-ttu-id="d32f4-206">Dopo aver rimosso tutte le copie offline della cassetta postale, reimpostare la password dell'utente (utilizzarne una di alta qualità) e seguire i passaggi descritti [in](../../admin/security-and-compliance/set-up-multi-factor-authentication.md) Configurare l'autenticazione a più fattori per gli utenti se l'autenticazione a più fattori non è già stata abilitata.</span><span class="sxs-lookup"><span data-stu-id="d32f4-206">Once all offline copies of the mailbox have been removed, reset the user's password (use a high quality one) and follow the steps in [Setup multi-factor authentication for users](../../admin/security-and-compliance/set-up-multi-factor-authentication.md) if MFA has not already been enabled.</span></span> <span data-ttu-id="d32f4-207">Ciò garantisce che le credenziali dell'utente non siano esposte tramite altri mezzi (ad esempio phishing o re-uso della password).</span><span class="sxs-lookup"><span data-stu-id="d32f4-207">This ensures that the user's credentials are not exposed via other means (such as phishing or password re-use).</span></span>

### <a name="using-powershell"></a><span data-ttu-id="d32f4-208">Utilizzo di PowerShell</span><span class="sxs-lookup"><span data-stu-id="d32f4-208">Using PowerShell</span></span>

<span data-ttu-id="d32f4-209">Esistono due cmdlet di PowerShell remoti che è possibile utilizzare per rimuovere o disabilitare le regole pericolose.</span><span class="sxs-lookup"><span data-stu-id="d32f4-209">There are two remote PowerShell cmdlets you can use to remove or disable dangerous rules.</span></span> <span data-ttu-id="d32f4-210">Seguire i passaggi.</span><span class="sxs-lookup"><span data-stu-id="d32f4-210">Just follow the steps.</span></span>

#### <a name="steps-for-mailboxes-that-are-on-an-exchange-server"></a><span data-ttu-id="d32f4-211">Passaggi per le cassette postali presenti in un server Exchange</span><span class="sxs-lookup"><span data-stu-id="d32f4-211">Steps for mailboxes that are on an Exchange server</span></span>

1. <span data-ttu-id="d32f4-212">Connettersi al server Exchange utilizzando Remote PowerShell.</span><span class="sxs-lookup"><span data-stu-id="d32f4-212">Connect to the Exchange server using remote PowerShell.</span></span> <span data-ttu-id="d32f4-213">Seguire i passaggi descritti in [Connettersi ai server Exchange tramite PowerShell remoto.](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-servers-using-remote-powershell)</span><span class="sxs-lookup"><span data-stu-id="d32f4-213">Follow the steps in [Connect to Exchange servers using remote PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-servers-using-remote-powershell).</span></span>

2. <span data-ttu-id="d32f4-214">Se si desidera rimuovere completamente una singola regola, più regole o tutte le regole da una cassetta postale, utilizzare il cmdlet [Remove-InboxRule.](https://docs.microsoft.com/powershell/module/exchange/Remove-InboxRule)</span><span class="sxs-lookup"><span data-stu-id="d32f4-214">If you want to completely remove a single rule, multiple rules, or all rules from a mailbox use the [Remove-InboxRule](https://docs.microsoft.com/powershell/module/exchange/Remove-InboxRule) cmdlet.</span></span>

3. <span data-ttu-id="d32f4-215">Se si desidera mantenere la regola e il relativo contenuto per ulteriori indagini, utilizzare il cmdlet [Disable-InboxRule.](https://docs.microsoft.com/powershell/module/exchange/disable-inboxrule)</span><span class="sxs-lookup"><span data-stu-id="d32f4-215">If you want to retain the rule and its contents for further investigation use the [Disable-InboxRule](https://docs.microsoft.com/powershell/module/exchange/disable-inboxrule) cmdlet.</span></span>

#### <a name="steps-for-mailboxes-in-exchange-online"></a><span data-ttu-id="d32f4-216">Passaggi per le cassette postali in Exchange Online</span><span class="sxs-lookup"><span data-stu-id="d32f4-216">Steps for mailboxes in Exchange Online</span></span>

1. <span data-ttu-id="d32f4-217">Seguire i passaggi descritti in [Connettersi a Exchange Online tramite PowerShell.](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-powershell)</span><span class="sxs-lookup"><span data-stu-id="d32f4-217">Follow the steps in [Connect to Exchange Online using PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-powershell).</span></span>

2. <span data-ttu-id="d32f4-218">Se si desidera rimuovere completamente una singola regola, più regole o tutte le regole da una cassetta postale, utilizzare il cmdlet [Remove-Inbox Rule.](https://docs.microsoft.com/powershell/module/exchange/Remove-InboxRule)</span><span class="sxs-lookup"><span data-stu-id="d32f4-218">If you want to completely remove a single rule, multiple rules, or all rules from a mailbox use the [Remove-Inbox Rule](https://docs.microsoft.com/powershell/module/exchange/Remove-InboxRule) cmdlet.</span></span>

3. <span data-ttu-id="d32f4-219">Se si desidera mantenere la regola e il relativo contenuto per ulteriori indagini, utilizzare il cmdlet [Disable-InboxRule.](https://docs.microsoft.com/powershell/module/exchange/disable-inboxrule)</span><span class="sxs-lookup"><span data-stu-id="d32f4-219">If you want to retain the rule and its contents for further investigation use the [Disable-InboxRule](https://docs.microsoft.com/powershell/module/exchange/disable-inboxrule) cmdlet.</span></span>

## <a name="how-to-minimize-future-attacks"></a><span data-ttu-id="d32f4-220">Come ridurre al minimo gli attacchi futuri</span><span class="sxs-lookup"><span data-stu-id="d32f4-220">How to minimize future attacks</span></span>

### <a name="first-protect-your-accounts"></a><span data-ttu-id="d32f4-221">Prima di tutto: proteggere gli account</span><span class="sxs-lookup"><span data-stu-id="d32f4-221">First: protect your accounts</span></span>

<span data-ttu-id="d32f4-222">Gli exploit regole e moduli vengono usati da un utente malintenzionato solo dopo aver rubato o violato uno degli account dell'utente.</span><span class="sxs-lookup"><span data-stu-id="d32f4-222">The Rules and Forms exploits are only used by an attacker after they have stolen or breached one of your user's accounts.</span></span> <span data-ttu-id="d32f4-223">Pertanto, il primo passaggio per impedire l'uso di questi exploit nell'organizzazione consiste nel proteggere in modo aggressivo gli account utente.</span><span class="sxs-lookup"><span data-stu-id="d32f4-223">So, your first step to preventing the use of these exploits against your organization is to aggressively protect your user accounts.</span></span> <span data-ttu-id="d32f4-224">Alcuni dei modi più comuni in cui vengono violati gli account sono tramite attacchi di phishing [o password spray.](https://www.microsoft.com/security/blog/2020/04/23/protecting-organization-password-spray-attacks/)</span><span class="sxs-lookup"><span data-stu-id="d32f4-224">Some of the most common ways that accounts are breached are through phishing or [password spray attacks](https://www.microsoft.com/security/blog/2020/04/23/protecting-organization-password-spray-attacks/).</span></span>

<span data-ttu-id="d32f4-225">Il modo migliore per proteggere gli account utente, in particolare gli account amministratore, è configurare l'autenticazione a più [fattori per gli utenti.](../../admin/security-and-compliance/set-up-multi-factor-authentication.md)</span><span class="sxs-lookup"><span data-stu-id="d32f4-225">The best way to protect your user accounts, and especially your administrator accounts, is to [set up multi-factor authentication for users](../../admin/security-and-compliance/set-up-multi-factor-authentication.md).</span></span> <span data-ttu-id="d32f4-226">È inoltre consigliabile:</span><span class="sxs-lookup"><span data-stu-id="d32f4-226">You should also:</span></span>

- <span data-ttu-id="d32f4-227">Monitorare la modalità di accesso e utilizzo [degli account utente.](https://docs.microsoft.com/azure/active-directory/active-directory-view-access-usage-reports)</span><span class="sxs-lookup"><span data-stu-id="d32f4-227">Monitor how your user accounts are [accessed and used](https://docs.microsoft.com/azure/active-directory/active-directory-view-access-usage-reports).</span></span> <span data-ttu-id="d32f4-228">Non è possibile impedire la violazione iniziale, ma si ridurrà la durata e l'impatto della violazione rilevandola prima.</span><span class="sxs-lookup"><span data-stu-id="d32f4-228">You may not prevent the initial breach, but you will shorten the duration and the impact of the breach by detecting it sooner.</span></span> <span data-ttu-id="d32f4-229">È possibile usare questi criteri [di Office 365 Cloud App Security](https://docs.microsoft.com/cloud-app-security/what-is-cloud-app-security) per monitorare gli account e avvisare in caso di attività insolite:</span><span class="sxs-lookup"><span data-stu-id="d32f4-229">You can use these [Office 365 Cloud App Security policies](https://docs.microsoft.com/cloud-app-security/what-is-cloud-app-security) to monitor you accounts and alert on unusual activity:</span></span>

  - <span data-ttu-id="d32f4-230">**Più tentativi** di accesso non riusciti: questo criterio consente di profilire l'ambiente e di attivare avvisi quando gli utenti eseguono più attività di accesso non riuscite in una singola sessione rispetto alla linea di base appresa, che potrebbe indicare un tentativo di violazione.</span><span class="sxs-lookup"><span data-stu-id="d32f4-230">**Multiple failed login attempts**: This policy profiles your environment and triggers alerts when users perform multiple failed login activities in a single session with respect to the learned baseline, which could indicate an attempted breach.</span></span>

  - <span data-ttu-id="d32f4-231">**Viaggi impossibili:** questo criterio consente di profilire l'ambiente e di attivare avvisi quando le attività vengono rilevate dallo stesso utente in posizioni diverse in un periodo di tempo inferiore al tempo di viaggio previsto tra le due posizioni.</span><span class="sxs-lookup"><span data-stu-id="d32f4-231">**Impossible travel**: This policy profiles your environment and triggers alerts when activities are detected from the same user in different locations within a time period that is shorter than the expected travel time between the two locations.</span></span> <span data-ttu-id="d32f4-232">Ciò potrebbe indicare che un utente diverso utilizza le stesse credenziali.</span><span class="sxs-lookup"><span data-stu-id="d32f4-232">This could indicate that a different user is using the same credentials.</span></span> <span data-ttu-id="d32f4-233">Il rilevamento di questo comportamento anomalo richiede un periodo di apprendimento iniziale di sette giorni durante il quale apprende il modello di attività di un nuovo utente.</span><span class="sxs-lookup"><span data-stu-id="d32f4-233">Detecting this anomalous behavior necessitates an initial learning period of seven days during which it learns a new user's activity pattern.</span></span>

  - <span data-ttu-id="d32f4-234">**Attività impersonata** insolita (da parte dell'utente): questo criterio consente di profilire l'ambiente e di attivare avvisi quando gli utenti eseguono più attività rappresentate in una singola sessione rispetto alla previsione appresa, che potrebbe indicare un tentativo di violazione.</span><span class="sxs-lookup"><span data-stu-id="d32f4-234">**Unusual impersonated activity (by user)**: This policy profiles your environment and triggers alerts when users perform multiple impersonated activities in a single session with respect to the baseline learned, which could indicate an attempted breach.</span></span>

- <span data-ttu-id="d32f4-235">Usare uno strumento come [Office 365 Secure Score](https://securescore.office.com/) per gestire le configurazioni e i comportamenti di sicurezza degli account.</span><span class="sxs-lookup"><span data-stu-id="d32f4-235">Use a tool like [Office 365 Secure Score](https://securescore.office.com/) to manage account security configurations and behaviors.</span></span>

### <a name="second-keep-your-outlook-clients-current"></a><span data-ttu-id="d32f4-236">Secondo: Mantenere i client Outlook sempre attivi</span><span class="sxs-lookup"><span data-stu-id="d32f4-236">Second: Keep your Outlook clients current</span></span>

<span data-ttu-id="d32f4-237">Le versioni completamente aggiornate e con patch di Outlook 2013 e 2016 disabilitano l'azione regola/modulo "Avvia applicazione" per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="d32f4-237">Fully updated and patched versions of Outlook 2013, and 2016 disable the "Start Application" rule/form action by default.</span></span> <span data-ttu-id="d32f4-238">In questo modo, anche se un utente malintenzionato viola l'account, le azioni della regola e del modulo verranno bloccate.</span><span class="sxs-lookup"><span data-stu-id="d32f4-238">This will ensure that even if an attacker breaches the account, the rule and form actions will be blocked.</span></span> <span data-ttu-id="d32f4-239">È possibile installare gli aggiornamenti e le patch di sicurezza più recenti seguendo la procedura descritta in [Installare gli aggiornamenti di Office.](https://support.microsoft.com/office/2ab296f3-7f03-43a2-8e50-46de917611c5)</span><span class="sxs-lookup"><span data-stu-id="d32f4-239">You can install the latest updates and security patches by following the steps in [Install Office updates](https://support.microsoft.com/office/2ab296f3-7f03-43a2-8e50-46de917611c5).</span></span>

<span data-ttu-id="d32f4-240">Ecco le versioni delle patch per i client Outlook 2013 e 2016:</span><span class="sxs-lookup"><span data-stu-id="d32f4-240">Here are the patch versions for your Outlook 2013 and 2016 clients:</span></span>

- <span data-ttu-id="d32f4-241">**Outlook 2016**: 16.0.4534.1001 o versione successiva.</span><span class="sxs-lookup"><span data-stu-id="d32f4-241">**Outlook 2016**: 16.0.4534.1001 or greater.</span></span>

- <span data-ttu-id="d32f4-242">**Outlook 2013**: 15.0.4937.1000 o versione successiva.</span><span class="sxs-lookup"><span data-stu-id="d32f4-242">**Outlook 2013**: 15.0.4937.1000 or greater.</span></span>

<span data-ttu-id="d32f4-243">Per ulteriori informazioni sulle singole patch di sicurezza, vedere:</span><span class="sxs-lookup"><span data-stu-id="d32f4-243">For more information on the individual security patches, see:</span></span>

- [<span data-ttu-id="d32f4-244">Patch di sicurezza di Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="d32f4-244">Outlook 2016 Security Patch</span></span>](https://support.microsoft.com/help/3191883)

- [<span data-ttu-id="d32f4-245">Patch di protezione di Outlook 2013</span><span class="sxs-lookup"><span data-stu-id="d32f4-245">Outlook 2013 Security Patch</span></span>](https://support.microsoft.com/help/3191938)

### <a name="third-monitor-your-outlook-clients"></a><span data-ttu-id="d32f4-246">Terzo: monitorare i client Outlook</span><span class="sxs-lookup"><span data-stu-id="d32f4-246">Third: Monitor your Outlook clients</span></span>

<span data-ttu-id="d32f4-247">Tieni presente che anche con le patch e gli aggiornamenti installati, è possibile che un utente malintenzionato modifini la configurazione del computer locale per abilitare nuovamente il comportamento "Avvia applicazione".</span><span class="sxs-lookup"><span data-stu-id="d32f4-247">Note that even with the patches and updates installed, it is possible for an attacker to change the local machine configuration to re-enable the "Start Application" behavior.</span></span> <span data-ttu-id="d32f4-248">È possibile utilizzare [Gestione avanzata Criteri di gruppo](https://docs.microsoft.com/microsoft-desktop-optimization-pack/agpm/) per monitorare e applicare i criteri del computer locale ai client.</span><span class="sxs-lookup"><span data-stu-id="d32f4-248">You can use [Advanced Group Policy Management](https://docs.microsoft.com/microsoft-desktop-optimization-pack/agpm/) to monitor and enforce local machine policies on your clients.</span></span>

<span data-ttu-id="d32f4-249">Puoi vedere se "Avvia applicazione" è stato ri-abilitato tramite un override nel Registro di sistema usando le informazioni in Come visualizzare il Registro di sistema usando le versioni a [64 bit di Windows.](https://support.microsoft.com/help/305097)</span><span class="sxs-lookup"><span data-stu-id="d32f4-249">You can see if "Start Application" has been re-enabled through an override in the registry by using the information in [How to view the system registry by using 64-bit versions of Windows](https://support.microsoft.com/help/305097).</span></span> <span data-ttu-id="d32f4-250">Controllare queste sottochiavi:</span><span class="sxs-lookup"><span data-stu-id="d32f4-250">Check these subkeys:</span></span>

- <span data-ttu-id="d32f4-251">**Outlook 2016:**`HKEY_CURRENT_USER\Software\Microsoft\Office\16.0\Outlook\Security\`</span><span class="sxs-lookup"><span data-stu-id="d32f4-251">**Outlook 2016**: `HKEY_CURRENT_USER\Software\Microsoft\Office\16.0\Outlook\Security\`</span></span>

- <span data-ttu-id="d32f4-252">**Outlook 2013:**`HKEY_CURRENT_USER\Software\Microsoft\Office\15.0\Outlook\Security\`</span><span class="sxs-lookup"><span data-stu-id="d32f4-252">**Outlook 2013**: `HKEY_CURRENT_USER\Software\Microsoft\Office\15.0\Outlook\Security\`</span></span>

<span data-ttu-id="d32f4-253">Cercare la chiave EnableUnsafeClientMailRules.</span><span class="sxs-lookup"><span data-stu-id="d32f4-253">Look for the key EnableUnsafeClientMailRules.</span></span> <span data-ttu-id="d32f4-254">Se è presente ed è impostato su 1, la patch di sicurezza di Outlook è stata ignorata e il computer è vulnerabile all'attacco modulo/regole.</span><span class="sxs-lookup"><span data-stu-id="d32f4-254">If it is there and is set to 1, the Outlook security patch has been overridden and the computer is vulnerable to the Form/Rules attack.</span></span> <span data-ttu-id="d32f4-255">Se il valore è 0, l'azione "Avvia applicazione" viene disabilitata.</span><span class="sxs-lookup"><span data-stu-id="d32f4-255">If the value is 0, the "Start Application" action is disabled.</span></span> <span data-ttu-id="d32f4-256">Se è installata la versione aggiornata e con patch di Outlook e questa chiave del Registro di sistema non è presente, un sistema non è vulnerabile a questi attacchi.</span><span class="sxs-lookup"><span data-stu-id="d32f4-256">If the updated and patched version of Outlook is installed and this registry key is not present, then a system is not vulnerable to these attacks.</span></span>

<span data-ttu-id="d32f4-257">I clienti con installazioni exchange locali devono prendere in considerazione la possibilità di bloccare le versioni precedenti di Outlook in cui non sono disponibili patch.</span><span class="sxs-lookup"><span data-stu-id="d32f4-257">Customers with on-premises Exchange installations should consider blocking older versions of Outlook that do not have patches available.</span></span> <span data-ttu-id="d32f4-258">Per informazioni dettagliate su questo processo, vedere l'articolo [Configure Outlook client blocking.](https://docs.microsoft.com/exchange/configure-outlook-client-blocking-exchange-2013-help)</span><span class="sxs-lookup"><span data-stu-id="d32f4-258">Details on this process can be found in the article [Configure Outlook client blocking](https://docs.microsoft.com/exchange/configure-outlook-client-blocking-exchange-2013-help).</span></span>

## <a name="secure-microsoft-365-like-a-cybersecurity-pro"></a><span data-ttu-id="d32f4-259">Proteggere Microsoft 365 come un professionista della sicurezza informatica</span><span class="sxs-lookup"><span data-stu-id="d32f4-259">Secure Microsoft 365 like a cybersecurity pro</span></span>

<span data-ttu-id="d32f4-260">L'abbonamento a Microsoft 365 include un potente set di funzionalità di protezione che consente di proteggere i propri dati e quelli degli altri utenti.</span><span class="sxs-lookup"><span data-stu-id="d32f4-260">Your Microsoft 365 subscription comes with a powerful set of security capabilities that you can use to protect your data and your users.</span></span> <span data-ttu-id="d32f4-261">Usare la [Roadmap della sicurezza di Microsoft 365: principali priorità per i primi 30 giorni, 90 giorni e oltre](security-roadmap.md) per implementare le procedure consigliate da Microsoft per proteggere il tenant di Microsoft 365.</span><span class="sxs-lookup"><span data-stu-id="d32f4-261">Use the [Microsoft 365 security roadmap - Top priorities for the first 30 days, 90 days, and beyond](security-roadmap.md) to implement Microsoft recommended best practices for securing your Microsoft 365 tenant.</span></span>

- <span data-ttu-id="d32f4-262">Attività da eseguire i primi 30 giorni.</span><span class="sxs-lookup"><span data-stu-id="d32f4-262">Tasks to accomplish in the first 30 days.</span></span> <span data-ttu-id="d32f4-263">Hanno un effetto immediato e hanno un impatto basso sugli utenti.</span><span class="sxs-lookup"><span data-stu-id="d32f4-263">These have immediate effect and are low-impact to your users.</span></span>

- <span data-ttu-id="d32f4-264">Attività da completare in 90 giorni.</span><span class="sxs-lookup"><span data-stu-id="d32f4-264">Tasks to accomplish in 90 days.</span></span> <span data-ttu-id="d32f4-265">Queste attività richiedono una quantità di tempo leggermente superiore per la pianificazione e l'implementazione, ma aumentano notevolmente il livello di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="d32f4-265">These take a bit more time to plan and implement but greatly improve your security posture.</span></span>

- <span data-ttu-id="d32f4-266">Dopo 90 giorni.</span><span class="sxs-lookup"><span data-stu-id="d32f4-266">Beyond 90 days.</span></span> <span data-ttu-id="d32f4-267">Questi miglioramenti si instaurano nei primi 90 giorni di lavoro effettuato.</span><span class="sxs-lookup"><span data-stu-id="d32f4-267">These enhancements build in your first 90 days work.</span></span>

## <a name="see-also"></a><span data-ttu-id="d32f4-268">Vedere anche:</span><span class="sxs-lookup"><span data-stu-id="d32f4-268">See also:</span></span>

- <span data-ttu-id="d32f4-269">[Malicious Outlook Rules](https://silentbreaksecurity.com/malicious-outlook-rules/) by SilentBreak Security Post about Rules Vector fornisce una revisione dettagliata del modo in cui le regole di Outlook.</span><span class="sxs-lookup"><span data-stu-id="d32f4-269">[Malicious Outlook Rules](https://silentbreaksecurity.com/malicious-outlook-rules/) by SilentBreak Security Post about Rules Vector provides a detailed review of how the Outlook Rules.</span></span>

- <span data-ttu-id="d32f4-270">[MAPI su HTTP e Mailrule Pwnage](https://sensepost.com/blog/2016/mapi-over-http-and-mailrule-pwnage/) nel blog Sensepost su Mailrule Pwnage illustra uno strumento denominato Ruler che consente di sfruttare le cassette postali tramite le regole di Outlook.</span><span class="sxs-lookup"><span data-stu-id="d32f4-270">[MAPI over HTTP and Mailrule Pwnage](https://sensepost.com/blog/2016/mapi-over-http-and-mailrule-pwnage/) on the Sensepost blog about Mailrule Pwnage discusses a tool called Ruler that lets you exploit mailboxes through Outlook rules.</span></span>

- <span data-ttu-id="d32f4-271">[Moduli e shell di Outlook nel](https://sensepost.com/blog/2017/outlook-forms-and-shells/) blog Sensepost su Forms Threat Vector.</span><span class="sxs-lookup"><span data-stu-id="d32f4-271">[Outlook forms and shells](https://sensepost.com/blog/2017/outlook-forms-and-shells/) on the Sensepost blog about Forms Threat Vector.</span></span>

- [<span data-ttu-id="d32f4-272">Codebase righello</span><span class="sxs-lookup"><span data-stu-id="d32f4-272">Ruler Codebase</span></span>](https://github.com/sensepost/ruler)

- [<span data-ttu-id="d32f4-273">Indicatori di compromissione dei righelli</span><span class="sxs-lookup"><span data-stu-id="d32f4-273">Ruler Indicators of Compromise</span></span>](https://github.com/sensepost/notruler/blob/master/iocs.md)
