---
title: Configurazione dei criteri anti-malware
f1.keywords:
- NOCSH
ms.author: chrisda
author: chrisda
manager: dansimp
ms.date: ''
audience: ITPro
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
ms.assetid: b0cfc21f-e3c6-41b6-8670-feb2b2e252e5
ms.collection:
- M365-security-compliance
description: Gli amministratori possono ottenere informazioni su come visualizzare, creare, modificare e rimuovere i criteri anti-malware in Exchange Online Protection (EOP).
ms.custom: seo-marvel-apr2020
ms.openlocfilehash: 4c5ed51a4bf7ace0fbbe901170c78c93f1b7b670
ms.sourcegitcommit: 73b2426001dc5a3f4b857366ef51e877db549098
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 06/09/2020
ms.locfileid: "44616711"
---
# <a name="configure-anti-malware-policies-in-eop"></a>Configurazione dei criteri anti-malware in EOP

In Microsoft 365 organizzazioni con cassette postali in Exchange Online o standalone Exchange Online Protection (EOP) organizzazioni senza cassette postali di Exchange Online, i messaggi di posta elettronica vengono protetti automaticamente da malware da EOP. EOP utilizza criteri anti-malware per le impostazioni di protezione antimalware. Per ulteriori informazioni, vedere [anti-malware Protection](anti-malware-protection.md).

Gli amministratori possono visualizzare, modificare e configurare (ma non eliminare) il criterio antimalware predefinito per soddisfare le esigenze delle organizzazioni. Per una maggiore granularità, è anche possibile creare criteri anti-malware personalizzati che si applicano a utenti, gruppi o domini specifici nell'organizzazione. I criteri personalizzati hanno sempre la precedenza sul criterio predefinito, ma non è possibile modificarne la priorità (in funzione).

È possibile configurare i criteri anti-malware nel centro sicurezza & Compliance o in PowerShell (Exchange Online PowerShell per Microsoft 365 organizzazioni con cassette postali in Exchange Online; standalone EOP PowerShell per organizzazioni senza cassette postali di Exchange Online).

## <a name="what-do-you-need-to-know-before-you-begin"></a>Che cosa è necessario sapere prima di iniziare

- Aprire il Centro sicurezza e conformità in <https://protection.office.com/>. Per passare direttamente alla pagina **anti-malware** , utilizzare <https://protection.office.com/antimalware> .

- Per informazioni su come connettersi a PowerShell per Exchange Online, vedere [Connettersi a PowerShell per Exchange Online](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-powershell). Per connettersi a PowerShell di EOP autonomo, vedere [Connettersi a PowerShell per Exchange Online Protection](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-protection-powershell).

- È necessario disporre delle autorizzazioni prima di poter eseguire queste procedure. Per aggiungere, modificare ed eliminare i criteri anti-malware, è necessario essere membri dei gruppi di ruoli **Gestione organizzazione** o **amministratore sicurezza** . Per l'accesso in sola lettura ai criteri anti-malware, è necessario essere membri del gruppo di ruoli **lettore di sicurezza** . Per altre informazioni sui gruppi di ruoli nel Centro sicurezza e conformità, vedere [Autorizzazioni nel Centro sicurezza e conformità](permissions-in-the-security-and-compliance-center.md).

- Per le impostazioni consigliate per i criteri anti-malware, vedere [EOP anti-malware Policy Settings](recommended-settings-for-eop-and-office365-atp.md#eop-anti-malware-policy-settings).

## <a name="use-the-security--compliance-center-to-create-anti-malware-policies"></a>Utilizzare il Centro sicurezza & conformità per creare criteri anti-malware

La creazione di un criterio antimalware personalizzato nel centro sicurezza & conformità crea la regola di filtro antimalware e il criterio di filtro antimalware associato contemporaneamente utilizzando lo stesso nome per entrambi.

1. Nel centro sicurezza & conformità, accedere a **Threat management** \> **Policy** \> **anti-malware**criteri di gestione e quindi fare clic su **nuova** ![ icona Aggiungi ](../../media/ITPro-EAC-AddIcon.png) .

2. Nella pagina **nuovo criterio anti-malware** che si apre, configurare queste impostazioni:

   - **Nome**: immettere un nome univoco descrittivo per il criterio.

   - **Descrizione**: immettere una descrizione opzionale per il criterio.

   - **Risposta di rilevamento malware**: selezionare uno di questi valori per i **destinatari che si desidera inviare al messaggio se i messaggi sono messi in quarantena** :

     - **No**: il messaggio viene messo in quarantena senza alcuna notifica ai destinatari previsti. Questo è il valore predefinito.

     - **Sì e utilizzare il testo di notifica predefinito**: il messaggio viene messo in quarantena. Una copia del messaggio viene recapitata ai destinatari, ma *tutti* gli allegati (non solo quelli rilevati) vengono sostituiti con un singolo file di testo denominato **Malware Alert text. txt** che contiene il testo predefinito. Per il testo predefinito, vedere [anti-malware Policies](anti-malware-protection.md#anti-malware-policies).

     - **Sì e utilizzare il testo di notifica personalizzato**: il messaggio viene messo in quarantena. Una copia del messaggio viene recapitata ai destinatari, ma *tutti* gli allegati (non solo quelli rilevati) vengono sostituiti con un singolo file di testo denominato **Malware Alert text. txt** contenente il testo personalizzato specificato nella casella di **testo avviso personalizzato** .

   - **Filtro dei tipi di allegati comuni**: selezionare uno di questi valori per **bloccare i tipi di allegati che possono danneggiare il computer.**:

     - **Off**

     - **On**: i messaggi con gli allegati specificati vengono considerati come rilevamenti di malware e vengono automaticamente messi in quarantena. È possibile modificare l'elenco Bu facendo clic sui pulsanti **Aggiungi** e **Rimuovi** .

   - **Malware zero-hour auto Purge**: il malware zap mette in quarantena i messaggi che sono già stati recapitati. Per ulteriori informazioni, vedere [zero-hour auto Purge (ZAP) in Exchange Online](zero-hour-auto-purge.md). Selezionare uno dei seguenti valori:

     - **Off**

     - **Attiva (scelta consigliata)**

   - **Notifica**: le impostazioni di questa sezione controllano le notifiche di mittente e amministratore quando viene rilevato malware in un messaggio.

     - **Notifiche mittente**: selezionare una o entrambe le opzioni seguenti:

       - **Notify Internal Senders**: un mittente interno è all'interno dell'organizzazione.

       - **Notifica mittenti esterni**: un mittente esterno è esterno all'organizzazione.

     - **Notifiche dell'amministratore**: selezionare una o entrambe le opzioni seguenti:

       - **Informare l'amministratore sui messaggi non recapitati da mittenti interni**: se si seleziona questa opzione, immettere un indirizzo di posta elettronica di notifica nella casella **indirizzo di posta elettronica dell'amministratore** .

       - **Informare l'amministratore sui messaggi non recapitati da mittenti esterni**: se si seleziona questa opzione, immettere un indirizzo di posta elettronica di notifica nella casella **indirizzo di posta elettronica dell'amministratore** .

     - **Personalizza notifiche**: queste impostazioni sostituiscono il testo di notifica predefinito utilizzato per i mittenti o gli amministratori. Per ulteriori informazioni sui valori predefiniti, vedere [anti-malware Policies](anti-malware-protection.md#anti-malware-policies).

       - **Utilizzare il testo di notifica personalizzato**: se si seleziona questa opzione, è necessario utilizzare le caselle **nome** e **Indirizzo** da per specificare il nome e l'indirizzo di posta elettronica del mittente utilizzati nel messaggio di notifica personalizzato.

       - **Messaggi provenienti da mittenti interni**: se si è scelto di inviare notifiche ai mittenti o agli amministratori sui messaggi non recapitabili provenienti da mittenti interni, è necessario utilizzare l' **oggetto** e le finestre di **messaggio** per specificare l'oggetto e il corpo del messaggio di notifica personalizzato.

       - **Messaggi provenienti da mittenti esterni**: se si è scelto di informare i mittenti o gli amministratori sui messaggi non recapitabili provenienti da mittenti esterni, è necessario utilizzare le caselle **oggetto** e **messaggio** per specificare l'oggetto e il corpo del messaggio di notifica personalizzato.

   - **Applicato a**: le impostazioni di questa sezione identificano i destinatari interni ai quali si applica il criterio.

     - **Se**: fare clic sul menu a discesa **Seleziona un altro** e selezionare le condizioni per la regola:

       - **Il destinatario è**: consente di specificare una o più cassette postali, utenti di posta elettronica o contatti di posta nell'organizzazione. Nella finestra di dialogo **Seleziona membri** visualizzata, selezionare uno o più destinatari dall'elenco, quindi fare clic su ** \> Aggiungi**. Nella casella **Controlla nomi** , è possibile utilizzare i caratteri jolly per più indirizzi di posta elettronica (ad esempio: \* @fabrikam. com). Al termine, fare clic su **OK**.

       - **Il dominio del destinatario è**: consente di specificare i destinatari in uno o più dei domini accettati configurati nell'organizzazione. Nella finestra di dialogo che viene visualizzata, selezionare uno o più domini, quindi fare clic su **Aggiungi \> **. Al termine, fare clic su **OK**.

       - **Il destinatario è un membro di**: consente di specificare uno o più gruppi nell'organizzazione. Nella finestra di dialogo **Seleziona membri** visualizzata, selezionare uno o più gruppi nell'elenco e quindi fare clic su ** \> Aggiungi**. Al termine, fare clic su **OK**.

     È possibile utilizzare una sola condizione una sola volta, ma è possibile specificare più valori per la condizione. Più valori della stessa condizione di utilizzo o logica (ad esempio, _\<recipient1\>_ o _\<recipient2\>_ ). Condizioni di utilizzo e logica diverse (ad esempio, _\<recipient1\>_ e _\<member of group 1\>_ ). Per aggiungere ulteriori condizioni, selezionare **Aggiungi condizione** ed effettuare la selezione tra le opzioni rimanenti.

     - **Eccetto se**: per aggiungere eccezioni per la regola, fare clic su **Aggiungi eccezione**, fare clic sul menu a discesa **Seleziona un altro** e configurare le eccezioni. Impostazioni e comportamento sono equivalenti alle condizioni.

3. Al termine, scegliere **Salva**.

## <a name="use-the-security--compliance-center-to-view-anti-malware-policies"></a>Utilizzare il Centro sicurezza & conformità per visualizzare i criteri anti-malware

1. Nel centro sicurezza & conformità, accedere a criteri di **gestione delle minacce** \> **Policy** \> **anti-malware**.

2. Quando si seleziona un filtro, informazioni sul filtro vengono visualizzate nel riquadro dettagli. Per ulteriori informazioni sul criterio, fare clic su **modifica** ![ icona modifica ](../../media/ITPro-EAC-EditIcon.png) .

   - Il valore della proprietà **Enabled**, il valore della proprietà **Priority** e le impostazioni della scheda **Applicato a** sono presenti nella regola di filtro antimalware.

   - Le impostazioni sulle schede **Generale** e **Impostazioni** sono presenti nel criterio di filtro antimalware.

## <a name="use-the-security--compliance-center-to-modify-anti-malware-policies"></a>Utilizzare il Centro sicurezza & conformità per modificare i criteri anti-malware

1. Nel centro sicurezza & conformità, accedere a criteri di **gestione delle minacce** \> **Policy** \> **anti-malware**.

2. Selezionare il criterio, quindi fare clic su **modifica** ![ icona modifica ](../../media/ITPro-EAC-EditIcon.png) . Per informazioni sulle impostazioni, vedere la sezione [use the Security & Compliance Center to create anti-malware Policies](#use-the-security--compliance-center-to-create-anti-malware-policies) in this topic.

   **Note**:

   - Le impostazioni non sono tutte presenti sulla stessa pagina, ma sono suddivise tra le schede **Generale**, **Impostazioni** e **Applicato a**. La scheda **applicato a** non è disponibile nel criterio predefinito denominato default (che viene applicato automaticamente a tutti gli utenti).

   - Non è possibile rinominare il criterio predefinito.

## <a name="use-the-security--compliance-center-to-enable-or-disable-anti-malware-policies"></a>Utilizzare il Centro sicurezza & conformità per abilitare o disabilitare i criteri anti-malware

1. Nel centro sicurezza & conformità, accedere a criteri di **gestione delle minacce** \> **Policy** \> **anti-malware**.

2. Selezionare il criterio dall'elenco e quindi configurare una delle opzioni seguenti:

   - **Disabilitare il criterio**: deselezionare la casella di controllo nella colonna **Enabled** . Per impostazione predefinita, i criteri anti-malware sono abilitati quando vengono creati nel centro sicurezza & conformità.

   - **Attiva il criterio**: selezionare la casella di controllo nella colonna **Enabled** .

## <a name="use-the-security--compliance-center-to-set-the-priority-of-custom-anti-malware-policies"></a>Utilizzare il Centro sicurezza & conformità per impostare la priorità dei criteri anti-malware personalizzati

Per impostazione predefinita, ai criteri antimalware viene assegnata una priorità che si basa sull'ordine in cui sono stati creati (le nuove polizie sono più basse rispetto ai criteri precedenti). Un valore di priorità inferiore indica una priorità più alta per il criterio e i criteri vengono elaborati nell'ordine di priorità (i criteri con priorità più elevata vengono elaborati prima di quelli con priorità più bassa). Due criteri non possono avere priorità uguale.

 **Note**:

- Nel centro sicurezza & conformità è possibile modificare solo la priorità del criterio antimalware dopo averlo creato. In PowerShell, è possibile ignorare la priorità predefinita quando si crea la regola di filtro antimalware (che può influire sulla priorità delle regole esistenti).

- Nel centro sicurezza & conformità, i criteri anti-malware vengono elaborati nell'ordine in cui vengono visualizzati (il primo criterio ha il valore di **priorità** 0). Il criterio antimalware predefinito denominato default ha il valore di priorità **più basso**e non è possibile modificarlo.

Per modificare la priorità di un criterio, spostare il criterio più in alto o più in basso nell'elenco (non è possibile modificare direttamente il numero **Priority** nel Centro sicurezza e conformità).

1. Nel centro sicurezza & conformità, accedere a criteri di **gestione delle minacce** \> **Policy** \> **anti-malware**.

2. Selezionare un criterio, quindi fare clic su **Sposta su** verso l'alto o su freccia verso il basso ![ ](../../media/ITPro-EAC-UpArrowIcon.png) **Move down** ![ ](../../media/ITPro-EAC-DownArrowIcon.png) per spostare la regola verso l'alto o verso il basso nell'elenco.

## <a name="use-the-security--compliance-center-to-remove-anti-malware-policies"></a>Utilizzare il Centro sicurezza & conformità per rimuovere i criteri anti-malware

Quando si utilizza il Centro sicurezza & conformità per rimuovere un criterio antimalware, la regola di filtro antimalware e i criteri di filtro antimalware corrispondenti vengono entrambi eliminati.

1. Nel centro sicurezza & conformità, accedere a criteri di **gestione delle minacce** \> **Policy** \> **anti-malware**.

2. Selezionare il criterio antimalware che si desidera rimuovere dall'elenco, quindi fare clic su **Elimina** ![ icona di eliminazione ](../../media/ITPro-EAC-DeleteIcon.png) .

## <a name="use-exchange-online-powershell-or-standalone-eop-powershell-to-configure-anti-malware-policies"></a>Utilizzo di PowerShell di Exchange Online o standalone EOP PowerShell per configurare i criteri anti-malware

### <a name="use-powershell-to-create-anti-malware-policies"></a>Utilizzo di PowerShell per creare criteri anti-malware

La creazione di un criterio antimalware in PowerShell è un processo in due passaggi:

1. Creare il criterio del filtro antimalware.

2. Creare la regola del filtro antimalware che identifica il criterio del filtro antimalware cui viene applicata la regola.

 **Note**:

- È possibile creare una nuova regola di filtro antimalware e assegnare un criterio di filtro antimalware esistente e non associato. Non è possibile associare una regola di filtro antimalware a più di un criterio di filtro antimalware.

- Sono disponibili due impostazioni che è possibile configurare sui nuovi criteri antimalware in PowerShell che non sono presenti nel centro sicurezza & conformità fino a dopo la creazione del criterio:

  - Creare il nuovo criterio come disabilitato (_attivato_ `$false` nel cmdlet **New-MalwareFilterRule** ).

  - Impostare la priorità del criterio durante la creazione (_priorità_ _\<Number\>_ ) del cmdlet **New-MalwareFilterRule** .

- Un nuovo criterio di filtro antimalware creato in PowerShell non è visibile nel centro sicurezza & conformità fino a quando non si assegna il criterio a una regola di filtro antimalware.

#### <a name="step-1-use-powershell-to-create-a-malware-filter-policy"></a>Passaggio 1: utilizzare PowerShell per creare un criterio di filtro antimalware

**Nota**: in EOP, i valori dei parametri di _azione_ `DeleteMessage` `DeleteAttachmentAndUseDefaultAlert` e `DeleteAttachmentAndUseCustomAlert` non eliminano i messaggi. I messaggi vengono invece messi in quarantena. Per ulteriori informazioni sul recupero dei messaggi in quarantena, vedere [gestire i messaggi e i file in quarantena come amministratore in EOP](manage-quarantined-messages-and-files.md).

Per creare un criterio di filtro di antimalware, utilizzare questa sintassi:

```PowerShell
New-MalwareFilterPolicy -Name "<PolicyName>" [-Action <DeleteMessage | DeleteAttachmentAndUseDefaultAlert | DeleteAttachmentAndUseCustomAlert>] [-AdminDisplayName "<OptionalComments>"] [-CustomNotifications <$true | $false>] [<Inbound notification options>] [<Outbound notification options>]
```

Con questo esempio viene creato un nuovo criterio per il filtro antimalware denominato Contoso Malware Filter Policy con queste impostazioni:

- Mettere in quarantena i messaggi che contengono malware senza inviare notifiche ai destinatari (non si utilizza il parametro _Action_ e il valore predefinito è `DeleteMessage` ).

- Non notificare al mittente il messaggio quando viene rilevato malware nel messaggio (non si utilizzano i parametri _EnableExternalSenderNotifications_ o _EnableInternalSenderNotifications_ e il valore predefinito per entrambi è `$false` ).

- Notifica all'amministratore admin@contoso.com quando viene rilevato malware in un messaggio proveniente da un mittente interno.

```PowerShell
New-MalwareFilterPolicy -Name "Contoso Malware Filter Policy" -EnableInternalSenderAdminNotifications $true -InternalSenderAdminAddress admin@contoso.com
```

Per informazioni dettagliate sulla sintassi e sui parametri, vedere [New-MalwareFilterPolicy](https://docs.microsoft.com/powershell/module/exchange/new-malwarefilterpolicy).

#### <a name="step-2-use-powershell-to-create-a-malware-filter-rule"></a>Passaggio 2: utilizzare PowerShell per creare una regola di filtro antimalware

Per creare una regola di filtro di antimalware, utilizzare questa sintassi:

```PowerShell
New-MalwareFilterRule -Name "<RuleName>" -MalwareFilterPolicy "<PolicyName>" <Recipient filters> [<Recipient filter exceptions>] [-Comments "<OptionalComments>"]
```

Questo esempio crea una nuova regola di filtro malware denominata Contoso Recipients con queste impostazioni:

- Il criterio di filtro antimalware denominato Contoso Malware Filter Policy viene associato alla regola.

- La regola si applica ai destinatari nel dominio contoso.com.

```PowerShell
New-MalwareFilterRule -Name "Contoso Recipients" -MalwareFilterPolicy "Contoso Malware Filter Policy" -RecipientDomainIs contoso.com
```

Per informazioni dettagliate sulla sintassi e sui parametri, vedere [New-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/new-malwarefilterrule).

### <a name="use-powershell-to-view-malware-filter-policies"></a>Utilizzo di PowerShell per visualizzare i criteri di filtro antimalware

Per visualizzare un elenco riepilogativo di tutti i criteri di filtro antimalware, eseguire questo comando:

```PowerShell
Get-MalwareFilterPolicy
```

Per visualizzare informazioni dettagliate su un criterio di filtro antimalware specifico, utilizzare questa sintassi:

```PowerShell
Get-MalwareFilterPolicy -Identity "<PolicyName>" | Format-List [<Specific properties to view>]
```

In questo esempio vengono visualizzati tutti i valori delle proprietà per il criterio di filtro antimalware denominato Executives.

```PowerShell
Get-MalwareFilterPolicy -Identity "Executives" | Format-List
```

In questo esempio vengono visualizzate solo le proprietà specificate per lo stesso criterio.

```PowerShell
Get-MalwareFilterPolicy -Identity "Executives" | Format-List Action,AdminDisplayName,CustomNotifications,Enable*Notifications
```

Per informazioni dettagliate sulla sintassi e sui parametri, vedere [Get-MalwareFilterPolicy](https://docs.microsoft.com/powershell/module/exchange/get-malwarefilterpolicy).

### <a name="use-powershell-to-view-malware-filter-rules"></a>Utilizzo di PowerShell per visualizzare le regole di filtro antimalware

Per visualizzare un elenco riepilogativo di tutte le regole di filtro antimalware, eseguire questo comando:

```PowerShell
Get-MalwareFilterRule
```

Per filtrare l'elenco in base alle regole abilitate o disabilitate, eseguire i comandi seguenti:

```PowerShell
Get-HostedContentFilterRule -State Disabled
```

```PowerShell
Get-HostedContentFilterRule -State Enabled
```

Per visualizzare informazioni dettagliate su una regola di filtro antimalware specifica, utilizzare questa sintassi:

```PowerShell
Get-MalwareFilterRule -Identity "<RuleName>" | Format-List [<Specific properties to view>]
```

In questo esempio vengono visualizzati tutti i valori delle proprietà per la regola di filtro antimalware denominata Executives.

```PowerShell
Get-MalwareFilterRule -Identity "Executives" | Format-List
```

In questo esempio vengono visualizzate solo le proprietà specificate per la stessa regola.

```PowerShell
Get-MalwareFilterRule -Identity "Executives" | Format-List Name,Priority,State,MalwareFilterPolicy,*Is,*SentTo,*MemberOf
```

Per informazioni dettagliate sulla sintassi e sui parametri, vedere [Get-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/get-malwarefilterrule).

### <a name="use-powershell-to-modify-malware-filter-policies"></a>Utilizzo di PowerShell per modificare i criteri di filtro antimalware

A parte gli elementi seguenti, sono disponibili le stesse impostazioni quando si modifica un criterio di filtro antimalware in PowerShell come quando si crea il criterio come descritto nel [passaggio 1: utilizzare PowerShell per creare una sezione dei criteri di filtro antimalware](#step-1-use-powershell-to-create-a-malware-filter-policy) in questo argomento.

- L'opzione _MakeDefault_ che trasforma il criterio specificato nel criterio predefinito (applicato a tutti gli utenti, la priorità **più bassa** immodificabile e non è possibile eliminarla) è disponibile solo quando si modifica un criterio di filtro antimalware in PowerShell.

- Non è possibile rinominare un criterio di filtro antimalware (il cmdlet **set-MalwareFilterPolicy** non ha un parametro _Name_ ). Quando si rinomina un criterio antimalware nel centro sicurezza & Compliance, si sta solo rinominando la _regola_di filtro antimalware.

Per modificare un criterio di filtro di antimalware, utilizzare questa sintassi:

```PowerShell
Set-MalwareFilterPolicy -Identity "<PolicyName>" <Settings>
```

Per informazioni dettagliate sulla sintassi e sui parametri, vedere [Set-MalwareFilterPolicy](https://docs.microsoft.com/powershell/module/exchange/set-malwarefilterpolicy).

### <a name="use-powershell-to-modify-malware-filter-rules"></a>Utilizzo di PowerShell per modificare le regole di filtro antimalware

L'unica impostazione che non è disponibile quando si modifica una regola di filtro antimalware in PowerShell è il parametro _Enabled_ che consente di creare una regola disattivata. Per abilitare o disabilitare le regole di filtro antimalware esistenti, vedere la sezione successiva.

In caso contrario, non sono disponibili altre impostazioni quando si modifica una regola di filtro antimalware in PowerShell. Le stesse impostazioni sono disponibili quando si crea una regola come descritto nel [passaggio 2: utilizzare PowerShell per creare una regola di filtro antimalware](#step-2-use-powershell-to-create-a-malware-filter-rule) descritta in precedenza in questo argomento.

Per modificare una regola di filtro di antimalware, utilizzare questa sintassi:

```PowerShell
Set-MalwareFilterRule -Identity "<RuleName>" <Settings>
```

Per informazioni dettagliate sulla sintassi e sui parametri, vedere [Set-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/set-malwarefilterrule).

### <a name="use-powershell-to-enable-or-disable-malware-filter-rules"></a>Utilizzo di PowerShell per abilitare o disabilitare le regole di filtro antimalware

L'abilitazione o disabilitazione di una regola di filtro antimalware in PowerShell attiva o disattiva l'intero criterio antimalware (la regola di filtro antimalware e il criterio di filtro antimalware assegnato). Non è possibile abilitare o disabilitare il criterio antimalware predefinito (viene sempre applicato sempre a tutti i destinatari).

Per abilitare o disabilitare una regola di filtro antimalware in PowerShell, utilizzare la sintassi seguente:

```PowerShell
<Enable-MalwareFilterRule | Disable-MalwareFilterRule> -Identity "<RuleName>"
```

In questo esempio viene disabilitata la regola di filtro antimalware denominata Marketing Department.

```PowerShell
Disable-MalwareFilterRule -Identity "Marketing Department"
```

In questo esempio viene abilitata la stessa regola.

```PowerShell
Enable-MalwareFilterRule -Identity "Marketing Department"
```

Per informazioni dettagliate sulla sintassi e sui parametri, vedere [Enable-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/enable-malwarefilterrule) e [Disable-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/disable-malwarefilterrule).

### <a name="use-powershell-to-set-the-priority-of-malware-filter-rules"></a>Utilizzo di PowerShell per impostare la priorità delle regole di filtro antimalware

Il valore di priorità più alto che è possibile impostare in una regola è 0. Il valore più basso che è possibile impostare dipende dal numero di regole. Se si dispone di cinque regole, ad esempio, è possibile utilizzare i valori di priorità da 0 a 4. Modificare la priorità di una regola esistente può avere un effetto a catena su altre regole. Ad esempio, se si dispone di cinque regole personalizzate (priorità da 0 a 4) e si modifica la priorità di una regola su 2, la regola esistente con priorità 2 viene modificata a livello di priorità 3 e la regola con priorità 3 viene modificata a livello di priorità 4.

Per impostare la priorità di una regola di filtro antimalware in PowerShell, utilizzare la sintassi seguente:

```PowerShell
Set-MalwareFilterRule -Identity "<RuleName>" -Priority <Number>
```

Nell'esempio seguente la priorità della regola denominata Marketing Department viene impostata su 2. Tutte le regole esistenti che hanno una priorità minore o uguale a 2 vengono abbassate di 1 valore (i numeri di priorità vengono aumentati di 1).

```PowerShell
Set-MalwareFilterRule -Identity "Marketing Department" -Priority 2
```

**Note**:

- Per impostare la priorità di una nuova regola al momento della creazione, utilizzare il parametro _Priority_ nel cmdlet **New-MalwareFilterRule** .

- Il criterio di filtro antimalware predefinito non dispone di una regola di filtro antimalware corrispondente e ha sempre il valore di priorità immodificabile **più basso**.

### <a name="use-powershell-to-remove-malware-filter-policies"></a>Utilizzo di PowerShell per rimuovere i criteri di filtro antimalware

Quando si utilizza PowerShell per rimuovere un criterio di filtro antimalware, la regola di filtro antimalware corrispondente non viene rimossa.

Per rimuovere un criterio di filtro antimalware in PowerShell, utilizzare la sintassi seguente:

```PowerShell
Remove-MalwareFilterPolicy -Identity "<PolicyName>"
```

In questo esempio viene rimosso il criterio di filtro antimalware denominato Marketing Department.

```PowerShell
Remove-MalwareFilterPolicy -Identity "Marketing Department"
```

Per informazioni dettagliate sulla sintassi e sui parametri, vedere [Remove-MalwareFilterPolicy](https://docs.microsoft.com/powershell/module/exchange/remove-malwarefilterpolicy).

### <a name="use-powershell-to-remove-malware-filter-rules"></a>Utilizzo di PowerShell per rimuovere le regole di filtro antimalware

Quando si utilizza PowerShell per rimuovere una regola di filtro antimalware, il criterio di filtro antimalware corrispondente non viene rimosso.

Per rimuovere una regola di filtro antimalware in PowerShell, utilizzare la sintassi seguente:

```PowerShell
Remove-MalwareFilterRule -Identity "<PolicyName>"
```

In questo esempio viene rimossa la regola di filtro antimalware denominata Marketing Department.

```PowerShell
Remove-MalwareFilterRule -Identity "Marketing Department"
```

Per informazioni dettagliate sulla sintassi e sui parametri, vedere [Remove-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/remove-malwarefilterrule).

## <a name="how-do-you-know-these-procedures-worked"></a>Come verificare se queste procedure hanno avuto esito positivo?

### <a name="use-the-eicartxt-file-to-verify-your-anti-malware-policy-settings"></a>Utilizzare EICAR. File TXT per verificare le impostazioni dei criteri anti-malware

> [!IMPORTANT]
> Il file EICAR.TXT non è un virus. L'European Institute for computer Antivirus Research (EICAR) ha sviluppato questo file per testare in modo sicuro le installazioni e le impostazioni di anti-virus.

1. Aprire il blocco note e incollare il testo seguente in un file vuoto:

   ```Text
   X5O!P%@AP[4\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*
   ```

   Assicurarsi che questi siano gli unici caratteri di testo nel file. Le dimensioni del file devono essere 68 byte.

2. Salvare il file come EICAR. TXT

   Nel programma antivirus desktop, assicurarsi di escludere il EICAR. TXT dall'analisi (in caso contrario, il file verrà messo in quarantena).

3. Inviare un messaggio di posta elettronica contenente il EICAR. File TXT come allegato, utilizzando un client di posta elettronica che non bloccherà automaticamente il file. Utilizzare le impostazioni dei criteri anti-malware per determinare gli scenari seguenti da testare:

   - Posta elettronica da una cassetta postale interna a un destinatario interno.

   - Messaggi di posta elettronica da una cassetta postale interna a un destinatario esterno.

   - Messaggi di posta elettronica da una cassetta postale esterna a un destinatario interno.

4. Verificare che il messaggio sia stato messo in quarantena e verificare i risultati della notifica del destinatario e del mittente in base alle impostazioni dei criteri antimalware. Ad esempio:

   - I destinatari non sono informati o i destinatari ricevono il messaggio originale con EICAR. Allegato TXT sostituito da **Malware Alert text. txt** che contiene il testo predefinito o personalizzato.

   - I mittenti interni o esterni ricevono una notifica con i messaggi di notifica predefiniti o personalizzati.

   - L'indirizzo di posta elettronica di amministrazione specificato viene informato per i mittenti interni o esterni dei messaggi, con i messaggi di notifica predefiniti o personalizzati.

5. Eliminare il EICAR. File TXT dopo il test è stato completato (in modo che gli altri utenti non siano inutilmente allarmati da esso).
