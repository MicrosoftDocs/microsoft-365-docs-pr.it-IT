---
title: Configurazione dei criteri anti-malware
f1.keywords:
- NOCSH
ms.author: chrisda
author: chrisda
manager: dansimp
ms.date: ''
audience: ITPro
ms.topic: how-to
localization_priority: Normal
search.appverid:
- MET150
ms.assetid: b0cfc21f-e3c6-41b6-8670-feb2b2e252e5
ms.collection:
- M365-security-compliance
- m365initiative-defender-office365
description: Gli amministratori possono imparare a visualizzare, creare, modificare e rimuovere i criteri antimalware in Exchange Online Protection (EOP).
ms.custom: seo-marvel-apr2020
ms.technology: mdo
ms.prod: m365-security
ms.openlocfilehash: 01013d58866274b67ff7fafd90c27016292c549b
ms.sourcegitcommit: 786f90a163d34c02b8451d09aa1efb1e1d5f543c
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 02/18/2021
ms.locfileid: "50287878"
---
# <a name="configure-anti-malware-policies-in-eop"></a>Configurare i criteri antimalware in EOP

[!INCLUDE [Microsoft 365 Defender rebranding](../includes/microsoft-defender-for-office.md)]

**Si applica a**
- [Exchange Online Protection](exchange-online-protection-overview.md)
- [Microsoft Defender per Office 365 piano 1 e piano 2](office-365-atp.md)
- [Microsoft 365 Defender](../mtp/microsoft-threat-protection.md)

Nelle organizzazioni di Microsoft 365 con cassette postali in Exchange Online o nelle organizzazioni Exchange Online Protection (EOP) autonome senza cassette postali di Exchange Online, i messaggi di posta elettronica vengono automaticamente protetti da malware da EOP. EOP utilizza criteri antimalware per le impostazioni di protezione antimalware. Per ulteriori informazioni, vedere [Protezione antimalware.](anti-malware-protection.md)

Gli amministratori possono visualizzare, modificare e configurare (ma non eliminare) il criterio antimalware predefinito per soddisfare le esigenze delle loro organizzazioni. Per una maggiore granularità, è inoltre possibile creare criteri antimalware personalizzati che si applicano a utenti, gruppi o domini specifici nell'organizzazione. I criteri personalizzati hanno sempre la precedenza sul criterio predefinito, ma non è possibile modificarne la priorità (in funzione).

È possibile configurare i criteri antimalware nel Centro sicurezza & conformità o in PowerShell (PowerShell di Exchange Online per le organizzazioni di Microsoft 365 con cassette postali in Exchange Online; PowerShell EOP autonomo per le organizzazioni senza cassette postali di Exchange Online).

## <a name="what-do-you-need-to-know-before-you-begin"></a>Che cosa è necessario sapere prima di iniziare?

- Aprire il Centro sicurezza e conformità in <https://protection.office.com/>. Per passare direttamente alla pagina **Antimalware,** utilizzare <https://protection.office.com/antimalware> .

- Per informazioni su come connettersi a PowerShell per Exchange Online, vedere [Connettersi a PowerShell per Exchange Online](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-powershell). Per connettersi a PowerShell di EOP autonomo, vedere [Connettersi a PowerShell per Exchange Online Protection](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-protection-powershell).

- Per poter eseguire le procedure contenute in questo articolo è necessario disporre delle autorizzazioni appropriate nel Centro sicurezza e conformità:
  - Per aggiungere, modificare ed eliminare criteri antimalware, è necessario essere membri dei gruppi di ruoli **Gestione** organizzazione o **Amministratore** sicurezza.
  - Per l'accesso in sola lettura ai criteri antimalware, è necessario essere membri dei gruppi di ruoli Lettore globale o Lettore **di** sicurezza. 

  Per altre informazioni, vedere [Autorizzazioni nel Centro sicurezza e conformità](permissions-in-the-security-and-compliance-center.md).

  **Note**:

  - L'aggiunta di utenti al ruolo di Azure Active Directory corrispondente nell'interfaccia di amministrazione di Microsoft 365 fornisce agli utenti le autorizzazioni necessarie nel centro Sicurezza e conformità _e_ le autorizzazioni per altre funzionalità di Microsoft 365. Per altre informazioni, vedere [Informazioni sui ruoli di amministratore](../../admin/add-users/about-admin-roles.md).
  - Anche il gruppo di ruoli di **Gestione organizzazione sola visualizzazione** in [Exchange Online](https://docs.microsoft.com/Exchange/permissions-exo/permissions-exo#role-groups) offre inoltre l'accesso di sola lettura a tale funzionalità.

- Per le impostazioni consigliate per i criteri antimalware, vedere Impostazioni dei criteri [antimalware di EOP.](recommended-settings-for-eop-and-office365-atp.md#eop-anti-malware-policy-settings)

## <a name="use-the-security--compliance-center-to-create-anti-malware-policies"></a>Usare il Centro sicurezza & conformità per creare criteri antimalware

La creazione di un criterio antimalware personalizzato nel Centro sicurezza & conformità crea contemporaneamente la regola di filtro antimalware e il criterio di filtro antimalware associato utilizzando lo stesso nome per entrambi.

1. Nel Centro sicurezza & conformità passare a Criteri di **gestione** delle minacce \>  \> **Antimalware** e  quindi fare clic su Nuova icona ![ ](../../media/ITPro-EAC-AddIcon.png) Aggiungi.

2. Nella pagina **Nuovo criterio antimalware** che si apre, configurare queste impostazioni:

   - **Nome**: immettere un nome univoco descrittivo per il criterio.

   - **Descrizione**: immettere una descrizione opzionale per il criterio.

   - **Risposta di rilevamento malware:** selezionare uno di questi valori per l'impostazione Do **you want to notify recipients if their messages are quarantined?** setting:

     - **No:** il messaggio viene messo in quarantena senza notifica ai destinatari previsti. Questo è il valore predefinito.

     - **Sì e usa il testo di notifica predefinito:** il messaggio è in quarantena. Una copia del messaggio viene recapitata  ai destinatari, ma tutti gli allegati (non solo quelli rilevati) vengono sostituiti con un singolo file di testo denominato **Malware Alert Text.txt** che contiene il testo predefinito. Per il testo predefinito, vedere [Criteri antimalware.](anti-malware-protection.md#anti-malware-policies)

     - **Sì e usa il testo di notifica personalizzato:** il messaggio è in quarantena. Una copia del messaggio viene recapitata  ai destinatari, ma tutti gli allegati (non solo quelli rilevati) vengono sostituiti con un singolo file di testo denominato **Malware Alert Text.txt** contenente il testo personalizzato specificato nella casella di testo **Avviso** personalizzato.

   - **Filtro tipi di allegati comuni**: selezionare uno di questi valori per bloccare i tipi di allegati che potrebbero danneggiare il **computer.**:

     - **Disattivato**

     - **In**: i messaggi con gli allegati specificati vengono considerati come rilevamenti di malware e vengono messi automaticamente in quarantena. È possibile modificare l'elenco facendo clic **sui pulsanti**  Aggiungi **e** Rimuovi.

   - **Malware Zero-hour Auto Purge**: Malware ZAP quarantines messages that have already been delivered. Per ulteriori informazioni, vedere [Zero-hour auto purge (ZAP) in Exchange Online.](zero-hour-auto-purge.md) Selezionare uno di questi valori:

     - **Disattivato**

     - **On (scelta consigliata)**

   - **Notifica:** le impostazioni in questa sezione controllano le notifiche del mittente e dell'amministratore quando viene rilevato malware in un messaggio.

     - **Notifiche mittente**: selezionare una o entrambe le opzioni seguenti:

       - **Notifica ai mittenti interni:** un mittente interno si trova all'interno dell'organizzazione.

       - **Notifica ai mittenti esterni:** un mittente esterno si trova all'esterno dell'organizzazione.

     - **Notifiche dell'amministratore:** selezionare una o entrambe le opzioni seguenti:

       - **Informare l'amministratore** dei messaggi non recapitati provenienti da mittenti interni: se si seleziona questa opzione, immettere un indirizzo di posta elettronica di notifica nella casella **Dell'indirizzo di posta elettronica dell'amministratore.**

       - **Informare l'amministratore** dei messaggi non recapitati provenienti da mittenti esterni: se si seleziona questa opzione, immettere un indirizzo di posta elettronica di notifica nella casella **Dell'indirizzo di** posta elettronica dell'amministratore.

     - **Personalizza notifiche:** queste impostazioni sostituiscono il testo di notifica predefinito utilizzato per mittenti o amministratori. Per ulteriori informazioni sui valori predefiniti, vedere [Criteri antimalware.](anti-malware-protection.md#anti-malware-policies)

       - **Usa testo** di notifica personalizzato: se si seleziona  questa opzione, è necessario utilizzare le caselle Nome mittente e Da per specificare il nome del mittente e l'indirizzo di posta elettronica utilizzato nel messaggio di notifica personalizzato. 

       - Messaggi **provenienti** da mittenti interni: se si è scelto di inviare una notifica ai mittenti  o agli amministratori in caso di messaggi non recapitabili provenienti da mittenti interni, è necessario utilizzare le caselle Oggetto e Messaggio per specificare l'oggetto e il corpo del messaggio di notifica personalizzato. 

       - Messaggi **provenienti** da mittenti esterni: se si è scelto di inviare una notifica ai mittenti  o agli amministratori in caso di messaggi non recapitabili provenienti da mittenti esterni, è necessario utilizzare le caselle Oggetto e Messaggio per specificare l'oggetto e il corpo del messaggio di notifica personalizzato. 

   - **Applicato a:** le impostazioni in questa sezione identificano i destinatari interni a cui si applica il criterio.

     - **If**: Click on the **Select one** drop-down, and select conditions for the rule:

       - **Il destinatario è**: specifica una o più cassette postali, utenti di posta o contatti di posta nell'organizzazione. Nella finestra **di dialogo Seleziona** membri visualizzata selezionare uno o più destinatari dall'elenco e quindi fare clic su aggiungi **- \>**. Nella casella **Controlla nomi** è possibile utilizzare i caratteri jolly per più indirizzi di posta elettronica, ad esempio \* @fabrikam.com. Al termine, fare clic su **OK**.

       - **Il dominio del destinatario** è : specifica i destinatari in uno o più domini accettati configurati nell'organizzazione. Nella finestra di dialogo visualizzata, selezionare uno o più domini e quindi fare clic su **aggiungi - \>**. Al termine, fare clic su **OK**.

       - **Il destinatario è membro di**: Specifica uno o più gruppi nell'organizzazione. Nella finestra **di dialogo Seleziona** membri visualizzata selezionare uno o più gruppi dall'elenco e quindi fare clic su aggiungi **- \>**. Al termine, fare clic su **OK**.

     È possibile utilizzare una condizione una sola volta, ma è possibile specificare più valori per la condizione. Più valori della stessa condizione utilizzano la logica OR (ad esempio, _\<recipient1\>_ o _\<recipient2\>_ ). In condizioni diverse viene utilizzata la logica AND, ad _\<recipient1\>_ esempio e _\<member of group 1\>_ . Per aggiungere ulteriori condizioni, selezionare **Aggiungi condizione** ed effettuare la selezione tra le opzioni rimanenti.

     - **Tranne se**: per aggiungere eccezioni per la regola, fare clic su Aggiungi **eccezione,** fare clic sull'elenco a discesa Seleziona una e configurare le eccezioni.  Impostazioni e comportamento sono equivalenti alle condizioni.

3. Al termine, scegliere **Salva**.

## <a name="use-the-security--compliance-center-to-view-anti-malware-policies"></a>Usare il Centro sicurezza & conformità per visualizzare i criteri antimalware

1. Nel Centro sicurezza & conformità passare a Criteri di **gestione** delle minacce \>  \> **Antimalware.**

2. Quando si seleziona un filtro, informazioni sul filtro vengono visualizzate nel riquadro dettagli. Per visualizzare ulteriori informazioni sul criterio, fare clic **sull'icona** ![ ](../../media/ITPro-EAC-EditIcon.png) Modifica.

   - Il valore della proprietà **Enabled**, il valore della proprietà **Priority** e le impostazioni della scheda **Applicato a** sono presenti nella regola di filtro antimalware.

   - Le impostazioni sulle schede **Generale** e **Impostazioni** sono presenti nel criterio di filtro antimalware.

## <a name="use-the-security--compliance-center-to-modify-anti-malware-policies"></a>Utilizzare il Centro sicurezza & conformità per modificare i criteri antimalware

1. Nel Centro sicurezza & conformità passare a Criteri di **gestione** delle minacce \>  \> **Antimalware.**

2. Selezionare il criterio e quindi fare clic **sull'icona** ![ ](../../media/ITPro-EAC-EditIcon.png) Modifica. Per informazioni sulle impostazioni, vedere la sezione Utilizzare il Centro sicurezza & conformità per creare criteri [antimalware](#use-the-security--compliance-center-to-create-anti-malware-policies) in questo articolo.

   **Note**:

   - Le impostazioni non sono tutte presenti sulla stessa pagina, ma sono suddivise tra le schede **Generale**, **Impostazioni** e **Applicato a**. La **scheda Applicato a** non è disponibile nel criterio predefinito denominato Predefinito (che viene applicato automaticamente a tutti gli utenti).

   - Non è possibile rinominare il criterio predefinito.

## <a name="use-the-security--compliance-center-to-enable-or-disable-anti-malware-policies"></a>Utilizzare il Centro sicurezza & conformità per abilitare o disabilitare i criteri antimalware

1. Nel Centro sicurezza & conformità passare a Criteri di **gestione** delle minacce \>  \> **Antimalware.**

2. Selezionare il criterio dall'elenco e quindi configurare una delle opzioni seguenti:

   - **Disabilitare il criterio:** deselezionare la casella di controllo nella **colonna** Abilitato. Per impostazione predefinita, i criteri antimalware vengono abilitati quando vengono creati nel Centro sicurezza & conformità.

   - **Abilitare il criterio:** selezionare la casella di controllo nella **colonna Abilitato.**

## <a name="use-the-security--compliance-center-to-set-the-priority-of-custom-anti-malware-policies"></a>Usare il Centro sicurezza & conformità per impostare la priorità dei criteri antimalware personalizzati

Per impostazione predefinita, ai criteri antimalware viene data una priorità che si basa sull'ordine in cui sono stati creati (i criteri più recenti hanno una priorità inferiore rispetto ai criteri precedenti). Un valore di priorità inferiore indica una priorità più alta per il criterio e i criteri vengono elaborati nell'ordine di priorità (i criteri con priorità più elevata vengono elaborati prima di quelli con priorità più bassa). Nessun criterio può avere la stessa priorità e l'elaborazione dei criteri termina dopo l'applicazione del primo criterio.

 **Note**:

- Nel Centro sicurezza & conformità, è possibile modificare la priorità dei criteri antimalware solo dopo aver creato il criterio. In PowerShell, è possibile ignorare la priorità predefinita quando si crea la regola di filtro antimalware (che può influire sulla priorità delle regole esistenti).

- Nel Centro sicurezza & conformità, i criteri antimalware vengono elaborati nell'ordine in cui vengono visualizzati (il primo criterio ha il valore **Di** priorità 0). Il criterio antimalware predefinito denominato Default ha il valore di priorità **Lowest** e non è possibile modificarlo.

Per modificare la priorità di un criterio, spostare il criterio più in alto o più in basso nell'elenco (non è possibile modificare direttamente il numero **Priority** nel Centro sicurezza e conformità).

1. Nel Centro sicurezza & conformità passare a Criteri di **gestione** delle minacce \>  \> **Antimalware.**

2. Selezionare un criterio e  quindi fare clic sull'icona Sposta freccia su o Sposta giù freccia giù per spostare la regola verso l'alto o ![ verso il basso ](../../media/ITPro-EAC-UpArrowIcon.png)  ![ ](../../media/ITPro-EAC-DownArrowIcon.png) nell'elenco.

## <a name="use-the-security--compliance-center-to-remove-anti-malware-policies"></a>Utilizzare il Centro sicurezza & conformità per rimuovere i criteri antimalware

Quando si utilizza il Centro sicurezza & conformità per rimuovere un criterio antimalware, la regola di filtro antimalware e il criterio di filtro antimalware corrispondente vengono entrambi eliminati.

1. Nel Centro sicurezza & conformità passare a Criteri di **gestione** delle minacce \>  \> **Antimalware.**

2. Selezionare il criterio antimalware che si desidera rimuovere dall'elenco e quindi fare clic **sull'icona** ![ ](../../media/ITPro-EAC-DeleteIcon.png) Elimina.

## <a name="use-exchange-online-powershell-or-standalone-eop-powershell-to-configure-anti-malware-policies"></a>Utilizzare PowerShell di Exchange Online o PowerShell di EOP autonomo per configurare i criteri antimalware

### <a name="use-powershell-to-create-anti-malware-policies"></a>Utilizzare PowerShell per creare criteri antimalware

La creazione di un criterio antimalware in PowerShell è un processo in due passaggi:

1. Creare il criterio del filtro antimalware.

2. Creare la regola del filtro antimalware che identifica il criterio del filtro antimalware cui viene applicata la regola.

 **Note**:

- È possibile creare una nuova regola di filtro antimalware e assegnarle un criterio di filtro antimalware esistente e non associazione. Una regola di filtro antimalware non può essere associata a più criteri di filtro antimalware.

- Esistono due impostazioni che è possibile configurare nei nuovi criteri antimalware in PowerShell che non sono disponibili nel Centro sicurezza & conformità fino a quando non si crea il criterio:

  - Creare il nuovo criterio come disabilitato (_abilitato_ `$false` nel cmdlet **New-MalwareFilterRule).**

  - Impostare la priorità del criterio durante la creazione (_Priority_ _\<Number\>_ ) nel cmdlet **New-MalwareFilterRule.**

- Un nuovo criterio di filtro antimalware creato in PowerShell non è visibile nel Centro sicurezza & conformità finché non si assegna il criterio a una regola di filtro antimalware.

#### <a name="step-1-use-powershell-to-create-a-malware-filter-policy"></a>Passaggio 1: Utilizzare PowerShell per creare un criterio di filtro antimalware

**Nota:** in EOP, i _valori del_ parametro Action , e `DeleteMessage` non `DeleteAttachmentAndUseDefaultAlert` `DeleteAttachmentAndUseCustomAlert` eliminano i messaggi. Al contrario, i messaggi vengono messi in quarantena. Per ulteriori informazioni sul recupero dei messaggi in quarantena, vedere Gestire i messaggi e i file in quarantena come [amministratore in EOP.](manage-quarantined-messages-and-files.md)

Per creare un criterio di filtro di antimalware, utilizzare questa sintassi:

```PowerShell
New-MalwareFilterPolicy -Name "<PolicyName>" [-Action <DeleteMessage | DeleteAttachmentAndUseDefaultAlert | DeleteAttachmentAndUseCustomAlert>] [-AdminDisplayName "<OptionalComments>"] [-CustomNotifications <$true | $false>] [<Inbound notification options>] [<Outbound notification options>]
```

Con questo esempio viene creato un nuovo criterio per il filtro antimalware denominato Contoso Malware Filter Policy con queste impostazioni:

- Mettere in quarantena i messaggi che contengono malware senza notificare i destinatari (non viene utilizzato il parametro _Action_ e il valore predefinito è `DeleteMessage` ).

- Non informare il mittente del messaggio quando viene rilevato malware nel messaggio (non vengono utilizzati i parametri _EnableExternalSenderNotifications_ o _EnableInternalSenderNotifications_ e il valore predefinito per entrambi è `$false` ).

- Notifica all'amministratore admin@contoso.com quando viene rilevato malware in un messaggio proveniente da un mittente interno.

```PowerShell
New-MalwareFilterPolicy -Name "Contoso Malware Filter Policy" -EnableInternalSenderAdminNotifications $true -InternalSenderAdminAddress admin@contoso.com
```

Per informazioni dettagliate sulla sintassi e sui parametri, vedere [New-MalwareFilterPolicy](https://docs.microsoft.com/powershell/module/exchange/new-malwarefilterpolicy).

#### <a name="step-2-use-powershell-to-create-a-malware-filter-rule"></a>Passaggio 2: Utilizzare PowerShell per creare una regola di filtro antimalware

Per creare una regola di filtro di antimalware, utilizzare questa sintassi:

```PowerShell
New-MalwareFilterRule -Name "<RuleName>" -MalwareFilterPolicy "<PolicyName>" <Recipient filters> [<Recipient filter exceptions>] [-Comments "<OptionalComments>"]
```

Questo esempio crea una nuova regola di filtro malware denominata Contoso Recipients con queste impostazioni:

- Il criterio di filtro antimalware denominato Contoso Malware Filter Policy viene associato alla regola.

- La regola si applica ai destinatari nel dominio contoso.com.

```PowerShell
New-MalwareFilterRule -Name "Contoso Recipients" -MalwareFilterPolicy "Contoso Malware Filter Policy" -RecipientDomainIs contoso.com
```

Per informazioni dettagliate sulla sintassi e sui parametri, vedere [New-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/new-malwarefilterrule).

### <a name="use-powershell-to-view-malware-filter-policies"></a>Utilizzare PowerShell per visualizzare i criteri di filtro antimalware

Per visualizzare un elenco riepilogativo di tutti i criteri di filtro antimalware, eseguire questo comando:

```PowerShell
Get-MalwareFilterPolicy
```

Per visualizzare informazioni dettagliate su un criterio di filtro antimalware specifico, utilizzare questa sintassi:

```PowerShell
Get-MalwareFilterPolicy -Identity "<PolicyName>" | Format-List [<Specific properties to view>]
```

In questo esempio vengono visualizzati tutti i valori delle proprietà per il criterio di filtro antimalware denominato Executives.

```PowerShell
Get-MalwareFilterPolicy -Identity "Executives" | Format-List
```

In questo esempio vengono visualizzate solo le proprietà specificate per lo stesso criterio.

```PowerShell
Get-MalwareFilterPolicy -Identity "Executives" | Format-List Action,AdminDisplayName,CustomNotifications,Enable*Notifications
```

Per informazioni dettagliate sulla sintassi e sui parametri, vedere [Get-MalwareFilterPolicy](https://docs.microsoft.com/powershell/module/exchange/get-malwarefilterpolicy).

### <a name="use-powershell-to-view-malware-filter-rules"></a>Utilizzare PowerShell per visualizzare le regole di filtro antimalware

Per visualizzare un elenco riepilogativo di tutte le regole di filtro antimalware, eseguire questo comando:

```PowerShell
Get-MalwareFilterRule
```

Per filtrare l'elenco in base alle regole abilitate o disabilitate, eseguire i comandi seguenti:

```PowerShell
Get-HostedContentFilterRule -State Disabled
```

```PowerShell
Get-HostedContentFilterRule -State Enabled
```

Per visualizzare informazioni dettagliate su una regola di filtro antimalware specifica, utilizzare questa sintassi:

```PowerShell
Get-MalwareFilterRule -Identity "<RuleName>" | Format-List [<Specific properties to view>]
```

In questo esempio vengono visualizzati tutti i valori delle proprietà per la regola di filtro antimalware denominata Executives.

```PowerShell
Get-MalwareFilterRule -Identity "Executives" | Format-List
```

In questo esempio vengono visualizzate solo le proprietà specificate per la stessa regola.

```PowerShell
Get-MalwareFilterRule -Identity "Executives" | Format-List Name,Priority,State,MalwareFilterPolicy,*Is,*SentTo,*MemberOf
```

Per informazioni dettagliate sulla sintassi e sui parametri, vedere [Get-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/get-malwarefilterrule).

### <a name="use-powershell-to-modify-malware-filter-policies"></a>Utilizzare PowerShell per modificare i criteri di filtro antimalware

Oltre agli elementi seguenti, le stesse impostazioni sono disponibili quando si modifica un criterio di filtro antimalware in PowerShell come quando si crea il criterio come descritto nel passaggio 1: Utilizzare PowerShell per creare una sezione dei criteri di filtro [antimalware](#step-1-use-powershell-to-create-a-malware-filter-policy) più indietro in questo articolo.

- L'opzione _MakeDefault_ che trasforma il criterio specificato nel criterio predefinito  (applicato a tutti, priorità minima non modificabile e non è possibile eliminarlo) è disponibile solo quando si modifica un criterio di filtro antimalware in PowerShell.

- Non è possibile rinominare un criterio di filtro antimalware (il cmdlet **Set-MalwareFilterPolicy** non dispone di alcun _parametro_ Name). Quando si rinomina un criterio antimalware nel Centro sicurezza & conformità, si rinomina solo la regola di filtro _antimalware._

Per modificare un criterio di filtro di antimalware, utilizzare questa sintassi:

```PowerShell
Set-MalwareFilterPolicy -Identity "<PolicyName>" <Settings>
```

Per informazioni dettagliate sulla sintassi e sui parametri, vedere [Set-MalwareFilterPolicy](https://docs.microsoft.com/powershell/module/exchange/set-malwarefilterpolicy).

### <a name="use-powershell-to-modify-malware-filter-rules"></a>Utilizzare PowerShell per modificare le regole di filtro antimalware

L'unica impostazione non disponibile quando si modifica una regola di filtro antimalware in PowerShell è il parametro _Enabled_ che consente di creare una regola disabilitata. Per abilitare o disabilitare le regole di filtro antimalware esistenti, vedere la sezione successiva.

In caso contrario, non sono disponibili impostazioni aggiuntive quando si modifica una regola di filtro antimalware in PowerShell. Le stesse impostazioni sono disponibili quando si crea una regola come descritto nel passaggio 2: Utilizzare PowerShell per creare una regola di filtro [antimalware](#step-2-use-powershell-to-create-a-malware-filter-rule) più indietro in questo articolo.

Per modificare una regola di filtro di antimalware, utilizzare questa sintassi:

```PowerShell
Set-MalwareFilterRule -Identity "<RuleName>" <Settings>
```

Per informazioni dettagliate sulla sintassi e sui parametri, vedere [Set-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/set-malwarefilterrule).

### <a name="use-powershell-to-enable-or-disable-malware-filter-rules"></a>Abilitazione o disabilitazione delle regole di filtro antimalware tramite PowerShell

L'abilitazione o la disabilitazione di una regola di filtro antimalware in PowerShell abilita o disabilita l'intero criterio antimalware (la regola di filtro antimalware e il criterio di filtro antimalware assegnato). Non è possibile abilitare o disabilitare il criterio antimalware predefinito (viene sempre applicato a tutti i destinatari).

Per abilitare o disabilitare una regola di filtro antimalware in PowerShell, utilizzare la sintassi seguente:

```PowerShell
<Enable-MalwareFilterRule | Disable-MalwareFilterRule> -Identity "<RuleName>"
```

In questo esempio viene disabilitata la regola di filtro antimalware denominata Marketing Department.

```PowerShell
Disable-MalwareFilterRule -Identity "Marketing Department"
```

In questo esempio viene abilitata la stessa regola.

```PowerShell
Enable-MalwareFilterRule -Identity "Marketing Department"
```

Per informazioni dettagliate sulla sintassi e sui parametri, vedere [Enable-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/enable-malwarefilterrule) e [Disable-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/disable-malwarefilterrule).

### <a name="use-powershell-to-set-the-priority-of-malware-filter-rules"></a>Utilizzare PowerShell per impostare la priorità delle regole di filtro antimalware

Il valore di priorità più alto che è possibile impostare in una regola è 0. Il valore più basso che è possibile impostare dipende dal numero di regole. Se si dispone di cinque regole, ad esempio, è possibile utilizzare i valori di priorità da 0 a 4. Modificare la priorità di una regola esistente può avere un effetto a catena su altre regole. Ad esempio, se si dispone di cinque regole personalizzate (priorità da 0 a 4) e si modifica la priorità di una regola su 2, la regola esistente con priorità 2 viene modificata a livello di priorità 3 e la regola con priorità 3 viene modificata a livello di priorità 4.

Per impostare la priorità di una regola di filtro antimalware in PowerShell, utilizzare la sintassi seguente:

```PowerShell
Set-MalwareFilterRule -Identity "<RuleName>" -Priority <Number>
```

Nell'esempio seguente la priorità della regola denominata Marketing Department viene impostata su 2. Tutte le regole esistenti che hanno una priorità minore o uguale a 2 vengono abbassate di 1 valore (i numeri di priorità vengono aumentati di 1).

```PowerShell
Set-MalwareFilterRule -Identity "Marketing Department" -Priority 2
```

**Note**:

- Per impostare la priorità di una nuova regola al momento della creazione, utilizzare il parametro _Priority_ nel cmdlet **New-MalwareFilterRule.**

- Il criterio di filtro antimalware predefinito non dispone di una regola di filtro antimalware corrispondente e ha sempre il valore di priorità non modificabile **Lowest.**

### <a name="use-powershell-to-remove-malware-filter-policies"></a>Utilizzare PowerShell per rimuovere i criteri di filtro antimalware

Quando si utilizza PowerShell per rimuovere un criterio di filtro antimalware, la regola di filtro antimalware corrispondente non viene rimossa.

Per rimuovere un criterio di filtro antimalware in PowerShell, utilizzare la sintassi seguente:

```PowerShell
Remove-MalwareFilterPolicy -Identity "<PolicyName>"
```

In questo esempio viene rimosso il criterio di filtro antimalware denominato Marketing Department.

```PowerShell
Remove-MalwareFilterPolicy -Identity "Marketing Department"
```

Per informazioni dettagliate sulla sintassi e sui parametri, vedere [Remove-MalwareFilterPolicy](https://docs.microsoft.com/powershell/module/exchange/remove-malwarefilterpolicy).

### <a name="use-powershell-to-remove-malware-filter-rules"></a>Utilizzare PowerShell per rimuovere le regole di filtro antimalware

Quando si utilizza PowerShell per rimuovere una regola di filtro antimalware, il criterio di filtro antimalware corrispondente non viene rimosso.

Per rimuovere una regola di filtro antimalware in PowerShell, utilizzare la sintassi seguente:

```PowerShell
Remove-MalwareFilterRule -Identity "<PolicyName>"
```

In questo esempio viene rimossa la regola di filtro antimalware denominata Marketing Department.

```PowerShell
Remove-MalwareFilterRule -Identity "Marketing Department"
```

Per informazioni dettagliate sulla sintassi e sui parametri, vedere [Remove-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/remove-malwarefilterrule).

## <a name="how-do-you-know-these-procedures-worked"></a>Come verificare se queste procedure hanno avuto esito positivo?

### <a name="use-the-eicartxt-file-to-verify-your-anti-malware-policy-settings"></a>Utilizzare il file EICAR.TXT per verificare le impostazioni dei criteri antimalware

> [!IMPORTANT]
> Il file EICAR.TXT non è un virus. L'Istituto europeo per la ricerca antivirus informatica (EICAR) ha sviluppato questo file per testare in modo sicuro le installazioni e le impostazioni antivirus.

1. Aprire blocco note e incollare il testo seguente in un file vuoto:

   ```Text
   X5O!P%@AP[4\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*
   ```

   Assicurati che questi siano gli unici caratteri di testo nel file. La dimensione del file deve essere di 68 byte.

2. Salvare il file come EICAR.TXT

   Nel programma antivirus desktop, assicurarsi di escludere il EICAR.TXT dall'analisi (in caso contrario, il file verrà messo in quarantena).

3. Inviare un messaggio di posta elettronica contenente EICAR.TXT file come allegato, utilizzando un client di posta elettronica che non blocca automaticamente il file. Utilizzare le impostazioni dei criteri antimalware per determinare i seguenti scenari da testare:

   - Posta elettronica da una cassetta postale interna a un destinatario interno.

   - Posta elettronica da una cassetta postale interna a un destinatario esterno.

   - Posta elettronica da una cassetta postale esterna a un destinatario interno.

4. Verificare che il messaggio sia stato messo in quarantena e verificare i risultati della notifica del mittente e del destinatario in base alle impostazioni dei criteri antimalware. Ad esempio:

   - I destinatari non ricevono una notifica o i destinatari ricevono il messaggio originale con l'allegato EICAR.TXT sostituito dal Text.txtdi avviso **antimalware** che contiene il testo predefinito o personalizzato.

   - I mittenti interni o esterni vengono informati con i messaggi di notifica predefiniti o personalizzati.

   - L'indirizzo di posta elettronica dell'amministratore specificato viene notificato ai mittenti interni o esterni dei messaggi, con i messaggi di notifica predefiniti o personalizzati.

5. Elimina il file EICAR.TXT al termine del test (in modo che altri utenti non siano inutilmente allarmati da esso).
