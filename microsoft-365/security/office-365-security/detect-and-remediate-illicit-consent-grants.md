---
title: Rilevare e correggere le concessioni di consenso illecite
f1.keywords:
- NOCSH
ms.author: tracyp
author: MSFTTracyp
manager: dansimp
ms.date: ''
audience: ITPro
ms.topic: article
ms.collection:
- o365_security_incident_response
- M365-security-compliance
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
description: Informazioni su come riconoscere e correggere il consenso illecito Grants Attack in Microsoft Office 365.
ms.custom: seo-marvel-apr2020
ms.openlocfilehash: b534d53166c09cf77993948cf1c448e21c8cd330
ms.sourcegitcommit: c083602dda3cdcb5b58cb8aa070d77019075f765
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/22/2020
ms.locfileid: "48203096"
---
# <a name="detect-and-remediate-illicit-consent-grants"></a><span data-ttu-id="5e4c8-103">Rilevare e correggere le concessioni di consenso illecite</span><span class="sxs-lookup"><span data-stu-id="5e4c8-103">Detect and Remediate Illicit Consent Grants</span></span>

[!INCLUDE [Microsoft 365 Defender rebranding](../includes/microsoft-defender-for-office.md)]


<span data-ttu-id="5e4c8-104">**Riepilogo**  Informazioni su come riconoscere e correggere il consenso illecito Grants Attack in Office 365.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-104">**Summary**  Learn how to recognize and remediate the illicit consent grants attack in Office 365.</span></span>

## <a name="what-is-the-illicit-consent-grant-attack-in-office-365"></a><span data-ttu-id="5e4c8-105">Che cos'è l'attacco di concessione di autorizzazioni illecite in Office 365?</span><span class="sxs-lookup"><span data-stu-id="5e4c8-105">What is the illicit consent grant attack in Office 365?</span></span>

<span data-ttu-id="5e4c8-106">In un attacco di concessione di consenso illecito, l'utente malintenzionato crea un'applicazione registrata in Azure che richiede l'accesso ai dati, ad esempio le informazioni di contatto, la posta elettronica o i documenti.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-106">In an illicit consent grant attack, the attacker creates an Azure-registered application that requests access to data such as contact information, email, or documents.</span></span> <span data-ttu-id="5e4c8-107">L'utente malintenzionato, quindi, inganna l'utilizzatore finale per concedere a tale applicazione il consenso per accedere ai propri dati tramite un attacco di phishing o iniettando codice illecito in un sito Web attendibile.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-107">The attacker then tricks an end user into granting that application consent to access their data either through a phishing attack, or by injecting illicit code into a trusted website.</span></span> <span data-ttu-id="5e4c8-108">Dopo che l'applicazione illecita ha ottenuto il consenso, ha accesso ai dati a livello di account senza la necessità di un account organizzativo.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-108">After the illicit application has been granted consent, it has account-level access to data without the need for an organizational account.</span></span> <span data-ttu-id="5e4c8-109">I normali passaggi di correzione, come la reimpostazione delle password per gli account violati o la richiesta di autenticazione a più fattori (AMF) per gli account, non sono efficaci rispetto a questo tipo di attacco, poiché si tratta di applicazioni di terze parti e sono esterne all'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-109">Normal remediation steps, like resetting passwords for breached accounts or requiring Multi-Factor Authentication (MFA) on accounts, are not effective against this type of attack, since these are third-party applications and are external to the organization.</span></span>

<span data-ttu-id="5e4c8-110">Questi attacchi sfruttano un modello di interazione che presuppone che l'entità che chiama le informazioni sia l'automazione e non un essere umano.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-110">These attacks leverage an interaction model which presumes the entity that is calling the information is automation and not a human.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="5e4c8-111">Si sospetta che si verifichino problemi con il consenso illecito-sovvenzioni da un'app, in questo momento?</span><span class="sxs-lookup"><span data-stu-id="5e4c8-111">Do you suspect you're experiencing problems with illicit consent-grants from an app, right now?</span></span> <span data-ttu-id="5e4c8-112">Microsoft cloud app Security (MCAS) dispone di strumenti per rilevare, analizzare e correggere le app OAuth.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-112">Microsoft Cloud App Security (MCAS) has tools to detect, investigate, and remediate your OAuth apps.</span></span> <span data-ttu-id="5e4c8-113">In questo articolo di MCAS è presente un'esercitazione che illustra come procedere per l' [analisi delle app a rischio di OAuth](https://docs.microsoft.com/cloud-app-security/investigate-risky-oauth).</span><span class="sxs-lookup"><span data-stu-id="5e4c8-113">This MCAS article has a tutorial that outlines how to go about [investigating risky OAuth apps](https://docs.microsoft.com/cloud-app-security/investigate-risky-oauth).</span></span> <span data-ttu-id="5e4c8-114">È inoltre possibile impostare i [criteri di applicazione OAuth](https://docs.microsoft.com/cloud-app-security/app-permission-policy) per esaminare le autorizzazioni richieste dall'app, che gli utenti autorizzano tali app e approvare o vietare ampiamente queste richieste di autorizzazione.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-114">You can also set [OAuth app policies](https://docs.microsoft.com/cloud-app-security/app-permission-policy) to investigate app-requested permissions, which users are authorizing these apps, and widely approve or ban these permissions requests.</span></span>

## <a name="what-does-an-illicit-consent-grant-attack-look-like-in-office-365"></a><span data-ttu-id="5e4c8-115">Che cosa comporta un attacco di consenso illecito per l'assenso in Office 365?</span><span class="sxs-lookup"><span data-stu-id="5e4c8-115">What does an illicit consent grant attack look like in Office 365?</span></span>

<span data-ttu-id="5e4c8-116">È necessario eseguire una ricerca nel **Registro di controllo** per individuare i segni, denominati anche indicatori di compromesso (IOC) di questo attacco.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-116">You need to search the **audit log** to find signs, also called Indicators of Compromise (IOC) of this attack.</span></span> <span data-ttu-id="5e4c8-117">Per le organizzazioni con molte applicazioni registrate in Azure e una base di utenti di grandi dimensioni, la procedura consigliata consiste nell'esaminare le concessioni di consenso delle organizzazioni su base settimanale.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-117">For organizations with many Azure-registered applications and a large user base, the best practice is to review your organizations consent grants on a weekly basis.</span></span>

### <a name="steps-for-finding-signs-of-this-attack"></a><span data-ttu-id="5e4c8-118">Passaggi per individuare i segni di questo attacco</span><span class="sxs-lookup"><span data-stu-id="5e4c8-118">Steps for finding signs of this attack</span></span>

1. <span data-ttu-id="5e4c8-119">Aprire il **Centro sicurezza & Compliance** all'indirizzo <https://protection.office.com> .</span><span class="sxs-lookup"><span data-stu-id="5e4c8-119">Open the **Security & Compliance Center** at <https://protection.office.com>.</span></span>

2. <span data-ttu-id="5e4c8-120">Passare a **ricerca** e selezionare **Ricerca log di controllo**.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-120">Navigate to **Search** and select **Audit log search**.</span></span>

3. <span data-ttu-id="5e4c8-121">Search (tutte le attività e tutti gli utenti) e immettere la data di inizio e la data di fine, se necessario, e quindi fare clic su **Cerca**.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-121">Search (all activities and all users) and enter the start date and end date if required and then click **Search**.</span></span>

4. <span data-ttu-id="5e4c8-122">Fare clic su **Filtra risultati** e immettere consenso all'applicazione nel campo **attività** .</span><span class="sxs-lookup"><span data-stu-id="5e4c8-122">Click **Filter results** and enter Consent to application in the **Activity** field.</span></span>

5. <span data-ttu-id="5e4c8-123">Fare clic sul risultato per visualizzare i dettagli dell'attività.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-123">Click on the result to see the details of the activity.</span></span> <span data-ttu-id="5e4c8-124">Fare clic su **altre informazioni** per ottenere informazioni dettagliate sull'attività.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-124">Click **More Information** to get details of the activity.</span></span> <span data-ttu-id="5e4c8-125">Controllare se IsAdminContent è impostato su true.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-125">Check to see if IsAdminContent is set to True.</span></span>

> [!NOTE]
>
> <span data-ttu-id="5e4c8-126">La voce del registro di controllo corrispondente viene visualizzata nei risultati della ricerca dopo un evento di 30 minuti fino a 24 ore.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-126">It can take from 30 minutes up to 24 hours for the corresponding audit log entry to be displayed in the search results after an event occurs.</span></span>
>
> <span data-ttu-id="5e4c8-127">Il periodo di tempo in cui un record di controllo viene conservato e ricercabile nel log di controllo dipende dall'abbonamento a Microsoft 365 e in particolare dal tipo di licenza assegnato a un utente specifico.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-127">The length of time that an audit record is retained and searchable in the audit log depends on your Microsoft 365 subscription, and specifically the type of the license that is assigned to a specific user.</span></span> <span data-ttu-id="5e4c8-128">Per ulteriori informazioni, vedere [log di controllo](../../compliance/search-the-audit-log-in-security-and-compliance.md).</span><span class="sxs-lookup"><span data-stu-id="5e4c8-128">For more information, see [Audit log](../../compliance/search-the-audit-log-in-security-and-compliance.md).</span></span>
>
> <span data-ttu-id="5e4c8-129">Se questo valore è impostato su true, indica che un utente con accesso amministratore globale può aver concesso l'accesso esteso ai dati.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-129">If this value is true, it indicates that someone with Global Administrator access may have granted broad access to data.</span></span> <span data-ttu-id="5e4c8-130">Se questa operazione non è prevista, eseguire le operazioni necessarie per [confermare un attacco](#how-to-confirm-an-attack).</span><span class="sxs-lookup"><span data-stu-id="5e4c8-130">If this is unexpected, take steps to [confirm an attack](#how-to-confirm-an-attack).</span></span>

## <a name="how-to-confirm-an-attack"></a><span data-ttu-id="5e4c8-131">Come confermare un attacco</span><span class="sxs-lookup"><span data-stu-id="5e4c8-131">How to confirm an attack</span></span>

<span data-ttu-id="5e4c8-132">Se si dispone di una o più istanze di IOCs elencate in alto, è necessario eseguire ulteriori indagini per confermare positivamente che l'attacco si è verificato.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-132">If you have one or more instances of the IOCs listed above, you need to do further investigation to positively confirm that the attack occurred.</span></span> <span data-ttu-id="5e4c8-133">Per confermare l'attacco, è possibile utilizzare uno dei tre metodi seguenti:</span><span class="sxs-lookup"><span data-stu-id="5e4c8-133">You can use any of these three methods to confirm the attack:</span></span>

- <span data-ttu-id="5e4c8-134">Applicazioni di inventario e relative autorizzazioni tramite il portale di Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-134">Inventory applications and their permissions using the Azure Active Directory portal.</span></span> <span data-ttu-id="5e4c8-135">Questo metodo è accurato, ma è possibile controllare solo un utente alla volta che può richiedere molto tempo se si dispone di molti utenti da controllare.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-135">This method is thorough, but you can only check one user at a time which can be very time consuming if you have many users to check.</span></span>

- <span data-ttu-id="5e4c8-136">Applicazioni di inventario e relative autorizzazioni tramite PowerShell.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-136">Inventory applications and their permissions using PowerShell.</span></span> <span data-ttu-id="5e4c8-137">Questo è il metodo più rapido e completo, con il minor numero di overhead.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-137">This is the fastest and most thorough method, with the least amount of overhead.</span></span>

- <span data-ttu-id="5e4c8-138">Fare in modo che gli utenti controllino singolarmente le app e le autorizzazioni e riportino i risultati agli amministratori per la correzione.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-138">Have your users individually check their apps and permissions and report the results back to the administrators for remediation.</span></span>

## <a name="inventory-apps-with-access-in-your-organization"></a><span data-ttu-id="5e4c8-139">App di inventario con accesso nell'organizzazione</span><span class="sxs-lookup"><span data-stu-id="5e4c8-139">Inventory apps with access in your organization</span></span>

<span data-ttu-id="5e4c8-140">È possibile eseguire questa operazione per gli utenti con il portale di Azure Active Directory o con PowerShell oppure fare in modo che gli utenti possano enumerare singolarmente l'accesso alle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-140">You can do this for your users with either the Azure Active Directory Portal, or PowerShell or have your users individually enumerate their application access.</span></span>

### <a name="steps-for-using-the-azure-active-directory-portal"></a><span data-ttu-id="5e4c8-141">Passaggi per l'utilizzo del portale di Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="5e4c8-141">Steps for using the Azure Active Directory Portal</span></span>

<span data-ttu-id="5e4c8-142">È possibile cercare le applicazioni a cui ogni singolo utente ha concesso le autorizzazioni utilizzando il [portale di Azure Active Directory](https://portal.azure.com/).</span><span class="sxs-lookup"><span data-stu-id="5e4c8-142">You can look up the applications to which any individual user has granted permissions by using the [Azure Active Directory Portal](https://portal.azure.com/).</span></span>

1. <span data-ttu-id="5e4c8-143">Accedere al portale di Azure con diritti amministrativi.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-143">Sign in to the Azure Portal with administrative rights.</span></span>

2. <span data-ttu-id="5e4c8-144">Selezionare il Blade di Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-144">Select the Azure Active Directory blade.</span></span>

3. <span data-ttu-id="5e4c8-145">Selezionare **Utenti**.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-145">Select **Users**.</span></span>

4. <span data-ttu-id="5e4c8-146">Selezionare l'utente che si desidera esaminare.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-146">Select the user that you want to review.</span></span>

5. <span data-ttu-id="5e4c8-147">Selezionare **applicazioni**.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-147">Select **Applications**.</span></span>

<span data-ttu-id="5e4c8-148">In questo modo vengono mostrate le app che sono state assegnate all'utente e quali autorizzazioni hanno le applicazioni.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-148">This will show you the apps that are assigned to the user and what permissions the applications have.</span></span>

### <a name="steps-for-having-your-users-enumerate-their-application-access"></a><span data-ttu-id="5e4c8-149">Procedure per consentire agli utenti di enumerare l'accesso alle applicazioni</span><span class="sxs-lookup"><span data-stu-id="5e4c8-149">Steps for having your users enumerate their application access</span></span>

<span data-ttu-id="5e4c8-150">Fare in modo che gli utenti https://myapps.microsoft.com accedano e rivedano l'accesso a un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-150">Have your users go to https://myapps.microsoft.com and review their own application access there.</span></span> <span data-ttu-id="5e4c8-151">Essi dovrebbero essere in grado di visualizzare tutte le app con accesso, visualizzare i dettagli relativi (compreso l'ambito di accesso) ed essere in grado di revocare i privilegi alle app sospette o illecite.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-151">They should be able to see all the apps with access, view details about them (including the scope of access), and be able to revoke privileges to suspicious or illicit apps.</span></span>

### <a name="steps-for-doing-this-with-powershell"></a><span data-ttu-id="5e4c8-152">Passaggi per eseguire questa operazione con PowerShell</span><span class="sxs-lookup"><span data-stu-id="5e4c8-152">Steps for doing this with PowerShell</span></span>

<span data-ttu-id="5e4c8-153">Il modo più semplice per verificare l'attacco di concessione di consenso illecito consiste nell'eseguire [Get-AzureADPSPermissions.ps1](https://gist.github.com/psignoret/41793f8c6211d2df5051d77ca3728c09), che consentirà di scaricare tutti i concessioni di autorizzazione OAuth e le app OAuth per tutti gli utenti nel proprio contratto di locazione in un unico file. csv.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-153">The simplest way to verify the Illicit Consent Grant attack is to run [Get-AzureADPSPermissions.ps1](https://gist.github.com/psignoret/41793f8c6211d2df5051d77ca3728c09), which will dump all the OAuth consent grants and OAuth apps for all users in your tenancy into one .csv file.</span></span>

#### <a name="pre-requisites"></a><span data-ttu-id="5e4c8-154">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="5e4c8-154">Pre-requisites</span></span>

- <span data-ttu-id="5e4c8-155">Libreria di Azure AD PowerShell installata.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-155">The Azure AD PowerShell library installed.</span></span>

- <span data-ttu-id="5e4c8-156">Diritti di amministratore globale sul tenant su cui verrà eseguito lo script.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-156">Global administrator rights on the tenant that the script will be run against.</span></span>

- <span data-ttu-id="5e4c8-157">Amministratore locale nel computer da cui verranno eseguiti gli script.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-157">Local Administrator on the computer from which will run the scripts.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="5e4c8-158">È ***consigliabile*** richiedere l'autenticazione a più fattori per l'account amministrativo.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-158">We ***highly recommend*** that you require multi-factor authentication on your administrative account.</span></span> <span data-ttu-id="5e4c8-159">Questo script supporta l'autenticazione Mae.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-159">This script supports MFA authentication.</span></span>

1. <span data-ttu-id="5e4c8-160">Accedere al computer in cui verrà eseguito lo script con i diritti di amministratore locale.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-160">Sign in to the computer that you will run the script from with local administrator rights.</span></span>

2. <span data-ttu-id="5e4c8-161">Scaricare o copiare lo script [Get-AzureADPSPermissions.ps1](https://gist.github.com/psignoret/41793f8c6211d2df5051d77ca3728c09) da GitHub in una cartella dalla quale verrà eseguito lo script.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-161">Download or copy the [Get-AzureADPSPermissions.ps1](https://gist.github.com/psignoret/41793f8c6211d2df5051d77ca3728c09) script from GitHub to a folder from which you will run the script.</span></span> <span data-ttu-id="5e4c8-162">Questa sarà la stessa cartella in cui verrà scritto il file di output "permissions.csv".</span><span class="sxs-lookup"><span data-stu-id="5e4c8-162">This will be the same folder to which the output "permissions.csv" file will be written.</span></span>

3. <span data-ttu-id="5e4c8-163">Aprire un'istanza di PowerShell come amministratore e aprirla alla cartella in cui è stato salvato lo script.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-163">Open a PowerShell instance as an administrator and open to the folder you saved the script to.</span></span>

4. <span data-ttu-id="5e4c8-164">Connettersi alla directory utilizzando il cmdlet [Connect-AzureAD](https://docs.microsoft.com/powershell/module/azuread/connect-azuread) .</span><span class="sxs-lookup"><span data-stu-id="5e4c8-164">Connect to your directory using the [Connect-AzureAD](https://docs.microsoft.com/powershell/module/azuread/connect-azuread) cmdlet.</span></span>

5. <span data-ttu-id="5e4c8-165">Eseguire questo comando di PowerShell:</span><span class="sxs-lookup"><span data-stu-id="5e4c8-165">Run this PowerShell command:</span></span>

   ```powershell
   Get-AzureADPSPermissions.ps1 | Export-csv -Path "Permissions.csv" -NoTypeInformation
   ```

<span data-ttu-id="5e4c8-166">Lo script produce un file denominato Permissions.csv.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-166">The script produces one file named Permissions.csv.</span></span> <span data-ttu-id="5e4c8-167">Eseguire la procedura seguente per cercare le autorizzazioni di autorizzazione per l'applicazione illecite:</span><span class="sxs-lookup"><span data-stu-id="5e4c8-167">Follow these steps to look for illicit application permission grants:</span></span>

1. <span data-ttu-id="5e4c8-168">Nella colonna ConsentType (colonna G) cercare il valore "AllPrinciples".</span><span class="sxs-lookup"><span data-stu-id="5e4c8-168">In the ConsentType column (column G) search for the value "AllPrinciples".</span></span> <span data-ttu-id="5e4c8-169">L'autorizzazione AllPrincipals consente all'applicazione client di accedere al contenuto di tutti nel contratto di locazione.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-169">The AllPrincipals permission allows the client application to access everyone's content in the tenancy.</span></span> <span data-ttu-id="5e4c8-170">Le applicazioni native di Microsoft 365 hanno bisogno di questa autorizzazione per funzionare correttamente.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-170">Native Microsoft 365 applications need this permission to work correctly.</span></span> <span data-ttu-id="5e4c8-171">Tutte le applicazioni non Microsoft con questa autorizzazione devono essere esaminate con attenzione.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-171">Every non-Microsoft application with this permission should be reviewed carefully.</span></span>

2. <span data-ttu-id="5e4c8-172">Nella colonna autorizzazione (colonna F) esaminare le autorizzazioni che ogni applicazione delegata deve soddisfare.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-172">In the Permission column (column F) review the permissions that each delegated application has to content.</span></span> <span data-ttu-id="5e4c8-173">Cercare l'autorizzazione "lettura" e "scrittura" o "\*. All "autorizzazione e verificarne con attenzione perché potrebbero non essere appropriate.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-173">Look for "Read" and "Write" permission or "\*.All" permission, and review these carefully because they may not be appropriate.</span></span>

3. <span data-ttu-id="5e4c8-174">Esaminare gli utenti specifici a cui sono concessi consenzienti.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-174">Review the specific users that have consents granted.</span></span> <span data-ttu-id="5e4c8-175">Se gli utenti di alto profilo o di alto impatto hanno concessi consensi inadeguati, è necessario indagare ulteriormente.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-175">If high profile or high impact users have inappropriate consents granted, you should investigate further.</span></span>

4. <span data-ttu-id="5e4c8-176">Nella colonna ClientDisplayName (colonna C) cercare le app che risultano sospette.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-176">In the ClientDisplayName column (column C) look for apps that seem suspicious.</span></span> <span data-ttu-id="5e4c8-177">Le app con nomi di ortografia errati, nomi Super blandi o nomi di hacker devono essere esaminate con attenzione.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-177">Apps with misspelled names, super bland names, or hacker-sounding names should be reviewed carefully.</span></span>

## <a name="determine-the-scope-of-the-attack"></a><span data-ttu-id="5e4c8-178">Determinare l'ambito dell'attacco</span><span class="sxs-lookup"><span data-stu-id="5e4c8-178">Determine the scope of the attack</span></span>

<span data-ttu-id="5e4c8-179">Dopo aver completato l'inventario dell'applicazione, esaminare il **Registro di controllo** per determinare l'ambito completo della violazione.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-179">After you have finished inventorying application access, review the **audit log** to determine the full scope of the breach.</span></span> <span data-ttu-id="5e4c8-180">Cercare negli utenti coinvolti, i tempi di accesso dell'applicazione illecita all'organizzazione e le autorizzazioni dell'app.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-180">Search on the affected users, the time frames that the illicit application had access to your organization, and the permissions the app had.</span></span> <span data-ttu-id="5e4c8-181">È possibile eseguire una ricerca nel **Registro di controllo** nel [Centro sicurezza e conformità di Microsoft 365](https://docs.microsoft.com/microsoft-365/compliance/search-the-audit-log-in-security-and-compliance).</span><span class="sxs-lookup"><span data-stu-id="5e4c8-181">You can search the **audit log** in the [Microsoft 365 Security and Compliance Center](https://docs.microsoft.com/microsoft-365/compliance/search-the-audit-log-in-security-and-compliance).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="5e4c8-182">Il controllo [delle cassette postali](https://docs.microsoft.com/microsoft-365/compliance/enable-mailbox-auditing) e il [controllo delle attività per gli amministratori e gli utenti](https://docs.microsoft.com/microsoft-365/compliance/turn-audit-log-search-on-or-off) devono essere stati abilitati prima dell'attacco per ottenere queste informazioni.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-182">[Mailbox auditing](https://docs.microsoft.com/microsoft-365/compliance/enable-mailbox-auditing) and [Activity auditing for admins and users](https://docs.microsoft.com/microsoft-365/compliance/turn-audit-log-search-on-or-off) must have been enabled prior to the attack for you to get this information.</span></span>

## <a name="how-to-stop-and-remediate-an-illicit-consent-grant-attack"></a><span data-ttu-id="5e4c8-183">Come arrestare e correggere un attacco di concessione di un consenso illecito</span><span class="sxs-lookup"><span data-stu-id="5e4c8-183">How to stop and remediate an illicit consent grant attack</span></span>

<span data-ttu-id="5e4c8-184">Dopo aver identificato un'applicazione con autorizzazioni illecite, sono disponibili diversi modi per rimuovere tale accesso.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-184">After you have identified an application with illicit permissions, you have several ways to remove that access.</span></span>

- <span data-ttu-id="5e4c8-185">È possibile revocare l'autorizzazione dell'applicazione nel portale di Azure Active Directory per:</span><span class="sxs-lookup"><span data-stu-id="5e4c8-185">You can revoke the application's permission in the Azure Active Directory Portal by:</span></span>

  - <span data-ttu-id="5e4c8-186">Passare all'utente coinvolto nel Blade **utente di Azure Active Directory** .</span><span class="sxs-lookup"><span data-stu-id="5e4c8-186">Navigate to the affected user in the **Azure Active Directory User** blade.</span></span>

  - <span data-ttu-id="5e4c8-187">Selezionare **applicazioni**.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-187">Select **Applications**.</span></span>

  - <span data-ttu-id="5e4c8-188">Selezionare l'applicazione illecita.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-188">Select the illicit application.</span></span>

  - <span data-ttu-id="5e4c8-189">Fare clic su **Rimuovi** nell'esercitazione verso il basso.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-189">Click **Remove** in the drill down.</span></span>

- <span data-ttu-id="5e4c8-190">È possibile revocare la concessione di autorizzazione OAuth con PowerShell attenendosi alla procedura descritta in [Remove-AzureADOAuth2PermissionGrant](https://docs.microsoft.com/powershell/module/azuread/Remove-AzureADOAuth2PermissionGrant).</span><span class="sxs-lookup"><span data-stu-id="5e4c8-190">You can revoke the OAuth consent grant with PowerShell by following the steps in [Remove-AzureADOAuth2PermissionGrant](https://docs.microsoft.com/powershell/module/azuread/Remove-AzureADOAuth2PermissionGrant).</span></span>

- <span data-ttu-id="5e4c8-191">È possibile revocare l'assegnazione di ruolo app di servizio con PowerShell attenendosi alla procedura descritta in [Remove-AzureADServiceAppRoleAssignment](https://docs.microsoft.com/powershell/module/azuread/Remove-AzureADServiceAppRoleAssignment).</span><span class="sxs-lookup"><span data-stu-id="5e4c8-191">You can revoke the Service App Role Assignment with PowerShell by following the steps in [Remove-AzureADServiceAppRoleAssignment](https://docs.microsoft.com/powershell/module/azuread/Remove-AzureADServiceAppRoleAssignment).</span></span>

- <span data-ttu-id="5e4c8-192">È inoltre possibile disabilitare l'accesso per l'account interessato del tutto, che disattiverà la disabilitazione dell'app ai dati di quell'account.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-192">You can also disable sign-in for the affected account altogether, which will in turn disable app access to data in that account.</span></span> <span data-ttu-id="5e4c8-193">Questo non è l'ideale per la produttività dell'utente finale, naturalmente, ma se si lavora per limitare rapidamente l'impatto, può essere una soluzione valida per la correzione a breve termine.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-193">This isn't ideal for the end user's productivity, of course, but if you are working to limit impact quickly, it can be a viable short-term remediation.</span></span>

- <span data-ttu-id="5e4c8-194">È possibile disattivare le applicazioni integrate per il tuo contratto di locazione.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-194">You can turn integrated applications off for your tenancy.</span></span> <span data-ttu-id="5e4c8-195">Si tratta di un passaggio drastico che disabilita la possibilità per gli utenti finali di concedere il consenso a livello di tenant.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-195">This is a drastic step that disables the ability for end users to grant consent on a tenant-wide basis.</span></span> <span data-ttu-id="5e4c8-196">Ciò impedisce agli utenti di concedere inavvertitamente l'accesso a un'applicazione dannosa.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-196">This prevents your users from inadvertently granting access to a malicious application.</span></span> <span data-ttu-id="5e4c8-197">Questo non è fortemente consigliato perché compromette gravemente la capacità degli utenti di essere produttivi con le applicazioni di terze parti.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-197">This isn't strongly recommended as it severely impairs your users' ability to be productive with third party applications.</span></span> <span data-ttu-id="5e4c8-198">È possibile eseguire questa operazione attenendosi alla procedura descritta in [attivazione o disattivazione delle app integrate](https://docs.microsoft.com/microsoft-365/admin/misc/integrated-apps).</span><span class="sxs-lookup"><span data-stu-id="5e4c8-198">You can do this by following the steps in [Turning Integrated Apps on or off](https://docs.microsoft.com/microsoft-365/admin/misc/integrated-apps).</span></span>

## <a name="secure-microsoft-365-like-a-cybersecurity-pro"></a><span data-ttu-id="5e4c8-199">Proteggere Microsoft 365 come un professionista della sicurezza informatica</span><span class="sxs-lookup"><span data-stu-id="5e4c8-199">Secure Microsoft 365 like a cybersecurity pro</span></span>

<span data-ttu-id="5e4c8-200">L'abbonamento a Microsoft 365 include un potente set di funzionalità di protezione che consente di proteggere i propri dati e quelli degli altri utenti.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-200">Your Microsoft 365 subscription comes with a powerful set of security capabilities that you can use to protect your data and your users.</span></span> <span data-ttu-id="5e4c8-201">Usare la [Roadmap della sicurezza di Microsoft 365: principali priorità per i primi 30 giorni, 90 giorni e oltre](security-roadmap.md) per implementare le procedure consigliate da Microsoft per proteggere il tenant di Microsoft 365.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-201">Use the [Microsoft 365 security roadmap - Top priorities for the first 30 days, 90 days, and beyond](security-roadmap.md) to implement Microsoft recommended best practices for securing your Microsoft 365 tenant.</span></span>

- <span data-ttu-id="5e4c8-202">Attività da eseguire i primi 30 giorni.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-202">Tasks to accomplish in the first 30 days.</span></span> <span data-ttu-id="5e4c8-203">Queste hanno effetto immediato e sono a basso impatto per gli utenti.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-203">These have immediate affect and are low-impact to your users.</span></span>

- <span data-ttu-id="5e4c8-204">Attività da completare in 90 giorni.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-204">Tasks to accomplish in 90 days.</span></span> <span data-ttu-id="5e4c8-205">Queste attività richiedono una quantità di tempo leggermente superiore per la pianificazione e l'implementazione, ma aumentano notevolmente il livello di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-205">These take a bit more time to plan and implement but greatly improve your security posture.</span></span>

- <span data-ttu-id="5e4c8-206">Dopo 90 giorni.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-206">Beyond 90 days.</span></span> <span data-ttu-id="5e4c8-207">Questi miglioramenti si instaurano nei primi 90 giorni di lavoro effettuato.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-207">These enhancements build in your first 90 days work.</span></span>

## <a name="see-also"></a><span data-ttu-id="5e4c8-208">Vedere anche:</span><span class="sxs-lookup"><span data-stu-id="5e4c8-208">See also:</span></span>

- <span data-ttu-id="5e4c8-209">[Applicazione imprevista nell'elenco delle applicazioni](https://docs.microsoft.com/azure/active-directory/application-access-unexpected-application) gli amministratori possono eseguire le varie azioni che è possibile intraprendere dopo aver realizzato che sono presenti applicazioni inattese con accesso ai dati.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-209">[Unexpected application in my applications list](https://docs.microsoft.com/azure/active-directory/application-access-unexpected-application) walks administrators through various actions they may want to take after realizing there are unexpected applications with access to data.</span></span>

- <span data-ttu-id="5e4c8-210">L' [integrazione di applicazioni con Azure Active Directory](https://docs.microsoft.com/azure/active-directory/active-directory-apps-permissions-consent) è una panoramica generale del consenso e delle autorizzazioni.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-210">[Integrating applications with Azure Active Directory](https://docs.microsoft.com/azure/active-directory/active-directory-apps-permissions-consent) is a high-level overview of consent and permissions.</span></span>

- <span data-ttu-id="5e4c8-211">[Problemi durante lo sviluppo di un'applicazione](https://docs.microsoft.com/azure/active-directory/active-directory-application-dev-development-content-map) sono disponibili collegamenti a vari articoli relativi al consenso.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-211">[Problems developing my application](https://docs.microsoft.com/azure/active-directory/active-directory-application-dev-development-content-map) provides links to various consent related articles.</span></span>

- <span data-ttu-id="5e4c8-212">[Gli oggetti Principal dell'applicazione e del servizio in Azure Active Directory (Azure ad)](https://docs.microsoft.com/azure/active-directory/develop/active-directory-application-objects) offrono una panoramica degli oggetti Principal del servizio e dell'applicazione che sono fondamentali per il modello di applicazione.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-212">[Application and service principal objects in Azure Active Directory (Azure AD)](https://docs.microsoft.com/azure/active-directory/develop/active-directory-application-objects) provides an overview of the Application and Service principal objects that are core to the application model.</span></span>

- <span data-ttu-id="5e4c8-213">[Manage Access to Apps](https://docs.microsoft.com/azure/active-directory/active-directory-managing-access-to-apps) è una panoramica delle funzionalità che gli amministratori devono gestire per la gestione dell'accesso degli utenti alle app.</span><span class="sxs-lookup"><span data-stu-id="5e4c8-213">[Manage access to apps](https://docs.microsoft.com/azure/active-directory/active-directory-managing-access-to-apps) is an overview of the capabilities that administrators have to manage user access to apps.</span></span>
