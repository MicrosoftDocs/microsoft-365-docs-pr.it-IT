---
title: Gestire i criteri di conservazione dei log di controllo
f1.keywords:
- NOCSH
ms.author: markjjo
author: markjjo
manager: laurawi
audience: Admin
ms.topic: article
ms.service: O365-seccomp
localization_priority: Priority
ms.collection:
- M365-security-compliance
- SPO_Content
search.appverid:
- MOE150
- MET150
ms.assetid: ''
description: I criteri di conservazione dei log di controllo fanno parte delle nuove funzionalità di Audit avanzato di Microsoft 365. Un criterio di conservazione dei log di controllo consente di specificare quanto a lungo conservare i log di controllo nell'organizzazione.
ms.openlocfilehash: b3534f5d0572b2656711850b483651270b9e3315
ms.sourcegitcommit: 50908a93554290ff1157b58d0a868a33e012513c
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 06/08/2021
ms.locfileid: "52822142"
---
# <a name="manage-audit-log-retention-policies"></a><span data-ttu-id="f816f-104">Gestire i criteri di conservazione dei log di controllo</span><span class="sxs-lookup"><span data-stu-id="f816f-104">Manage audit log retention policies</span></span>

<span data-ttu-id="f816f-105">È possibile creare e gestire i criteri di conservazione dei log di controllo nel Centro sicurezza e conformità.</span><span class="sxs-lookup"><span data-stu-id="f816f-105">You can create and manage audit log retention policies in the Security & Compliance Center.</span></span> <span data-ttu-id="f816f-106">I criteri di conservazione dei log di controllo fanno parte delle nuove funzionalità di Audit avanzato di Microsoft 365.</span><span class="sxs-lookup"><span data-stu-id="f816f-106">Audit log retention policies are part of the new Advanced Audit capabilities in Microsoft 365.</span></span> <span data-ttu-id="f816f-107">Un criterio di conservazione dei log di controllo consente di specificare quanto a lungo conservare i log di controllo nell'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="f816f-107">An audit log retention policy lets you specify how long to retain audit logs in your organization.</span></span> <span data-ttu-id="f816f-108">È possibile conservare i log di controllo per un massimo di 10 anni.</span><span class="sxs-lookup"><span data-stu-id="f816f-108">You can retain audit logs for up to 10 years.</span></span> <span data-ttu-id="f816f-109">È possibile creare criteri in base ai criteri seguenti:</span><span class="sxs-lookup"><span data-stu-id="f816f-109">You can create policies based on the following criteria:</span></span>

- <span data-ttu-id="f816f-110">Tutte le attività in uno o più servizi di Microsoft 365</span><span class="sxs-lookup"><span data-stu-id="f816f-110">All activities in one or more Microsoft 365 services</span></span>

- <span data-ttu-id="f816f-111">Attività specifiche (in un servizio Microsoft 365 specifico) eseguite da tutti gli utenti o da utenti specifici</span><span class="sxs-lookup"><span data-stu-id="f816f-111">Specific activities (in a Microsoft 365 service) performed by all users or by specific users</span></span>

- <span data-ttu-id="f816f-112">Un livello di priorità che specifica quale criterio ha la precedenza se sono presenti più criteri nell'organizzazione</span><span class="sxs-lookup"><span data-stu-id="f816f-112">A priority level that specifies which policy takes precedence in you have multiple policies in your organization</span></span>

## <a name="default-audit-log-retention-policy"></a><span data-ttu-id="f816f-113">Criterio di conservazione dei log di controllo predefinito</span><span class="sxs-lookup"><span data-stu-id="f816f-113">Default audit log retention policy</span></span>

<span data-ttu-id="f816f-114">Audit avanzato in Microsoft 365 include un criterio di conservazione dei log di controllo predefinito per tutte le organizzazioni.</span><span class="sxs-lookup"><span data-stu-id="f816f-114">Advanced Audit in Microsoft 365 provides a default audit log retention policy for all organizations.</span></span> <span data-ttu-id="f816f-115">Questo criterio conserva tutti i record di controllo di Exchange Online, SharePoint Online, OneDrive for Business e Azure Active Directory per un anno.</span><span class="sxs-lookup"><span data-stu-id="f816f-115">This policy retains all Exchange Online, SharePoint Online, OneDrive for Business, and Azure Active Directory audit records for one year.</span></span> <span data-ttu-id="f816f-116">Questo criterio predefinito conserva i record di controllo che contengono il valore di **Exchange**, **SharePoint**, **OneDrive**, **AzureActiveDirectory** per la proprietà **Carico di lavoro**, ossia il servizio in cui si è verificata l'attività.</span><span class="sxs-lookup"><span data-stu-id="f816f-116">This default policy retains audit records that contain the value of **Exchange**, **SharePoint**, **OneDrive**, **AzureActiveDirectory** for the **Workload** property (which is the service in which the activity occurred).</span></span> <span data-ttu-id="f816f-117">Il criterio predefinito non può essere modificato.</span><span class="sxs-lookup"><span data-stu-id="f816f-117">The default policy can't be modified.</span></span> <span data-ttu-id="f816f-118">Per un elenco dei tipi di record per ogni carico di lavoro inclusi nel criterio predefinito, vedere la sezione [Altre informazioni](#more-information) in questo articolo.</span><span class="sxs-lookup"><span data-stu-id="f816f-118">See the [More information](#more-information) section in this article for a list of record types for each workload that are included in the default policy.</span></span>

> [!NOTE]
> <span data-ttu-id="f816f-119">Il criterio di conservazione dei log di controllo predefinito si applica solo ai record di controllo per le attività eseguite dagli utenti a cui è assegnata una licenza di Office 365 o Microsoft 365 E5 o che hanno una licenza per il componente aggiuntivo Microsoft 365 E5 Compliance o Microsoft 365 E5 eDiscovery and Audit.</span><span class="sxs-lookup"><span data-stu-id="f816f-119">The default audit log retention policy only applies to audit records for activity performed by users who are assigned an Office 365 or Microsoft 365 E5 license or have a Microsoft 365 E5 Compliance or E5 eDiscovery and Audit add-on license.</span></span> <span data-ttu-id="f816f-120">Se nell'organizzazione sono presenti utenti o utenti guest non di E5, i record di controllo corrispondenti vengono conservati per 90 giorni.</span><span class="sxs-lookup"><span data-stu-id="f816f-120">If you have non-E5 users or guest users in your organization, their corresponding audit records are retained for 90 days.</span></span>

## <a name="before-you-create-an-audit-log-retention-policy"></a><span data-ttu-id="f816f-121">Prima di creare un criterio di conservazione dei log di controllo</span><span class="sxs-lookup"><span data-stu-id="f816f-121">Before you create an audit log retention policy</span></span>

- <span data-ttu-id="f816f-122">Per creare o modificare i criteri di conservazione dei log di controllo, è necessario avere il ruolo Configurazione organizzazione nel Centro sicurezza e conformità.</span><span class="sxs-lookup"><span data-stu-id="f816f-122">You have to be assigned the Organization Configuration role in the Security & Compliance Center to create or modify an audit retention policy.</span></span>

- <span data-ttu-id="f816f-123">Un'organizzazione può avere un massimo di 50 criteri di conservazione dei log di controllo.</span><span class="sxs-lookup"><span data-stu-id="f816f-123">You can have a maximum of 50 audit log retention policies in your organization.</span></span>

- <span data-ttu-id="f816f-124">Per conservare un log di controllo per più di 90 giorni (e fino a un anno), l'utente che genera il log di controllo (eseguendo un’attività controllata) deve avere una licenza di Office 365 E5 o Microsoft 365 E5 oppure una licenza per il componente aggiuntivo Audit Microsoft 365 E5 Compliance o E5 eDiscovery.</span><span class="sxs-lookup"><span data-stu-id="f816f-124">To retain an audit log for longer than 90 days (and up to 1 year), the user who generates the audit log (by performing an audited activity) must be assigned an Office 365 E5 or Microsoft 365 E5 license or have a Microsoft 365 E5 Compliance or E5 eDiscovery and Audit add-on license.</span></span> <span data-ttu-id="f816f-125">Per conservare i log di controllo per 10 anni, all'utente che genera il log di controllo deve anche essere assegnata una licenza per il componente aggiuntivo di conservazione dei log di controllo di 10 anni oltre a una licenza E5.</span><span class="sxs-lookup"><span data-stu-id="f816f-125">To retain audit logs for 10 years, the user who generates the audit log must also be assigned a 10-year audit log retention add-on license in addition to an E5 license.</span></span>

- <span data-ttu-id="f816f-p106">Tutti i criteri di conservazione dei log di controllo personalizzati, creati dall'organizzazione, hanno priorità sui criteri di conservazione predefiniti. Ad esempio, se si crea un criterio di conservazione dei log di controllo per l'attività delle cassette postali di Exchange con un periodo di conservazione più breve di un anno, i record di controllo delle attività delle cassette postali di Exchange verranno conservati per la durata più breve specificata dal criterio personalizzato.</span><span class="sxs-lookup"><span data-stu-id="f816f-p106">All custom audit log retention policies (created by your organization) take priority over the default retention policy. For example, if you create an audit log retention policy for Exchange mailbox activity that has a retention period that's shorter than one year, audit records for Exchange mailbox activities will be retained for the shorter duration specified by the custom policy.</span></span>

## <a name="create-an-audit-log-retention-policy"></a><span data-ttu-id="f816f-128">Creare un criterio di conservazione dei log di controllo</span><span class="sxs-lookup"><span data-stu-id="f816f-128">Create an audit log retention policy</span></span>

1. <span data-ttu-id="f816f-129">Passare a [https://compliance.microsoft.com](https://compliance.microsoft.com) e accedere con un account utente a cui è stato assegnato il ruolo Configurazione organizzazione nella pagina autorizzazioni nel Centro sicurezza e conformità.</span><span class="sxs-lookup"><span data-stu-id="f816f-129">Go to [https://compliance.microsoft.com](https://compliance.microsoft.com) and sign in with a user account that's assigned the Organization Configuration role on the Permissions page in the Security & Compliance Center.</span></span>

2. <span data-ttu-id="f816f-130">Nel riquadro sinistro del Centro conformità Microsoft 365, fare clic su **Mostra tutto**, quindi su **Audit**.</span><span class="sxs-lookup"><span data-stu-id="f816f-130">In the left pane of the Microsoft 365 compliance center, click **Show all**, and then click **Audit**.</span></span>

3. <span data-ttu-id="f816f-131">Fare clic sulla scheda **Criteri di conservazione dei log di controllo**.</span><span class="sxs-lookup"><span data-stu-id="f816f-131">Click the **Audit retention policies** tab.</span></span>

4. <span data-ttu-id="f816f-132">Fare clic su **Crea criteri di conservazione dei log di controllo** e completare poi i campi nel riquadro a comparsa:</span><span class="sxs-lookup"><span data-stu-id="f816f-132">Click **Create audit retention policy**, and then complete the following fields on the flyout page:</span></span>

    ![Nuovo riquadro a comparsa del criterio di conservazione dei log di controllo](../media/CreateAuditLogRetentionPolicy.png)

   1. <span data-ttu-id="f816f-134">**Nome del criterio:** il nome del criterio di conservazione dei log di controllo.</span><span class="sxs-lookup"><span data-stu-id="f816f-134">**Policy name:** The name of the audit log retention policy.</span></span> <span data-ttu-id="f816f-135">Il nome deve essere univoco nell'organizzazione e non può essere modificato dopo la creazione del criterio.</span><span class="sxs-lookup"><span data-stu-id="f816f-135">This name must be unique in your organization, and it can't be change after the policy is created.</span></span>

   2. <span data-ttu-id="f816f-136">**Descrizione:** facoltativo, ma è utile per fornire informazioni sul criterio, ad esempio il tipo di record o carico di lavoro, gli utenti specificati nel criterio e la durata.</span><span class="sxs-lookup"><span data-stu-id="f816f-136">**Description:** Optional, but helpful to provide information about the policy, such as the record type or workload, users specified in the policy, and the duration.</span></span>

   3. <span data-ttu-id="f816f-137">**Utenti:** selezionare uno o più utenti ai quali applicare il criterio.</span><span class="sxs-lookup"><span data-stu-id="f816f-137">**Users:** Select one or more users to apply the policy to.</span></span> <span data-ttu-id="f816f-138">Se si lascia la casella vuota, il criterio verrà applicato a tutti gli utenti.</span><span class="sxs-lookup"><span data-stu-id="f816f-138">If you leave this box blank, then the policy will apply to all users.</span></span> <span data-ttu-id="f816f-139">Se si lascia vuoto il campo **Tipo di record**, è necessario selezionare un utente.</span><span class="sxs-lookup"><span data-stu-id="f816f-139">If you leave the **Record type** blank, then you must select a user.</span></span>

   4. <span data-ttu-id="f816f-140">**Tipo di record:** il tipo di record di controllo a cui si applica il criterio.</span><span class="sxs-lookup"><span data-stu-id="f816f-140">**Record type:** The audit record type the policy applies to.</span></span> <span data-ttu-id="f816f-141">Se si lascia vuota questa proprietà, è necessario selezionare un utente nella casella **Utenti**.</span><span class="sxs-lookup"><span data-stu-id="f816f-141">If you leave this property blank, you must select a user in the **Users** box.</span></span> <span data-ttu-id="f816f-142">È possibile selezionare un tipo di record singolo o più tipi di record:</span><span class="sxs-lookup"><span data-stu-id="f816f-142">You can select a single record type or multiple record types:</span></span>

   - <span data-ttu-id="f816f-143">Se si seleziona un solo tipo di record, il campo **Attività** viene visualizzato dinamicamente.</span><span class="sxs-lookup"><span data-stu-id="f816f-143">If you select a single record type, the **Activities** field is dynamically displayed.</span></span> <span data-ttu-id="f816f-144">Si può usare l'elenco a discesa per selezionare le attività del tipo di record selezionato a cui applicare il criterio.</span><span class="sxs-lookup"><span data-stu-id="f816f-144">You can use the drop-down list to select activities from the selected record type to apply the policy to.</span></span> <span data-ttu-id="f816f-145">Se non si scelgono attività specifiche, il criterio verrà applicato a tutte le attività del tipo di record selezionato.</span><span class="sxs-lookup"><span data-stu-id="f816f-145">If you don't choose specific activities, the policy will apply to all activities of the selected record type.</span></span>

   - <span data-ttu-id="f816f-146">Se si selezionano più tipi di record, non è possibile selezionare le attività.</span><span class="sxs-lookup"><span data-stu-id="f816f-146">If you select multiple record types, you don't have the ability to select activities.</span></span> <span data-ttu-id="f816f-147">Il criterio si applica a tutte le attività dei tipi di record selezionati.</span><span class="sxs-lookup"><span data-stu-id="f816f-147">The policy will apply to all activities of the selected record types.</span></span>

   5. <span data-ttu-id="f816f-148">**Durata:** la quantità di tempo per cui conservare i log di audit che soddisfano i criteri del criterio.</span><span class="sxs-lookup"><span data-stu-id="f816f-148">**Duration:** The amount of time to retain the audit logs that meet the criteria of the policy.</span></span>

   6. <span data-ttu-id="f816f-149">**Priorità:** questo valore determina l'ordine con cui vengono elaborati i criteri di conservazione dei log di controllo nell'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="f816f-149">**Priority:** This value determines the order in which audit log retention policies in your organization are processed.</span></span> <span data-ttu-id="f816f-150">Un valore più basso indica una priorità più alta.</span><span class="sxs-lookup"><span data-stu-id="f816f-150">A lower value indicates a higher priority.</span></span> <span data-ttu-id="f816f-151">Le priorità valide sono valori numerici compresi tra **1** e **10000**.</span><span class="sxs-lookup"><span data-stu-id="f816f-151">Valid priorities are numerical values between **1** and **10000**.</span></span> <span data-ttu-id="f816f-152">Il valore **1** ha la priorità più alta e il valore **10000** ha quella più bassa.</span><span class="sxs-lookup"><span data-stu-id="f816f-152">A value of **1** is the highest priority, and a value of **10000** is the lowest priority.</span></span> <span data-ttu-id="f816f-153">Ad esempio, un criterio con un valore **5** avrà la priorità su un criterio con un valore **10**.</span><span class="sxs-lookup"><span data-stu-id="f816f-153">For example, a policy with a value of **5** takes priority over a policy with a value of **10**.</span></span> <span data-ttu-id="f816f-154">Come descritto in precedenza, i criteri di conservazione dei log di controllo personalizzati hanno la precedenza sul criterio predefinito per l'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="f816f-154">As previously explained, any custom audit log retention policy takes priority over the default policy for your organization.</span></span>

5. <span data-ttu-id="f816f-155">Fare clic su **Salva** per creare il nuovo criterio di conservazione dei log di controllo.</span><span class="sxs-lookup"><span data-stu-id="f816f-155">Click **Save** to create the new audit log retention policy.</span></span>

   <span data-ttu-id="f816f-156">Il nuovo criterio viene visualizzato nell'elenco nella scheda **Criteri di conservazione log di controllo**.</span><span class="sxs-lookup"><span data-stu-id="f816f-156">The new policy is displayed in the list on the **Audit retention policies** tab.</span></span>

## <a name="manage-audit-log-retention-policies"></a><span data-ttu-id="f816f-157">Gestire i criteri di conservazione dei log di controllo</span><span class="sxs-lookup"><span data-stu-id="f816f-157">Manage audit log retention policies</span></span>

<span data-ttu-id="f816f-158">I criteri di conservazione dei log di controllo sono elencati nella scheda **Criteri di conservazione dei log di controllo**, denominata anche *dashboard*.</span><span class="sxs-lookup"><span data-stu-id="f816f-158">Audit log retention policies are listed on the **Audit retention policies** tab (also called the *dashboard*).</span></span> <span data-ttu-id="f816f-159">È possibile usare il dashboard per visualizzare, modificare ed eliminare i criteri di conservazione dei log di controllo.</span><span class="sxs-lookup"><span data-stu-id="f816f-159">You can use the dashboard to view, edit, and delete audit retention policies.</span></span>

### <a name="view-policies-in-the-dashboard"></a><span data-ttu-id="f816f-160">Visualizzazione dei criteri nel dashboard</span><span class="sxs-lookup"><span data-stu-id="f816f-160">View policies in the dashboard</span></span>

<span data-ttu-id="f816f-161">I criteri di conservazione dei log di controllo sono elencati nel dashboard.</span><span class="sxs-lookup"><span data-stu-id="f816f-161">Audit log retention policies are listed in the dashboard.</span></span> <span data-ttu-id="f816f-162">Uno dei vantaggi della visualizzazione dei criteri nel dashboard è che è possibile fare clic sulla colonna **Priorità** per elencare i criteri in base alla priorità con cui vengono applicati.</span><span class="sxs-lookup"><span data-stu-id="f816f-162">One advantage of viewing policies in the dashboard is that you can click the **Priority** column to list the policies in the priority in which they are applied.</span></span> <span data-ttu-id="f816f-163">Come spiegato in precedenza, un valore più alto indica una priorità più elevata.</span><span class="sxs-lookup"><span data-stu-id="f816f-163">As previously explained, a higher value indicates a higher priority.</span></span>

![Colonna Priorità nel dashboard dei criteri di conservazione dei log di controllo](../media/AuditLogRetentionDashboardPriority.png)

<span data-ttu-id="f816f-165">È anche possibile selezionare un criterio per visualizzarne le impostazioni nel riquadro a comparsa.</span><span class="sxs-lookup"><span data-stu-id="f816f-165">You can also select a policy to display its settings on the flyout page.</span></span>

> [!NOTE]
> <span data-ttu-id="f816f-166">I criteri di conservazione predefiniti dei log di controllo per l'organizzazione non vengono visualizzati nel dashboard.</span><span class="sxs-lookup"><span data-stu-id="f816f-166">The default audit log retention policy for your organization isn't displayed in the dashboard.</span></span>

### <a name="edit-policies-in-the-dashboard"></a><span data-ttu-id="f816f-167">Modifica dei criteri nel dashboard</span><span class="sxs-lookup"><span data-stu-id="f816f-167">Edit policies in the dashboard</span></span>

<span data-ttu-id="f816f-168">Per modificare un criterio, selezionarlo in modo da visualizzare il riquadro a comparsa.</span><span class="sxs-lookup"><span data-stu-id="f816f-168">To edit a policy, select it to display the flyout page.</span></span> <span data-ttu-id="f816f-169">È possibile modificare una o più impostazioni poi salvare le modifiche.</span><span class="sxs-lookup"><span data-stu-id="f816f-169">You can modify one or more setting and then save your changes.</span></span>


> [!IMPORTANT]
> <span data-ttu-id="f816f-170">Se si usa il cmdlet **New-UnifiedAuditLogRetentionPolicy**, è possibile creare un criterio di conservazione dei log di controllo per i tipi di record o le attività non disponibili nello strumento **Crea criteri di conservazione dei log di controllo** del dashboard.</span><span class="sxs-lookup"><span data-stu-id="f816f-170">If you use the **New-UnifiedAuditLogRetentionPolicy** cmdlet, it's possible to create an audit log retention policy for record types or activities that aren't available in the **Create audit retention policy** tool in the dashboard.</span></span> <span data-ttu-id="f816f-171">In questo caso, non sarà possibile modificare il criterio, ad esempio modificare la durata di conservazione o aggiungere e rimuovere attività, dal dashboard **Criteri di conservazione dei log di controllo**.</span><span class="sxs-lookup"><span data-stu-id="f816f-171">In this case, you won't be able to edit the policy (for example, change the retention duration or add and remove activities) from the **Audit retention policies** dashboard.</span></span> <span data-ttu-id="f816f-172">Nel centro conformità si potrà solo visualizzare ed eliminare il criterio.</span><span class="sxs-lookup"><span data-stu-id="f816f-172">You'll only be able to view and delete the policy in the compliance center.</span></span> <span data-ttu-id="f816f-173">Per modificarlo sarà necessario usare il cmdlet [Set-UnifiedAuditLogRetentionPolicy](/powershell/module/exchange/set-unifiedauditlogretentionpolicy) in PowerShell per Centro sicurezza e conformità.</span><span class="sxs-lookup"><span data-stu-id="f816f-173">To edit the policy, you'll have to use the [Set-UnifiedAuditLogRetentionPolicy](/powershell/module/exchange/set-unifiedauditlogretentionpolicy) cmdlet in Security & Compliance Center PowerShell.</span></span><br/><br/><span data-ttu-id="f816f-174">**Suggerimento:** nella parte superiore del riquadro a comparsa viene visualizzato un messaggio per i criteri che devono essere modificati tramite PowerShell.</span><span class="sxs-lookup"><span data-stu-id="f816f-174">**Tip:** A message is displayed at the top of the flyout page for policies that have to be edited using PowerShell.</span></span>

### <a name="delete-policies-in-the-dashboard"></a><span data-ttu-id="f816f-175">Eliminare i criteri nel dashboard</span><span class="sxs-lookup"><span data-stu-id="f816f-175">Delete policies in the dashboard</span></span>

<span data-ttu-id="f816f-176">Per eliminare un criterio, fare clic sull’icona **Elimina** ![icona Elimina](../media/92a9f8e0-d469-48da-addb-69365e7ffb6f.jpg) e confermare che si desidera eliminare il criterio.</span><span class="sxs-lookup"><span data-stu-id="f816f-176">To delete a policy, click the **Delete** ![Delete icon](../media/92a9f8e0-d469-48da-addb-69365e7ffb6f.jpg) icon and then confirm that you want to delete the policy.</span></span> <span data-ttu-id="f816f-177">I criteri vengono rimossi dal dashboard, ma potrebbero essere necessari fino a 30 minuti prima che il criterio venga rimosso dall'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="f816f-177">The policy is removed from the dashboard, but it might take up to 30 minutes for the policy to be removed from your organization.</span></span>

## <a name="create-and-manage-audit-log-retention-policies-in-powershell"></a><span data-ttu-id="f816f-178">Creare e gestire i criteri di conservazione del log di controllo in PowerShell</span><span class="sxs-lookup"><span data-stu-id="f816f-178">Create and manage audit log retention policies in PowerShell</span></span>

<span data-ttu-id="f816f-179">Per creare e gestire i criteri di conservazione dei log di controllo è possibile anche usare PowerShell per Centro sicurezza e conformità.</span><span class="sxs-lookup"><span data-stu-id="f816f-179">You can also use Security & Compliance Center PowerShell to create and manage audit log retention policies.</span></span> <span data-ttu-id="f816f-180">Uno dei motivi per cui usare PowerShell è la possibilità di creare un criterio per un tipo di record o un'attività non disponibile nell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="f816f-180">One reason to use PowerShell is to create a policy for a record type or activity that isn't available in the UI.</span></span>

### <a name="create-an-audit-log-retention-policy-in-powershell"></a><span data-ttu-id="f816f-181">Creare un criterio di conservazione dei log di controllo in PowerShell</span><span class="sxs-lookup"><span data-stu-id="f816f-181">Create an audit log retention policy in PowerShell</span></span>

<span data-ttu-id="f816f-182">Seguire questa procedura per creare criteri di conservazione del log di controllo in PowerShell:</span><span class="sxs-lookup"><span data-stu-id="f816f-182">Follow these steps to create an audit log retention policy in PowerShell:</span></span>

1. <span data-ttu-id="f816f-183">[Connettersi a PowerShell in Centro sicurezza e conformità](/powershell/exchange/connect-to-scc-powershell).</span><span class="sxs-lookup"><span data-stu-id="f816f-183">[Connect to Security & Compliance Center PowerShell](/powershell/exchange/connect-to-scc-powershell).</span></span>

2. <span data-ttu-id="f816f-184">Eseguire il comando seguente per creare un criterio di conservazione dei log di controllo.</span><span class="sxs-lookup"><span data-stu-id="f816f-184">Run the following command to create an audit log retention policy.</span></span>

   ```powershell
   New-UnifiedAuditLogRetentionPolicy -Name "Microsoft Teams Audit Policy" -Description "One year retention policy for all Microsoft Teams activities" -RecordTypes MicrosoftTeams -RetentionDuration TenYears -Priority 100
   ```

    <span data-ttu-id="f816f-185">In questo esempio viene creato un criterio di conservazione dei log di controllo denominato "Microsoft Teams Audit Policy" con queste impostazioni:</span><span class="sxs-lookup"><span data-stu-id="f816f-185">This example creates an audit log retention policy named "Microsoft Teams Audit Policy" with these settings:</span></span>

   - <span data-ttu-id="f816f-186">Una descrizione del criterio.</span><span class="sxs-lookup"><span data-stu-id="f816f-186">A description of the policy.</span></span>

   - <span data-ttu-id="f816f-187">Conserva tutte le attività di Microsoft Teams (come definito dal parametro *RecordType*).</span><span class="sxs-lookup"><span data-stu-id="f816f-187">Retains all Microsoft Teams activities (as defined by the *RecordType* parameter).</span></span>

   - <span data-ttu-id="f816f-188">Conserva i log di controllo di Microsoft Teams per 10 anni.</span><span class="sxs-lookup"><span data-stu-id="f816f-188">Retains Microsoft Teams audit logs for 10 years.</span></span>

   - <span data-ttu-id="f816f-189">Una priorità di 100.</span><span class="sxs-lookup"><span data-stu-id="f816f-189">A priority of 100.</span></span>

<span data-ttu-id="f816f-190">Ecco un altro esempio relativo alla creazione di un criterio di conservazione dei log di controllo.</span><span class="sxs-lookup"><span data-stu-id="f816f-190">Here's another example of creating an audit log retention policy.</span></span> <span data-ttu-id="f816f-191">Questo criterio conserva i log di controllo per l'attività "L'utente ha effettuato l'accesso" per sei mesi per l'utente admin@contoso.onmicrosoft.com.</span><span class="sxs-lookup"><span data-stu-id="f816f-191">This policy retains audit logs for the "User logged in" activity for six months for the user admin@contoso.onmicrosoft.com.</span></span>

```powershell
New-UnifiedAuditLogRetentionPolicy -Name "SixMonth retention for admin logons" -RecordTypes AzureActiveDirectoryStsLogon -Operations UserLoggedIn -UserIds admin@contoso.onmicrosoft.com -RetentionDuration SixMonths -Priority 25
```

<span data-ttu-id="f816f-192">Per altre informazioni, vedere [New-UnifiedAuditLogRetentionPolicy](/powershell/module/exchange/new-unifiedauditlogretentionpolicy).</span><span class="sxs-lookup"><span data-stu-id="f816f-192">For more information, see [New-UnifiedAuditLogRetentionPolicy](/powershell/module/exchange/new-unifiedauditlogretentionpolicy).</span></span>

### <a name="view-policies-in-powershell"></a><span data-ttu-id="f816f-193">Visualizzazione dei criteri in PowerShell</span><span class="sxs-lookup"><span data-stu-id="f816f-193">View policies in PowerShell</span></span>

<span data-ttu-id="f816f-194">Usare il cmdlet [Get-UnifiedAuditLogRetentionPolicy](/powershell/module/exchange/get-unifiedauditlogretentionpolicy) in PowerShell per Centro sicurezza e conformità per visualizzare i criteri di conservazione dei log di controllo.</span><span class="sxs-lookup"><span data-stu-id="f816f-194">Use the [Get-UnifiedAuditLogRetentionPolicy](/powershell/module/exchange/get-unifiedauditlogretentionpolicy) cmdlet in Security & Compliance Center PowerShell to view audit log retention policies.</span></span>

<span data-ttu-id="f816f-195">Ecco un comando di esempio per visualizzare le impostazioni di tutti i criteri di conservazione dei log di controllo nell'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="f816f-195">Here's a sample command to display the settings for all audit log retention policies in your organization.</span></span> <span data-ttu-id="f816f-196">Questo comando ordina i criteri dalla priorità più alta a quella più bassa.</span><span class="sxs-lookup"><span data-stu-id="f816f-196">This command sorts the policies from the highest to lowest priority.</span></span>

```powershell
Get-UnifiedAuditLogRetentionPolicy | Sort-Object -Property Priority -Descending | FL Priority,Name,Description,RecordTypes,Operations,UserIds,RetentionDuration
```

> [!NOTE]
> <span data-ttu-id="f816f-197">Il cmdlet **Get-UnifiedAuditLogRetentionPolicy** non restituisce il criterio di conservazione dei log di controllo predefinito per l'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="f816f-197">The **Get-UnifiedAuditLogRetentionPolicy** cmdlet doesn't return the default audit log retention policy for your organization.</span></span>

### <a name="edit-policies-in-powershell"></a><span data-ttu-id="f816f-198">Modificare i criteri in PowerShell</span><span class="sxs-lookup"><span data-stu-id="f816f-198">Edit policies in PowerShell</span></span>

<span data-ttu-id="f816f-199">Usare il cmdlet [Set-UnifiedAuditLogRetentionPolicy](/powershell/module/exchange/set-unifiedauditlogretentionpolicy) in PowerShell per Centro sicurezza e conformità per modificare un criterio di conservazione dei log di controllo esistente.</span><span class="sxs-lookup"><span data-stu-id="f816f-199">Use the [Set-UnifiedAuditLogRetentionPolicy](/powershell/module/exchange/set-unifiedauditlogretentionpolicy) cmdlet in Security & Compliance Center PowerShell to edit an existing audit log retention policy.</span></span>

### <a name="delete-policies-in-powershell"></a><span data-ttu-id="f816f-200">Eliminare criteri in PowerShell</span><span class="sxs-lookup"><span data-stu-id="f816f-200">Delete policies in PowerShell</span></span>

<span data-ttu-id="f816f-201">Usare il cmdlet [Remove-UnifiedAuditLogRetentionPolicy](/powershell/module/exchange/remove-unifiedauditlogretentionpolicy) in PowerShell per Centro sicurezza e conformità per eliminare un criterio di conservazione dei log di controllo.</span><span class="sxs-lookup"><span data-stu-id="f816f-201">Use the [Remove-UnifiedAuditLogRetentionPolicy](/powershell/module/exchange/remove-unifiedauditlogretentionpolicy) cmdlet in Security & Compliance Center PowerShell to delete an audit log retention policy.</span></span> <span data-ttu-id="f816f-202">La rimozione dei criteri dall'organizzazione può richiedere fino a 30 minuti.</span><span class="sxs-lookup"><span data-stu-id="f816f-202">It might take up to 30 minutes for the policy to be removed from your organization.</span></span>

## <a name="more-information"></a><span data-ttu-id="f816f-203">Altre informazioni</span><span class="sxs-lookup"><span data-stu-id="f816f-203">More information</span></span>

<span data-ttu-id="f816f-204">Come illustrato in precedenza, i record di controllo per le operazioni in Azure Active Directory, Exchange Online, SharePoint Online e OneDrive for Business vengono conservati per un anno per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="f816f-204">As previously stated, audit records for operations in Azure Active Directory, Exchange Online, SharePoint Online, and OneDrive for Business, are retained for one year by default.</span></span> <span data-ttu-id="f816f-205">Nella tabelle seguenti sono elencati tutti i tipi di record, per ognuno di questi servizi, inclusi nel criterio di conservazione dei log di controllo predefinito.</span><span class="sxs-lookup"><span data-stu-id="f816f-205">The following table lists all the record types (for each of these services) included in the default audit log retention policy.</span></span> <span data-ttu-id="f816f-206">Ciò significa che i log di controllo per qualsiasi operazione con questo tipo di record vengono conservati per un anno, a meno che non abbia la precedenza un criterio di conservazione dei log di controllo personalizzato per un tipo di record, un'operazione o un utente specifico.</span><span class="sxs-lookup"><span data-stu-id="f816f-206">This means that audit logs for any operation with this record type are retained for one year unless a custom audit log retention policy takes precedence for a specific record type, operation, or user.</span></span> <span data-ttu-id="f816f-207">Il valore Enum per ogni tipo di record, che viene visualizzato come valore per la proprietà RecordType in un record di controllo, compare tra parentesi.</span><span class="sxs-lookup"><span data-stu-id="f816f-207">The Enum value (which is displayed as the value for the RecordType property in an audit record) for each record type is shown in parentheses.</span></span>

|<span data-ttu-id="f816f-208">AzureActiveDirectory</span><span class="sxs-lookup"><span data-stu-id="f816f-208">AzureActiveDirectory</span></span> |<span data-ttu-id="f816f-209">Exchange</span><span class="sxs-lookup"><span data-stu-id="f816f-209">Exchange</span></span>  |<span data-ttu-id="f816f-210">SharePoint o OneDrive</span><span class="sxs-lookup"><span data-stu-id="f816f-210">SharePoint or OneDrive</span></span>|
|:---------|:---------|:---------|
|<span data-ttu-id="f816f-211">AzureActiveDirectory (8)</span><span class="sxs-lookup"><span data-stu-id="f816f-211">AzureActiveDirectory (8)</span></span>|<span data-ttu-id="f816f-212">ExchangeAdmin (1)</span><span class="sxs-lookup"><span data-stu-id="f816f-212">ExchangeAdmin (1)</span></span>|<span data-ttu-id="f816f-213">ComplianceDLPSharePoint (11)</span><span class="sxs-lookup"><span data-stu-id="f816f-213">ComplianceDLPSharePoint (11)</span></span>|
|<span data-ttu-id="f816f-214">AzureActiveDirectoryAccountLogon (9)</span><span class="sxs-lookup"><span data-stu-id="f816f-214">AzureActiveDirectoryAccountLogon (9)</span></span>|<span data-ttu-id="f816f-215">ExchangeItem (2)</span><span class="sxs-lookup"><span data-stu-id="f816f-215">ExchangeItem (2)</span></span>|<span data-ttu-id="f816f-216">ComplianceDLPSharePointClassification (33)</span><span class="sxs-lookup"><span data-stu-id="f816f-216">ComplianceDLPSharePointClassification (33)</span></span>|
|<span data-ttu-id="f816f-217">AzureActiveDirectoryStsLogon (15)</span><span class="sxs-lookup"><span data-stu-id="f816f-217">AzureActiveDirectoryStsLogon (15)</span></span>|<span data-ttu-id="f816f-218">Campaign (62)</span><span class="sxs-lookup"><span data-stu-id="f816f-218">Campaign (62)</span></span>|<span data-ttu-id="f816f-219">Project (35)</span><span class="sxs-lookup"><span data-stu-id="f816f-219">Project (35)</span></span>|
||<span data-ttu-id="f816f-220">ComplianceDLPExchange (13)</span><span class="sxs-lookup"><span data-stu-id="f816f-220">ComplianceDLPExchange (13)</span></span>|<span data-ttu-id="f816f-221">SharePoint (4)</span><span class="sxs-lookup"><span data-stu-id="f816f-221">SharePoint (4)</span></span>|
||<span data-ttu-id="f816f-222">ComplianceSupervisionExchange (68)</span><span class="sxs-lookup"><span data-stu-id="f816f-222">ComplianceSupervisionExchange (68)</span></span>|<span data-ttu-id="f816f-223">SharePointCommentOperation (37)</span><span class="sxs-lookup"><span data-stu-id="f816f-223">SharePointCommentOperation (37)</span></span>|
||<span data-ttu-id="f816f-224">CustomerKeyServiceEncryption (69)</span><span class="sxs-lookup"><span data-stu-id="f816f-224">CustomerKeyServiceEncryption (69)</span></span>|<span data-ttu-id="f816f-225">SharePointContentTypeOperation (55)</span><span class="sxs-lookup"><span data-stu-id="f816f-225">SharePointContentTypeOperation (55)</span></span>|
||<span data-ttu-id="f816f-226">ExchangeAggregatedOperation (19)</span><span class="sxs-lookup"><span data-stu-id="f816f-226">ExchangeAggregatedOperation (19)</span></span>|<span data-ttu-id="f816f-227">SharePointFieldOperation (56)</span><span class="sxs-lookup"><span data-stu-id="f816f-227">SharePointFieldOperation (56)</span></span>|
||<span data-ttu-id="f816f-228">ExchangeItemAggregated (50)</span><span class="sxs-lookup"><span data-stu-id="f816f-228">ExchangeItemAggregated (50)</span></span>|<span data-ttu-id="f816f-229">SharePointFileOperation (6)</span><span class="sxs-lookup"><span data-stu-id="f816f-229">SharePointFileOperation (6)</span></span>|
||<span data-ttu-id="f816f-230">ExchangeItemGroup (3)</span><span class="sxs-lookup"><span data-stu-id="f816f-230">ExchangeItemGroup (3)</span></span>|<span data-ttu-id="f816f-231">SharePointListOperation (36)</span><span class="sxs-lookup"><span data-stu-id="f816f-231">SharePointListOperation (36)</span></span>|
||<span data-ttu-id="f816f-232">InformationBarrierPolicyApplication (53)</span><span class="sxs-lookup"><span data-stu-id="f816f-232">InformationBarrierPolicyApplication (53)</span></span>|<span data-ttu-id="f816f-233">SharePointSharingOperation (14)</span><span class="sxs-lookup"><span data-stu-id="f816f-233">SharePointSharingOperation (14)</span></span>|
||||
