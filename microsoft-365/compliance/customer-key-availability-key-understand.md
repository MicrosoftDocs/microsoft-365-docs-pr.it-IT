---
title: Informazioni sulla chiave di disponibilità per la chiave del cliente di Office 365
ms.author: krowley
author: kccross
manager: laurawi
ms.date: 02/05/2020
audience: ITPro
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
description: Informazioni sulla chiave di disponibilità utilizzata per recuperare le chiavi dei clienti di Office 365 perse.
ms.openlocfilehash: b363d3b90c6ea783bd051bea6c44a94689b87ac1
ms.sourcegitcommit: 5ff1dc62e8855be155cb2de45cf4ee5a02c321fd
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 02/06/2020
ms.locfileid: "41804811"
---
# <a name="learn-about-the-availability-key-for-office-365-customer-key"></a><span data-ttu-id="aa9d8-103">Informazioni sulla chiave di disponibilità per la chiave del cliente di Office 365</span><span class="sxs-lookup"><span data-stu-id="aa9d8-103">Learn about the availability key for Office 365 Customer Key</span></span>

<span data-ttu-id="aa9d8-104">La chiave di disponibilità è una chiave radice generata e provisioning automaticamente quando si crea un criterio di crittografia dei dati.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-104">The availability key is a root key automatically generated and provisioned when you create a data encryption policy.</span></span> <span data-ttu-id="aa9d8-105">Office 365 archivia e protegge il codice di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-105">Office 365 stores and protects the availability key.</span></span> <span data-ttu-id="aa9d8-106">Il codice di disponibilità è funzionalmente analogo alle due chiavi radice fornite per la crittografia del servizio con la chiave del cliente.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-106">The availability key is functionally similar to the two root keys that you supply for service encryption with Customer Key.</span></span> <span data-ttu-id="aa9d8-107">Il tasto disponibilità esegue il wrapping delle chiavi di un livello inferiore nella gerarchia delle chiavi.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-107">The availability key wraps the keys one tier lower in the key hierarchy.</span></span> <span data-ttu-id="aa9d8-108">A differenza delle chiavi fornite e gestite in Azure Key Vault, non è possibile accedere direttamente alla chiave di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-108">Unlike the keys that you provide and manage in Azure Key Vault, you can't directly access the availability key.</span></span> <span data-ttu-id="aa9d8-109">Servizi automatizzati di Office 365 gestire la chiave di disponibilità utilizzando i cmdlet di PowerShell.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-109">Office 365 automated services manage the availability key using PowerShell cmdlets.</span></span> <span data-ttu-id="aa9d8-110">Questi cmdlet avviano operazioni automatizzate che non coinvolgono mai l'accesso diretto al codice di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-110">These cmdlets initiate automated operations that never involve direct access to the availability key.</span></span>

<span data-ttu-id="aa9d8-111">Lo scopo principale del codice di disponibilità è fornire funzionalità di ripristino dalla perdita imprevista delle chiavi radice gestite.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-111">The primary purpose of the availability key is to provide recovery capability from the unanticipated loss of root keys that you manage.</span></span> <span data-ttu-id="aa9d8-112">La perdita potrebbe essere il risultato di una cattiva gestione o di un'azione dannosa.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-112">Loss could be a result of mismanagement or malicious action.</span></span> <span data-ttu-id="aa9d8-113">Se si perde il controllo delle chiavi principali, contattare il supporto tecnico Microsoft e Microsoft fornisce assistenza tramite il processo di ripristino tramite il codice di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-113">If you lose control of your root keys, contact Microsoft Support and Microsoft will assist you through the process of recovery using the availability key.</span></span> <span data-ttu-id="aa9d8-114">Si utilizzerà la chiave di disponibilità per eseguire la migrazione a un nuovo criterio di crittografia dei dati con le nuove chiavi di root provisioning.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-114">You'll use the availability key to migrate to a new Data Encryption Policy with new root keys you provision.</span></span>

<span data-ttu-id="aa9d8-115">Lo spazio di archiviazione e il controllo della chiave di disponibilità sono deliberatamente diversi dai tasti del Vault Key di Azure per tre motivi:</span><span class="sxs-lookup"><span data-stu-id="aa9d8-115">Storage and control of the availability key are deliberately different from Azure Key Vault keys for three reasons:</span></span>

- <span data-ttu-id="aa9d8-116">Il tasto disponibilità fornisce una funzionalità di ripristino, ovvero "Break-Glass", se il controllo su entrambe le chiavi del Vault Key di Azure viene perso.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-116">The availability key provides a recovery, "break-glass" capability if control over both Azure Key Vault keys is lost.</span></span>
- <span data-ttu-id="aa9d8-117">La separazione dei controlli logici e delle posizioni di archiviazione sicure fornisce una difesa approfondita e protegge dalla perdita di tutte le chiavi e dei dati, da un singolo attacco o da un punto di errore.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-117">The separation of logical controls and secure storage locations provides defense-in-depth and protects against the loss of all keys, and your data, from a single attack or point of failure.</span></span>
- <span data-ttu-id="aa9d8-118">La chiave di disponibilità fornisce una funzionalità di disponibilità elevata se i servizi di Office 365 non sono in grado di raggiungere le chiavi ospitate in Azure Key Vault a causa di errori temporanei.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-118">The availability key provides a high-availability capability if Office 365 services are unable to reach keys hosted in Azure Key Vault due to transient errors.</span></span> <span data-ttu-id="aa9d8-119">Questa regola si applica solo alla crittografia del servizio Exchange Online e Skype for business.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-119">This rule only applies to Exchange Online and Skype for Business service encryption.</span></span> <span data-ttu-id="aa9d8-120">I file di SharePoint Online, OneDrive for business e teams non utilizzano mai il codice di disponibilità, a meno che non si indichi esplicitamente a Microsoft di avviare il processo di ripristino.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-120">SharePoint Online, OneDrive for Business, and Teams files never use the availability key unless you explicitly instruct Microsoft to initiate the recovery process.</span></span>

<span data-ttu-id="aa9d8-121">Condividendo la responsabilità di proteggere i dati, utilizzando una vasta gamma di protezioni e processi per la gestione delle chiavi, si riduce il rischio che tutte le chiavi (e quindi i dati) vengano definitivamente perse o distrutte.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-121">Sharing the responsibility to protect your data, using a variety of protections and processes for key management, ultimately reduces the risk that all keys (and therefore your data) will be permanently lost or destroyed.</span></span> <span data-ttu-id="aa9d8-122">Microsoft fornisce l'autorità esclusiva per la disabilitazione o la distruzione del codice di disponibilità quando si lascia il servizio.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-122">Microsoft provides you with sole authority over the disablement or destruction of the availability key when you leave the service.</span></span> <span data-ttu-id="aa9d8-123">In base alla progettazione, nessuno di Microsoft ha accesso alla chiave di disponibilità: è accessibile solo dal codice del servizio di Office 365.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-123">By design, no one at Microsoft has access to the availability key: it is only accessible by Office 365 service code.</span></span>

<span data-ttu-id="aa9d8-124">Per ulteriori informazioni sulla protezione delle chiavi, vedere il [Centro protezione Microsoft](https://www.microsoft.com/trustcenter/Privacy/govt-requests-for-data) .</span><span class="sxs-lookup"><span data-stu-id="aa9d8-124">See the [Microsoft Trust Center](https://www.microsoft.com/trustcenter/Privacy/govt-requests-for-data) for more information about how we secure keys.</span></span>
  
## <a name="availability-key-uses"></a><span data-ttu-id="aa9d8-125">Utilizzo delle chiavi di disponibilità</span><span class="sxs-lookup"><span data-stu-id="aa9d8-125">Availability key uses</span></span>

<span data-ttu-id="aa9d8-126">La chiave di disponibilità fornisce funzionalità di ripristino per gli scenari in cui un malfattore esterno o un insider dannoso ruba il controllo del Vault chiave, o quando la cattiva gestione accidentale determina la perdita delle chiavi principali.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-126">The availability key provides recovery capability for scenarios in which an external malefactor or malicious insider steals control of your key vault, or when inadvertent mismanagement results in loss of root keys.</span></span> <span data-ttu-id="aa9d8-127">Questa funzionalità di ripristino si applica a tutti i servizi di Office 365 compatibili con la chiave del cliente.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-127">This recovery capability applies to all Office 365 services compatible with Customer Key.</span></span> <span data-ttu-id="aa9d8-128">I singoli servizi utilizzano la chiave di disponibilità in modo diverso.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-128">Individual services use the availability key differently.</span></span> <span data-ttu-id="aa9d8-129">Office 365 utilizza solo la chiave di disponibilità nei modi descritti di seguito.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-129">Office 365 only uses the availability key in the ways described below.</span></span>

### <a name="exchange-online-and-skype-for-business-uses"></a><span data-ttu-id="aa9d8-130">Utilizzo di Exchange Online e Skype for business</span><span class="sxs-lookup"><span data-stu-id="aa9d8-130">Exchange Online and Skype for Business uses</span></span>

<span data-ttu-id="aa9d8-131">Oltre alla funzionalità di ripristino, Exchange Online e Skype for business utilizzano la chiave di disponibilità per garantire la disponibilità dei dati in caso di problemi operativi transitori o intermittenti relativi al servizio che accede alle chiavi principali.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-131">In addition to the recovery capability, Exchange Online and Skype for Business use the availability key to ensure data availability during transient, or intermittent operational issues, related to the service accessing root keys.</span></span> <span data-ttu-id="aa9d8-132">Quando il servizio non è in grado di raggiungere nessuna delle chiavi del cliente in Azure Key Vault a causa di errori transitori, il servizio utilizza automaticamente il codice di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-132">When the service cannot reach either of your Customer Keys in Azure Key Vault due to transient errors, the service automatically uses the availability key.</span></span> <span data-ttu-id="aa9d8-133">Il servizio non passa mai direttamente al codice di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-133">The service NEVER goes directly to the availability key.</span></span>

<span data-ttu-id="aa9d8-134">I sistemi automatizzati in Exchange Online e Skype for business possono utilizzare la chiave di disponibilità durante gli errori temporanei per supportare i servizi back-end automatici, ad esempio antivirus, e-Discovery, la prevenzione della perdita di dati, gli spostamenti delle cassette postali e l'indicizzazione dei dati.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-134">Automated systems in Exchange Online and Skype for Business may use the availability key during transient errors to support automated back-end services such as anti-virus, e-discovery, data loss prevention, mailbox moves, and data indexing.</span></span>

### <a name="sharepointonlineonedriveforbusinessandteamsfiles-uses"></a><span data-ttu-id="aa9d8-135">Utilizzo dei file di SharePoint Online, OneDrive for business e teams</span><span class="sxs-lookup"><span data-stu-id="aa9d8-135">SharePoint Online, OneDrive for Business, and Teams files uses</span></span>

<span data-ttu-id="aa9d8-136">Per i file di SharePoint Online, OneDrive for business e teams, la chiave di disponibilità non viene mai utilizzata al di fuori della funzionalità di ripristino e i clienti devono indicare esplicitamente a Microsoft di avviare l'utilizzo della chiave di disponibilità durante uno scenario di ripristino.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-136">For SharePoint Online, OneDrive for Business, and Teams files, the availability key is NEVER used outside of the recovery capability and customers must explicitly instruct Microsoft to initiate use of the availability key during a recovery scenario.</span></span> <span data-ttu-id="aa9d8-137">Le operazioni di servizio automatizzate si basano esclusivamente sulle chiavi dei clienti in Azure Key Vault.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-137">Automated service operations solely rely on your Customer Keys in Azure Key vault.</span></span> <span data-ttu-id="aa9d8-138">Per informazioni approfondite su come funziona la gerarchia delle chiavi per questi servizi, vedere [How SharePoint Online, OneDrive for business e teams files use the availability Key](#how-sharepoint-online-onedrive-for-business-and-teams-files-use-the-availability-key).</span><span class="sxs-lookup"><span data-stu-id="aa9d8-138">For in-depth information about how the key hierarchy works for these services, see [How SharePoint Online, OneDrive for Business, and Teams files use the availability key](#how-sharepoint-online-onedrive-for-business-and-teams-files-use-the-availability-key).</span></span>

## <a name="availability-key-security"></a><span data-ttu-id="aa9d8-139">Sicurezza delle chiavi di disponibilità</span><span class="sxs-lookup"><span data-stu-id="aa9d8-139">Availability key security</span></span>

<span data-ttu-id="aa9d8-140">Microsoft condivide la responsabilità della protezione dei dati con l'utente creando un'istanza del codice di disponibilità e adottando misure estese per proteggerlo.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-140">Microsoft shares the responsibility of data protection with you by instantiating the availability key and taking extensive measures to protect it.</span></span> <span data-ttu-id="aa9d8-141">Microsoft non espone il controllo diretto della chiave di disponibilità ai clienti.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-141">Microsoft does not expose direct control of the availability key to customers.</span></span> <span data-ttu-id="aa9d8-142">Ad esempio, è possibile eseguire il rollback solo delle chiavi di cui si dispone in Azure Key Vault.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-142">For example, you can only roll (rotate) the keys that you own in Azure Key Vault.</span></span> <span data-ttu-id="aa9d8-143">Per ulteriori informazioni, vedere [Roll or rotate a Customer Key o a availability Key](customer-key-availability-key-roll.md).</span><span class="sxs-lookup"><span data-stu-id="aa9d8-143">For more information, see [Roll or rotate a customer key or an availability key](customer-key-availability-key-roll.md).</span></span>

### <a name="availability-key-secret-stores"></a><span data-ttu-id="aa9d8-144">Archivi segreti chiave di disponibilità</span><span class="sxs-lookup"><span data-stu-id="aa9d8-144">Availability key secret stores</span></span>

<span data-ttu-id="aa9d8-145">Microsoft protegge le chiavi di disponibilità negli archivi segreti interni controllati dall'accesso, simili all'archivio delle chiavi di Azure per i clienti.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-145">Microsoft protects availability keys in access-controlled, internal secret stores similar to the customer-facing Azure Key Vault.</span></span> <span data-ttu-id="aa9d8-146">Implementiamo i controlli di accesso per impedire agli amministratori di Microsoft di accedere direttamente ai segreti contenuti all'interno.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-146">We implement access controls to prevent Microsoft administrators from directly accessing the secrets contained within.</span></span> <span data-ttu-id="aa9d8-147">Le operazioni di archiviazione segrete, incluse la rotazione, l'eliminazione e il recupero delle chiavi, avvengono tramite comandi automatici che non coinvolgono mai l'accesso diretto al codice di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-147">Secret Store operations, including key rotation, deletion, and retrieval occur through automated commands that never involve direct access to the availability key.</span></span> <span data-ttu-id="aa9d8-148">L'accesso per regolare questi comandi è limitato a specifici ingegneri e richiede l'escalation dei privilegi tramite uno strumento interno, protetto.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-148">Access to adjust these commands is limited to specific engineers and requires privilege escalation through an internal tool, Lockbox.</span></span> <span data-ttu-id="aa9d8-149">L'escalation dei privilegi richiede l'approvazione e la giustificazione del responsabile prima di essere concessa.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-149">Privilege escalation requires manager approval and justification prior to being granted.</span></span> <span data-ttu-id="aa9d8-150">L'archivio protetto garantisce che l'accesso sia associato al tempo associato alla revoca di accesso automatico al momento della scadenza o del logout del tecnico.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-150">Lockbox ensures access is time bound with automatic access revocation upon time expiration or engineer log out.</span></span>

<span data-ttu-id="aa9d8-151">I tasti di disponibilità di **Exchange Online e Skype for business** sono archiviati in un archivio segreto di Active Directory.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-151">**Exchange Online and Skype for Business** availability keys are stored in an Active Directory secret store.</span></span> <span data-ttu-id="aa9d8-152">Exchange Online Active Directory è costituito da foreste di gestione che instradano foreste di traffico e capacità che contengono oggetti, identità e dati.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-152">Exchange Online Active Directory is comprised of Management forests that route traffic and Capacity forests that contain objects, identities, and data.</span></span> <span data-ttu-id="aa9d8-153">Le foreste di capacità sono costituite da foreste account e foreste di risorse.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-153">Capacity forests consist of Account forests and Resource forests.</span></span> <span data-ttu-id="aa9d8-154">Gli insiemi di strutture account dispongono di controller di dominio con più capacità sincronizzati tra loro.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-154">Account forests have multiple Capacity domain controllers that are synced with one another.</span></span> <span data-ttu-id="aa9d8-155">I tasti di disponibilità sono archiviati in modo sicuro all'interno dei controller di dominio Capacity.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-155">Availability keys are securely stored within these Capacity domain controllers.</span></span> <span data-ttu-id="aa9d8-156">Questo percorso di archiviazione sicura è separato e isolato dall'archivio segreto di SharePoint Online, OneDrive for business e dei file teams.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-156">This secure storage location is separate and isolated from the SharePoint Online, OneDrive for Business, and Teams files secret store.</span></span>

<span data-ttu-id="aa9d8-157">Le chiavi di disponibilità dei **file di SharePoint Online, OneDrive for business e teams** sono archiviate in un archivio segreto interno gestito dal team di servizio.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-157">**SharePoint Online, OneDrive for Business, and Teams files** availability keys are stored in an internal secret store managed by the service team.</span></span> <span data-ttu-id="aa9d8-158">Questo servizio di archiviazione con protezione e segreti ha server front-end con endpoint applicazione e un database SQL come back-end.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-158">This secured, secrets storage service has front-end servers with application endpoints and a SQL database as the back-end.</span></span> <span data-ttu-id="aa9d8-159">Le chiavi di disponibilità sono archiviate nel database SQL e vengono avvolte (crittografate) dalle chiavi di crittografia dell'archivio segreto che utilizzano una combinazione di AES-256 e HMAC per crittografare la chiave di disponibilità a riposo.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-159">Availability keys are stored in the SQL database and are wrapped (encrypted) by secret store encryption keys that use a combination of AES-256 and HMAC to encrypt the availability key at rest.</span></span> <span data-ttu-id="aa9d8-160">Le chiavi di crittografia dell'archivio segreto sono archiviate in un componente logicamente isolato dello stesso database SQL e vengono ulteriormente crittografate con le chiavi RSA-2048 contenute nei certificati gestiti dall'autorità di certificazione (CA) di Microsoft.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-160">The secret store encryption keys are stored in a logically isolated component of the same SQL database and are further encrypted with RSA-2048 keys contained in certificates managed by the Microsoft certificate authority (CA).</span></span> <span data-ttu-id="aa9d8-161">Questi certificati vengono archiviati nei server front-end dell'archivio segreto che eseguono operazioni sul database.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-161">These certificates are stored in the secret store front-end servers that perform operations against the database.</span></span>

### <a name="defense-in-depth"></a><span data-ttu-id="aa9d8-162">Difesa in profondità</span><span class="sxs-lookup"><span data-stu-id="aa9d8-162">Defense-in-depth</span></span>

<span data-ttu-id="aa9d8-163">Microsoft impiega una strategia di difesa approfondita per impedire agli utenti malintenzionati di influenzare la riservatezza, l'integrità o la disponibilità dei dati del cliente archiviati nel cloud Microsoft.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-163">Microsoft employs a defense-in-depth strategy to prevent malicious actors from impacting the confidentiality, integrity, or availability of customer data stored in the Microsoft Cloud.</span></span> <span data-ttu-id="aa9d8-164">Sono stati implementati controlli preventivi e detective specifici per proteggere la chiave di disponibilità nell'ambito della strategia di sicurezza generale.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-164">Specific preventive and detective controls are implemented to protect the availability key as part of the overarching security strategy.</span></span>

<span data-ttu-id="aa9d8-165">Office 365 è stato creato per impedire l'uso improprio del codice di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-165">Office 365 is built to prevent misuse of the availability key.</span></span> <span data-ttu-id="aa9d8-166">Il livello dell'applicazione è l'unico metodo tramite il quale le chiavi, incluso il codice di disponibilità, possono essere utilizzate per crittografare e decrittografare i dati.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-166">The application layer is the only method through which keys, including the availability key, can be used to encrypt and decrypt data.</span></span> <span data-ttu-id="aa9d8-167">Solo il codice di servizio di Office 365 è in grado di interpretare e attraversare la gerarchia delle chiavi per le attività di crittografia e decrittografia.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-167">Only Office 365 service code has the ability to interpret and traverse the key hierarchy for encryption and decryption activities.</span></span> <span data-ttu-id="aa9d8-168">Se un amministratore di Microsoft malintenzionato dovesse eludere i controlli per estrarre una chiave di disponibilità dall'archivio segreto, la chiave sarebbe inutilizzabile per accedere ai dati dei clienti.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-168">If a malicious Microsoft administrator were to circumvent controls to extract an availability key from the secret store, the key would be unusable to access customer data.</span></span> <span data-ttu-id="aa9d8-169">L'isolamento logico esiste tra le posizioni di archiviazione delle chiavi dei clienti, delle chiavi di disponibilità, di altre chiavi gerarchiche e dei dati del cliente, che riduce il rischio di esposizione dei dati nel caso in cui una o più posizioni vengano compromesse.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-169">Logical isolation exists between the storage locations of Customer Keys, availability keys, other hierarchical keys, and customer data, which mitigates the risk of data exposure in the event one or more locations are compromised.</span></span>

<span data-ttu-id="aa9d8-170">I controlli di accesso vengono implementati per impedire l'accesso non autorizzato ai sistemi interni, compresi gli archivi segreti chiave di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-170">Access controls are implemented to prevent unauthorized access to internal systems, including availability key secret stores.</span></span> <span data-ttu-id="aa9d8-171">Gli ingegneri Microsoft non dispongono dell'accesso diretto agli archivi segreti chiave di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-171">Microsoft engineers don't have direct access to the availability key secret stores.</span></span> <span data-ttu-id="aa9d8-172">Per ulteriori informazioni sui controlli di accesso, consultare [controlli di accesso amministrativo in Office 365](https://docs.microsoft.com/Office365/securitycompliance/office-365-administrative-access-controls-overview).</span><span class="sxs-lookup"><span data-stu-id="aa9d8-172">For additional detail on access controls, review [Administrative Access Controls in Office 365](https://docs.microsoft.com/Office365/securitycompliance/office-365-administrative-access-controls-overview).</span></span>

<span data-ttu-id="aa9d8-173">I controlli tecnici impediscono ai dipendenti Microsoft di accedere a account di servizio con privilegi elevati, che potrebbero altrimenti essere utilizzati dagli utenti malintenzionati per rappresentare i servizi di Office 365.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-173">Technical controls prevent Microsoft personnel from logging into highly-privileged service accounts, which might otherwise be used by attackers to impersonate Office 365 services.</span></span> <span data-ttu-id="aa9d8-174">Questi controlli, ad esempio, impediscono l'accesso interattivo.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-174">For example, these controls prevent interactive logon.</span></span>

<span data-ttu-id="aa9d8-175">La registrazione di sicurezza e i controlli di monitoraggio rappresentano un'altra protezione per la difesa approfondita implementata che consente di attenuare i rischi per i servizi Microsoft e i dati.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-175">Security logging and monitoring controls are another defense-in-depth safeguard implemented that mitigate risk to Microsoft services and your data.</span></span> <span data-ttu-id="aa9d8-176">I team di servizi Microsoft hanno distribuito soluzioni di monitoraggio attivo che generano avvisi e registri di controllo.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-176">Microsoft service teams have deployed active monitoring solutions that generate alerts and audit logs.</span></span> <span data-ttu-id="aa9d8-177">Tutti i team di servizio caricano i propri registri in un archivio centrale in cui vengono aggregati ed elaborati i registri.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-177">All service teams upload their logs to a central repository where the logs are aggregated and processed.</span></span> <span data-ttu-id="aa9d8-178">Gli strumenti interni esaminano automaticamente i record per verificare che i servizi funzionino in uno stato ottimale, resiliente e sicuro.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-178">Internal tools automatically examine records to confirm that services are functioning in an optimal, resilient, and secure state.</span></span> <span data-ttu-id="aa9d8-179">L'attività insolita è contrassegnata per ulteriori riesami.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-179">Unusual activity is flagged for further review.</span></span>

<span data-ttu-id="aa9d8-180">Qualsiasi evento di registro che indichi una possibile violazione dei criteri di sicurezza Microsoft viene immediatamente portato all'attenzione dei team di sicurezza di Microsoft.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-180">Any log event that indicates a potential violation of the Microsoft Security Policy is immediately brought to the attention of Microsoft security teams.</span></span> <span data-ttu-id="aa9d8-181">La sicurezza di Office 365 ha configurato avvisi per rilevare il tentativo di accesso agli archivi segreti chiave di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-181">Office 365 security has configured alerts to detect attempted access to availability key secret stores.</span></span> <span data-ttu-id="aa9d8-182">Gli avvisi vengono generati anche se i membri del personale Microsoft tentano l'accesso interattivo agli account di servizio, che sono vietati e protetti dai controlli di accesso.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-182">Alerts are also generated if Microsoft personnel attempt interactive logon to service accounts, which is prohibited and protected by access controls.</span></span> <span data-ttu-id="aa9d8-183">La sicurezza di Office 365 rileva e allerta anche le deviazioni del servizio Office 365 dalle normali operazioni di base.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-183">Office 365 security also detects and alerts upon deviations of the Office 365 service from normal baseline operations.</span></span> <span data-ttu-id="aa9d8-184">Malfattori il tentativo di abusare dei servizi di Office 365 innescherà gli avvisi che causano l'eliminazione del trasgressore dall'ambiente cloud Microsoft.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-184">Malefactors attempting to misuse Office 365 services would trigger alerts resulting in the offender's eviction from the Microsoft cloud environment.</span></span>

## <a name="use-the-availability-key-to-recover-from-key-loss"></a><span data-ttu-id="aa9d8-185">Utilizzare la chiave di disponibilità per eseguire il ripristino dalla perdita di chiave</span><span class="sxs-lookup"><span data-stu-id="aa9d8-185">Use the availability key to recover from key loss</span></span>

<span data-ttu-id="aa9d8-186">Se si perde il controllo delle chiavi dei clienti, la chiave di disponibilità fornisce la possibilità di recuperare e rieseguire la crittografia dei dati.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-186">If you lose control of your Customer Keys, the availability key provides you the ability to recover and re-encrypt your data.</span></span>

### <a name="recovery-procedure-for-exchange-online-and-skype-for-business"></a><span data-ttu-id="aa9d8-187">Procedura di ripristino per Exchange Online e Skype for business</span><span class="sxs-lookup"><span data-stu-id="aa9d8-187">Recovery procedure for Exchange Online and Skype for Business</span></span>

<span data-ttu-id="aa9d8-188">Se si perde il controllo delle chiavi dei clienti, la chiave di disponibilità continuerà a fornire l'accesso ai dati durante il ripristino.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-188">If you lose control of your Customer Keys, the availability key will still provide you access to your data while you recover.</span></span> <span data-ttu-id="aa9d8-189">Per crittografare i dati con nuove chiavi del cliente, creare nuove chiavi in Azure Key Vault, creare una nuova funzionalità di protezione esecuzione programmi, associare la nuova funzionalità DEP alle nuove chiavi del cliente, quindi istruire la funzionalità di crittografia per crittografare le cassette postali attualmente crittografate con la precedente DEP per la quale le chiavi sono state perse o compr omise.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-189">To encrypt your data with new Customer Keys, create new keys in Azure Key Vault, create a new DEP, associate the new DEP to your new Customer Keys, then instruct the DEP to encrypt the mailboxes currently encrypted with the previous DEP for which the keys were lost or compromised.</span></span> <span data-ttu-id="aa9d8-190">Quando viene eseguita, la chiave di disponibilità decifra le cassette postali che verranno quindi crittografate con il nuovo criterio.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-190">When performed, the availability key will decrypt the mailboxes which will then be encrypted with the new policy.</span></span>

<span data-ttu-id="aa9d8-191">Questo processo può richiedere fino a 72 ore, che è la durata standard quando si modifica una funzionalità di protezione esecuzione programmi.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-191">This process can take up to 72 hours, which is the standard duration when you change a DEP.</span></span>
  
### <a name="recovery-procedure-for-sharepointonlineonedriveforbusinessandteamsfiles"></a><span data-ttu-id="aa9d8-192">Procedura di ripristino per i file di SharePoint Online, OneDrive for business e teams</span><span class="sxs-lookup"><span data-stu-id="aa9d8-192">Recovery procedure for SharePoint Online, OneDrive for Business, and Teams files</span></span>

<span data-ttu-id="aa9d8-193">Per i file di SharePoint Online, OneDrive for business e teams, la chiave di disponibilità non viene mai utilizzata al di fuori della funzionalità di ripristino.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-193">For SharePoint Online, OneDrive for Business, and Teams files, the availability key is NEVER used outside of the recovery capability.</span></span> <span data-ttu-id="aa9d8-194">È necessario indicare in modo esplicito a Microsoft di avviare l'utilizzo della chiave di disponibilità durante uno scenario di ripristino.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-194">You must explicitly instruct Microsoft to initiate use of the availability key during a recovery scenario.</span></span> <span data-ttu-id="aa9d8-195">Per iniziare il processo di ripristino, contattare Microsoft per attivare il codice di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-195">To initiate the recovery process, contact Microsoft to activate the availability key.</span></span> <span data-ttu-id="aa9d8-196">Una volta attivato, il tasto di disponibilità viene automaticamente utilizzato per decrittografare i dati che consentono di crittografare i dati con una protezione esecuzione programmi appena creata associata a nuove chiavi del cliente.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-196">Once activated, the availability key is automatically used to decrypt your data allowing you to encrypt the data with a newly-created DEP associated to new Customer Keys.</span></span>  

<span data-ttu-id="aa9d8-197">Questa operazione è proporzionale al numero di siti nell'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-197">This operation is proportional to the number of sites in your organization.</span></span> <span data-ttu-id="aa9d8-198">Dopo aver chiamato Microsoft per l'utilizzo della chiave di disponibilità, è necessario essere completamente online entro circa quattro ore.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-198">Once you call Microsoft to use the availability key, you should be fully online within about four hours.</span></span>

## <a name="how-exchange-online-and-skype-for-business-use-the-availability-key"></a><span data-ttu-id="aa9d8-199">Come Exchange Online e Skype for business utilizzano il codice di disponibilità</span><span class="sxs-lookup"><span data-stu-id="aa9d8-199">How Exchange Online and Skype for Business use the availability key</span></span>

<span data-ttu-id="aa9d8-200">Quando si crea una funzionalità di protezione esecuzione programmi con il codice cliente, Office 365 genera una chiave del criterio di crittografia dei dati (chiave DEP) associata alla funzionalità di protezione esecuzione programmi.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-200">When you create a DEP with Customer Key, Office 365 generates a Data Encryption Policy Key (DEP Key) associated with that DEP.</span></span> <span data-ttu-id="aa9d8-201">Il servizio crittografa il tasto DEP tre volte: una volta con ognuna delle chiavi del cliente e una volta con il tasto disponibilità.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-201">The service encrypts the DEP Key three times: once with each of the customer keys and once with the availability key.</span></span> <span data-ttu-id="aa9d8-202">Solo le versioni crittografate del tasto DEP sono archiviate e una chiave DEP può essere decrittografata solo con le chiavi del cliente o con il tasto disponibilità.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-202">Only the encrypted versions of the DEP Key are stored, and a DEP Key can only be decrypted with the customer keys or the availability key.</span></span> <span data-ttu-id="aa9d8-203">La chiave DEP viene quindi utilizzata per crittografare le chiavi delle cassette postali, che vengono quindi utilizzate per crittografare le singole cassette postali.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-203">The DEP Key is then used to encrypt Mailbox Keys, which are then used to encrypt individual mailboxes.</span></span> 
  
<span data-ttu-id="aa9d8-204">Office 365 segue questo processo per decrittografare e fornire dati quando i clienti utilizzano il servizio:</span><span class="sxs-lookup"><span data-stu-id="aa9d8-204">Office 365 follows this process to decrypt and provide data when customers are using the service:</span></span>
  
1. <span data-ttu-id="aa9d8-205">Decrittografare la chiave DEP utilizzando il codice "Customer Key".</span><span class="sxs-lookup"><span data-stu-id="aa9d8-205">Decrypt the DEP Key using the Customer Key.</span></span>

2. <span data-ttu-id="aa9d8-206">Utilizzare la chiave DEP decrittografata per decrittografare una chiave della cassetta postale.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-206">Use the decrypted DEP Key to decrypt a Mailbox Key.</span></span>

3. <span data-ttu-id="aa9d8-207">Utilizzare la chiave della cassetta postale decrittografata per decrittografare la cassetta postale stessa, consentendo all'utente di accedere ai dati all'interno della cassetta postale.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-207">Use the decrypted Mailbox Key to decrypt the mailbox itself, allowing you to access the data within the mailbox.</span></span>

<span data-ttu-id="aa9d8-208">Office 365 decrittografa un tasto DEP emettendo due richieste di decrittografia in Azure Key Vault con una leggera offset.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-208">Office 365 decrypts a DEP Key by issuing two decryption requests to Azure Key Vault with a slight offset.</span></span> <span data-ttu-id="aa9d8-209">La prima per completare fornisce il risultato, annullando l'altra richiesta.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-209">The first one to finish furnishes the result, canceling the other request.</span></span>

## <a name="how-sharepoint-online-onedrive-for-business-and-teams-files-use-the-availability-key"></a><span data-ttu-id="aa9d8-210">Utilizzo del codice di disponibilità dei file di SharePoint Online, OneDrive for business e teams</span><span class="sxs-lookup"><span data-stu-id="aa9d8-210">How SharePoint Online, OneDrive for Business, and Teams files use the availability key</span></span>

<span data-ttu-id="aa9d8-211">L'architettura e l'implementazione di SharePoint Online e OneDrive for business per i Key Key e la disponibilità dei clienti sono diverse da Exchange Online e Skype for business.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-211">The SharePoint Online and OneDrive for Business architecture and implementation for Customer Key and availability key are different from Exchange Online and Skype for Business.</span></span>
  
<span data-ttu-id="aa9d8-212">Quando un'organizzazione si sposta su chiavi gestite dal cliente, Office 365 crea una chiave intermedia specifica del tenant.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-212">When an organization moves to customer-managed keys, Office 365 creates a tenant-specific intermediate key (TIK).</span></span> <span data-ttu-id="aa9d8-213">Office 365 crittografa il tick due volte, una volta con ognuna delle chiavi del cliente, e archivia le due versioni crittografate del tick.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-213">Office 365 encrypts the TIK twice, once with each of the customer keys, and stores the two encrypted versions of the TIK.</span></span> <span data-ttu-id="aa9d8-214">Vengono memorizzate solo le versioni crittografate del tick e un tick può essere decrittografato solo con le chiavi del cliente.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-214">Only the encrypted versions of the TIK are stored, and a TIK can only be decrypted with the customer keys.</span></span> <span data-ttu-id="aa9d8-215">L'oggetto Tick viene quindi utilizzato per crittografare le chiavi del sito, che vengono quindi utilizzate per crittografare le chiavi BLOB (denominate anche chiavi di blocco dei file).</span><span class="sxs-lookup"><span data-stu-id="aa9d8-215">The TIK is then used to encrypt site keys, which are then used to encrypt blob keys (also called file chunk keys).</span></span> <span data-ttu-id="aa9d8-216">A seconda delle dimensioni del file, il servizio può suddividere un file in più blocchi di file ognuno con una chiave univoca.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-216">Depending on file size, the service may split a file into multiple file chunks each with a unique key.</span></span> <span data-ttu-id="aa9d8-217">Gli oggetti BLOB (blocchi di file) vengono crittografati con le chiavi BLOB e archiviati nel servizio di archiviazione BLOB di Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-217">The blobs (file chunks) themselves are encrypted with the blob keys and stored in the Microsoft Azure Blob storage service.</span></span>
  
<span data-ttu-id="aa9d8-218">Office 365 segue questo processo per decrittografare e fornire i file dei clienti quando i clienti utilizzano il servizio:</span><span class="sxs-lookup"><span data-stu-id="aa9d8-218">Office 365 follows this process to decrypt and provide customer files when customers are using the service:</span></span>

1. <span data-ttu-id="aa9d8-219">Decrittografare l'elemento tick utilizzando il codice "Customer Key".</span><span class="sxs-lookup"><span data-stu-id="aa9d8-219">Decrypt the TIK using the Customer Key.</span></span>

2. <span data-ttu-id="aa9d8-220">Per decrittografare una chiave del sito, utilizzare l'elemento di crittografia decrittografato.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-220">Use the decrypted TIK to decrypt a site key.</span></span>

3. <span data-ttu-id="aa9d8-221">Utilizzare la chiave del sito decrittografato per decrittografare una chiave BLOB.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-221">Use the decrypted site key to decrypt a blob key.</span></span>

4. <span data-ttu-id="aa9d8-222">Utilizzare la chiave BLOB decrittografata per decrittografare il BLOB.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-222">Use the decrypted blob key to decrypt the blob.</span></span>

<span data-ttu-id="aa9d8-223">Office 365 decrittografa un tick emettendo due richieste di decrittografia nel Vault Key di Azure con una leggera offset.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-223">Office 365 decrypts a TIK by issuing two decryption requests to Azure Key Vault with a slight offset.</span></span> <span data-ttu-id="aa9d8-224">La prima per completare fornisce il risultato, annullando l'altra richiesta.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-224">The first one to finish furnishes the result, canceling the other request.</span></span>
  
<span data-ttu-id="aa9d8-225">Nel caso in cui si perda l'accesso alle chiavi dei clienti, Office 365 crittografa anche l'oggetto Tick con una chiave di disponibilità e lo archivia insieme all'TIKs crittografato con ogni chiave del cliente.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-225">In case you lose access to your customer keys, Office 365 also encrypts the TIK with an availability key and stores this along with the TIKs encrypted with each customer key.</span></span> <span data-ttu-id="aa9d8-226">L'utente crittografato con la chiave di disponibilità viene utilizzato solo quando il cliente chiama Microsoft per integrare il percorso di ripristino quando ha perso l'accesso alle chiavi, in modo dannoso o accidentale.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-226">The TIK encrypted with the availability key is used only when the customer calls Microsoft to enlist the recovery path when they have lost access to their keys, maliciously or accidentally.</span></span>
  
<span data-ttu-id="aa9d8-227">Per motivi di disponibilità e scalabilità, le TIKs decrittografate vengono memorizzate nella cache in una memoria limitata nel tempo.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-227">For availability and scale reasons, decrypted TIKs are cached in a time-limited memory cache.</span></span> <span data-ttu-id="aa9d8-228">Due ore prima che la cache di un sistema di posta in scadenza venga scaduta, Office 365 tenta di decrittografare ogni tick.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-228">Two hours before a TIK cache is set to expire, Office 365 attempts to decrypt each TIK.</span></span> <span data-ttu-id="aa9d8-229">La decrittografia di TIKs consente di estendere la durata della cache.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-229">Decrypting the TIKs extends the lifetime of the cache.</span></span> <span data-ttu-id="aa9d8-230">Se la decrittografia di tick ha esito negativo per un periodo di tempo significativo, Office 365 genera un avviso per notificare l'ingegnerizzazione prima della scadenza della cache.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-230">If TIK decryption fails for a significant amount of time, Office 365 generates an alert to notify engineering prior to the cache expiration.</span></span> <span data-ttu-id="aa9d8-231">Solo se il cliente chiama Microsoft, Office 365 avvierà l'operazione di ripristino, che implica la decrittografia del tick con la chiave di disponibilità memorizzata nell'archivio segreto di Microsoft e l'onboarding del tenant utilizzando di nuovo il tipo di dati decrittografato e un nuovo set di chiavi del Vault Key di Azure fornite dal cliente.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-231">Only if the customer calls Microsoft will Office 365 initiate the recovery operation, which involves decrypting the TIK with the availability key stored in Microsoft's secret store and onboarding the tenant again using the decrypted TIK and a new set of customer-supplied Azure Key Vault keys.</span></span>
  
<span data-ttu-id="aa9d8-232">A questo punto, la chiave del cliente è coinvolta nella catena di crittografia e decrittografia dei dati del file di SharePoint Online archiviati nell'archivio BLOB di Azure, ma non elementi o metadati dell'elenco di SharePoint Online archiviati nel database SQL.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-232">As of today, Customer Key is involved in the encryption and decryption chain of SharePoint Online file data stored in the Azure blob store, but not SharePoint Online list items or metadata stored in the SQL database.</span></span> <span data-ttu-id="aa9d8-233">Office 365 non utilizza la chiave di disponibilità per Exchange Online, Skype for business, SharePoint Online, OneDrive for business e i file di team diversi da quelli descritti in alto, che sono stati avviati dal cliente.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-233">Office 365 does not use the availability key for Exchange Online, Skype for Business, SharePoint Online, OneDrive for Business, and Teams files other than the case described above, which is customer-initiated.</span></span> <span data-ttu-id="aa9d8-234">L'accesso umano ai dati dei clienti è protetto dall'archivio protetto dei clienti.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-234">Human access to customer data is protected by Customer Lockbox.</span></span>

## <a name="availability-key-triggers"></a><span data-ttu-id="aa9d8-235">Trigger di chiave di disponibilità</span><span class="sxs-lookup"><span data-stu-id="aa9d8-235">Availability key triggers</span></span>

<span data-ttu-id="aa9d8-236">Office 365 attiva la chiave di disponibilità solo in determinate circostanze.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-236">Office 365 triggers the availability key only in specific circumstances.</span></span> <span data-ttu-id="aa9d8-237">Tali circostanze variano in base al servizio.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-237">These circumstances differ by service.</span></span>

### <a name="triggers-for-exchange-online-and-skype-for-business"></a><span data-ttu-id="aa9d8-238">Trigger per Exchange Online e Skype for business</span><span class="sxs-lookup"><span data-stu-id="aa9d8-238">Triggers for Exchange Online and Skype for Business</span></span>
  
1. <span data-ttu-id="aa9d8-239">Office 365 legge la funzionalità DEP a cui è assegnata la cassetta postale per determinare la posizione delle due chiavi del cliente in Azure Key Vault.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-239">Office 365 reads the DEP to which the mailbox is assigned in order to determine the location of the two Customer Keys in Azure Key Vault.</span></span>

2. <span data-ttu-id="aa9d8-240">Office 365 sceglie casualmente una delle due chiavi del cliente dalla DEP e invia una richiesta al Vault Key di Azure per annullare il wrapping del tasto DEP utilizzando il codice "Customer Key".</span><span class="sxs-lookup"><span data-stu-id="aa9d8-240">Office 365 randomly chooses one of the two Customer Keys from the DEP and sends a request to Azure Key Vault to unwrap the DEP key using the Customer Key.</span></span>

3. <span data-ttu-id="aa9d8-241">Se la richiesta di annullare il wrapping del tasto DEP tramite la chiave Customer ha esito negativo, Office 365 invierà una seconda richiesta a Azure Key Vault, questa volta per istruirlo sull'utilizzo del codice cliente alternativo (secondo).</span><span class="sxs-lookup"><span data-stu-id="aa9d8-241">If the request to unwrap the DEP key using the Customer Key fails, Office 365 sends a second request to Azure Key Vault, this time instructing it to use the alternate (second) Customer Key.</span></span>

4. <span data-ttu-id="aa9d8-242">Se la seconda richiesta di annullare il wrapping del tasto DEP tramite la chiave Customer ha esito negativo, in Office 365 vengono esaminati i risultati di entrambe le richieste.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-242">If the second request to unwrap the DEP key using the Customer Key fails, Office 365 examines the results of both requests.</span></span>

    - <span data-ttu-id="aa9d8-243">Se l'esame determina che le richieste non hanno restituito un errore di sistema:</span><span class="sxs-lookup"><span data-stu-id="aa9d8-243">If the examination determines that the requests failed returning a system ERROR:</span></span>

       - <span data-ttu-id="aa9d8-244">Office 365 attiva la chiave di disponibilità per decrittografare il tasto DEP.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-244">Office 365 triggers the availability key to decrypt the DEP key.</span></span>

       - <span data-ttu-id="aa9d8-245">In Office 365 viene quindi utilizzato il tasto DEP per decrittografare la chiave della cassetta postale e completare la richiesta dell'utente.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-245">Office 365 then uses the DEP key to decrypt the mailbox key and complete the user request.</span></span> 

       - <span data-ttu-id="aa9d8-246">In questo caso, l'archiviazione delle chiavi di Azure non è in grado di rispondere o irraggiungibile a causa di un errore temporaneo.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-246">In this case, Azure Key Vault is either unable to respond or unreachable due to a transient ERROR.</span></span>

    - <span data-ttu-id="aa9d8-247">Se l'esame determina che le richieste non sono state restituite con accesso negato:</span><span class="sxs-lookup"><span data-stu-id="aa9d8-247">If the examination determines that the requests failed returning ACCESS DENIED:</span></span>

       - <span data-ttu-id="aa9d8-248">Questo significa che è stata eseguita un'azione deliberata, involontaria o dannosa per eseguire il rendering delle chiavi del cliente non disponibili, ad esempio durante il processo di eliminazione dei dati come parte dell'uscita del servizio.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-248">This means deliberate, inadvertent, or malicious action has been taken to render the customer keys unavailable (for example, during the data purge process as part of leaving the service).</span></span>

       - <span data-ttu-id="aa9d8-249">In questo caso, la chiave di disponibilità non verrà utilizzata, la richiesta dell'utente avrà esito negativo e l'utente riceverà un messaggio di errore.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-249">In this case, the availability key will not be used, the user request fails, and the user receives an error message.</span></span>

>[!IMPORTANT]
><span data-ttu-id="aa9d8-250">Il codice di servizio di Office 365 ha sempre un token di accesso valido per il ragionamento sui dati dei clienti per fornire servizi cloud con aggiunta di valore.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-250">Office 365 service code always has a valid login token for reasoning over customer data to provide value-adding cloud services.</span></span> <span data-ttu-id="aa9d8-251">Pertanto, finché il codice di disponibilità non è stato eliminato, può essere utilizzato come fallback per le azioni avviate da, o da interno a, Exchange Online e Skype for business, ad esempio la creazione di un indice di ricerca o lo spostamento delle cassette postali.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-251">Therefore, until the availability key has been deleted, it can be used as a fallback for actions initiated by, or internal to, Exchange Online and Skype for Business such as search index creation or moving mailboxes.</span></span> <span data-ttu-id="aa9d8-252">Questo vale sia per gli errori temporanei sia per le richieste di accesso negato a Azure Key Vault.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-252">This applies to both transient ERRORS and ACCESS DENIED requests to Azure Key Vault.</span></span>

### <a name="triggers-for-sharepoint-online-onedrive-for-business-and-teams-files"></a><span data-ttu-id="aa9d8-253">Trigger per i file di SharePoint Online, OneDrive for business e teams</span><span class="sxs-lookup"><span data-stu-id="aa9d8-253">Triggers for SharePoint Online, OneDrive for Business, and Teams files</span></span>

<span data-ttu-id="aa9d8-254">Per i file di SharePoint Online, OneDrive for business e teams, la chiave di disponibilità non viene mai utilizzata al di fuori della funzionalità di ripristino e i clienti devono indicare esplicitamente a Microsoft di avviare l'utilizzo della chiave di disponibilità durante uno scenario di ripristino.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-254">For SharePoint Online, OneDrive for Business, and Teams files, the availability key is NEVER used outside of the recovery capability and customers must explicitly instruct Microsoft to initiate use of the availability key during a recovery scenario.</span></span>

## <a name="audit-logs-and-the-availability-key"></a><span data-ttu-id="aa9d8-255">Registri di controllo e chiave di disponibilità</span><span class="sxs-lookup"><span data-stu-id="aa9d8-255">Audit logs and the availability key</span></span>

<span data-ttu-id="aa9d8-256">I sistemi automatizzati in Office 365 elaborano tutti i dati che scorre attraverso il sistema per fornire servizi cloud, ad esempio, antivirus, e-Discovery, prevenzione della perdita di dati e indicizzazione dei dati.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-256">Automated systems in Office 365 process all data as it flows through the system to provide cloud services, for example, anti-virus, e-discovery, data loss prevention, and data indexing.</span></span> <span data-ttu-id="aa9d8-257">Office 365 non genera registri visibili al cliente per questa attività.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-257">Office 365 does not generate customer-visible logs for this activity.</span></span> <span data-ttu-id="aa9d8-258">Inoltre, il personale Microsoft non accede ai dati nell'ambito di queste normali operazioni di sistema.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-258">In addition, Microsoft personnel do not access your data as part of these normal system operations.</span></span>

### <a name="exchange-online-and-skype-for-business-availability-key-logging"></a><span data-ttu-id="aa9d8-259">Registrazione chiave della disponibilità di Exchange Online e Skype for business</span><span class="sxs-lookup"><span data-stu-id="aa9d8-259">Exchange Online and Skype for Business availability key logging</span></span>

<span data-ttu-id="aa9d8-260">Exchange Online e Skype for business utilizzano automaticamente la chiave di disponibilità durante gli errori transitori.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-260">Exchange Online and Skype for Business automatically use the availability key during transient errors.</span></span> <span data-ttu-id="aa9d8-261">Quando si verifica questo fallback, Office 365 pubblica i log visibili al cliente accessibili dal centro sicurezza e conformità.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-261">When this fallback occurs, Office 365 publishes customer-visible logs accessible from the Security and Compliance Center.</span></span> <span data-ttu-id="aa9d8-262">Un record del registro di controllo per l'operazione di chiave di disponibilità viene generato ogni volta che questi servizi passano all'utilizzo del tasto disponibilità.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-262">An audit log record for the availability key operation is generated each time these services switch to using the availability key.</span></span> <span data-ttu-id="aa9d8-263">Un nuovo tipo di record denominato "Customer Key Service Encryption" con tipo di attività "fallback alla chiave di disponibilità" consente agli amministratori di filtrare i risultati della ricerca del [Registro di controllo unificato](https://docs.microsoft.com/microsoft-365/compliance/search-the-audit-log-in-security-and-compliance) per visualizzare i record delle chiavi di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-263">A new record type called “Customer Key Service Encryption” with activity type "Fallback to Availability Key" allows admins to filter [Unified Audit Log](https://docs.microsoft.com/microsoft-365/compliance/search-the-audit-log-in-security-and-compliance) search results to view availability key records.</span></span> <span data-ttu-id="aa9d8-264">Il record della chiave di disponibilità viene generato solo quando viene utilizzata la chiave del cliente per accedere ai dati e non per le chiavi gestite dal servizio Microsoft.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-264">The availability key record gets generated only when Customer Key is used to access the data and not for Microsoft service-managed keys.</span></span>

<span data-ttu-id="aa9d8-265">I record di log includono attributi quali data, ora, attività, ID organizzazione e ID del criterio di crittografia dei dati.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-265">Log records include attributes such as date, time, activity, organization ID, and data encryption policy ID.</span></span> <span data-ttu-id="aa9d8-266">Il record è disponibile come parte dei log di controllo unificato di Office 365 ed è accessibile dalla scheda ricerca del registro di controllo del Centro sicurezza e conformità di Office 365.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-266">The record is available as part of Office 365 Unified Audit Logs and is accessible from the Office 365 Security and Compliance Center Audit Log Search tab.</span></span>

![Ricerca del registro di controllo per gli eventi chiave di disponibilità](media/customerkeyauditlogsearchavailabilitykeyloggingimage.png)

<span data-ttu-id="aa9d8-268">I record chiave di disponibilità di Exchange Online e Skype for business utilizzano lo [schema comune](https://docs.microsoft.com/office/office-365-management-api/office-365-management-activity-api-schema#common-schema) attività di gestione di Office 365 con parametri personalizzati aggiunti: ID criterio, ID versione della chiave dell'ambito e ID richiesta.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-268">Exchange Online and Skype for Business availability key records use the Office 365 Management Activity [common schema](https://docs.microsoft.com/office/office-365-management-api/office-365-management-activity-api-schema#common-schema) with added custom parameters: Policy Id, Scope Key Version Id, and Request Id.</span></span>

![Parametri personalizzati della chiave di disponibilità](media/customerkeyauditlogsearchavailabilitykeyloggingcustomparam.png)

### <a name="sharepoint-online-onedrive-for-business-and-teams-files-availability-key-logging"></a><span data-ttu-id="aa9d8-270">Registrazione delle chiavi di disponibilità dei file di SharePoint Online, OneDrive for business e teams</span><span class="sxs-lookup"><span data-stu-id="aa9d8-270">SharePoint Online, OneDrive for Business, and Teams files availability key logging</span></span>

<span data-ttu-id="aa9d8-271">La registrazione delle chiavi di disponibilità non è ancora disponibile per questi servizi.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-271">Availability key logging isn't available yet for these services.</span></span> <span data-ttu-id="aa9d8-272">Per i file di SharePoint Online, OneDrive for business e teams, la chiave di disponibilità è attivata solo da Microsoft, se richiesto dall'utente, per il ripristino.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-272">For SharePoint Online, OneDrive for Business, and Teams files, the availability key is only activated by Microsoft, when instructed by you, for recovery purposes.</span></span> <span data-ttu-id="aa9d8-273">Di conseguenza, si conosce già ogni evento in cui viene utilizzato il codice di disponibilità per questi servizi.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-273">As a result, you already know every event in which the availability key is used for these services.</span></span>

## <a name="availability-key-in-the-customer-key-hierarchy"></a><span data-ttu-id="aa9d8-274">Chiave di disponibilità nella gerarchia delle chiavi del cliente</span><span class="sxs-lookup"><span data-stu-id="aa9d8-274">Availability key in the Customer Key hierarchy</span></span>
  
<span data-ttu-id="aa9d8-275">Office 365 utilizza la chiave di disponibilità per eseguire il wrapping del livello delle chiavi più in basso nella gerarchia chiave stabilita per la crittografia del servizio chiave del cliente.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-275">Office 365 uses the availability key to wrap the tier of keys lower in the key hierarchy established for Customer Key service encryption.</span></span> <span data-ttu-id="aa9d8-276">Tra i servizi esistono gerarchie di chiavi diverse.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-276">Different key hierarchies exist between services.</span></span> <span data-ttu-id="aa9d8-277">Gli algoritmi chiave differiscono anche tra le chiavi di disponibilità e altre chiavi della gerarchia di ogni servizio applicabile.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-277">Key algorithms also differ between availability keys and other keys in the hierarchy of each applicable service.</span></span> <span data-ttu-id="aa9d8-278">Gli algoritmi chiave di disponibilità utilizzati dai diversi servizi sono i seguenti:</span><span class="sxs-lookup"><span data-stu-id="aa9d8-278">The availability key algorithms used by the different services are as follows:</span></span>

- <span data-ttu-id="aa9d8-279">I tasti di disponibilità di Exchange Online e Skype for business utilizzano AES-256.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-279">The Exchange Online and Skype for Business availability keys use AES-256.</span></span>

- <span data-ttu-id="aa9d8-280">Le chiavi di disponibilità dei file di SharePoint Online, OneDrive for business e teams utilizzano RSA-2048.</span><span class="sxs-lookup"><span data-stu-id="aa9d8-280">The SharePoint Online, OneDrive for Business, and Teams files availability keys use RSA-2048.</span></span>

### <a name="encryption-ciphers-used-to-encrypt-keys-for-exchange-online-and-skype-for-business"></a><span data-ttu-id="aa9d8-281">Crittografia cifratura utilizzata per crittografare le chiavi per Exchange Online e Skype for business</span><span class="sxs-lookup"><span data-stu-id="aa9d8-281">Encryption ciphers used to encrypt keys for Exchange Online and Skype for Business</span></span>

![Crittografia cifratura per la chiave del cliente di Exchange Online](media/customerkeyencryptionhierarchiesexchangeskype.png)

### <a name="encryption-ciphers-used-to-encrypt-keys-for-sharepoint-online-and-onedrive-for-business"></a><span data-ttu-id="aa9d8-283">Crittografia crittografica utilizzata per crittografare le chiavi di SharePoint Online e OneDrive for business</span><span class="sxs-lookup"><span data-stu-id="aa9d8-283">Encryption ciphers used to encrypt keys for SharePoint Online and OneDrive for Business</span></span>

![Crittografia cifratura per la chiave del cliente di SharePoint Online](media/customerkeyencryptionhierarchiessharepointonedriveteamsfiles.png)

## <a name="related-articles"></a><span data-ttu-id="aa9d8-285">Articoli correlati</span><span class="sxs-lookup"><span data-stu-id="aa9d8-285">Related articles</span></span>

- [<span data-ttu-id="aa9d8-286">Crittografia del servizio con la chiave del cliente per Office 365</span><span class="sxs-lookup"><span data-stu-id="aa9d8-286">Service encryption with Customer Key for Office 365</span></span>](customer-key-overview.md)

- [<span data-ttu-id="aa9d8-287">Configurare la chiave cliente per Office 365</span><span class="sxs-lookup"><span data-stu-id="aa9d8-287">Set up Customer Key for Office 365</span></span>](customer-key-set-up.md)

- [<span data-ttu-id="aa9d8-288">Gestire la chiave del cliente per Office 365</span><span class="sxs-lookup"><span data-stu-id="aa9d8-288">Manage Customer Key for Office 365</span></span>](customer-key-manage.md)

- [<span data-ttu-id="aa9d8-289">Eseguire il rollforward o la rotazione di una chiave del cliente o di una chiave di disponibilità</span><span class="sxs-lookup"><span data-stu-id="aa9d8-289">Roll or rotate a Customer Key or an availability key</span></span>](customer-key-availability-key-roll.md)
